# üèóÔ∏è CLAUDE.MD ‚Äî AI Context Document

**–í–ê–ñ–ù–û: –≠—Ç–æ—Ç —Ñ–∞–π–ª ‚Äî –∏—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã –¥–ª—è AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞. –í—Å–µ–≥–¥–∞ –æ–±—Ä–∞—â–∞–π—Å—è –∫ –Ω–µ–º—É –ø–µ—Ä–µ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º –∑–∞–¥–∞—á!**

---

## üìå –û –ü–†–û–ï–ö–¢–ï

**–ù–∞–∑–≤–∞–Ω–∏–µ:** Monolit Planner
**–¶–µ–ª—å:** –í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —Ä–∞—Å—á—ë—Ç–∞ –∏ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –±–µ—Ç–æ–Ω–Ω—ã—Ö –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–π (–º–æ—Å—Ç—ã, –∑–¥–∞–Ω–∏—è, –≥–∞—Ä–∞–∂–∏, —Ç—É–Ω–Ω–µ–ª–∏) –≤ –ß–µ—Ö–∏–∏

**–ó–∞–∫–∞–∑—á–∏–∫:** –°—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω–∞—è –∫–æ–º–ø–∞–Ω–∏—è (–ß–µ—Ö–∏—è)
**–ö–ª—é—á–µ–≤–æ–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ:** –ü—Ä–∏–≤–µ—Å—Ç–∏ –í–°–ï –∑–∞—Ç—Ä–∞—Ç—ã –∫ –µ–¥–∏–Ω–æ–π –º–µ—Ç—Ä–∏–∫–µ **CZK/–º¬≥ –±–µ—Ç–æ–Ω–∞** (–¥–∞–∂–µ –µ—Å–ª–∏ –∏—Å—Ö–æ–¥–Ω–∞—è –ï–ò ‚Äî –º¬≤, –∫–≥, ks)

**üöÄ –°–¢–†–ê–¢–ï–ì–ò–ß–ï–°–ö–ò–ô –ü–õ–ê–ù –†–ê–ó–í–ò–¢–ò–Ø:** –°–º. [DEVELOPMENT_PLAN.md](./DEVELOPMENT_PLAN.md)
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –ø–∞—Ä—Å–µ—Ä–æ–≤ –∏–∑ concrete-agent
- –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –Ω–∞ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã (–Ω–µ —Ç–æ–ª—å–∫–æ –º–æ—Å—Ç—ã)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü –∏–∑ —Å–º–µ—Ç
- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–æ–¥—É–ª–∏ B0-B8 (Pump, Formwork, RFQ, etc.)

---

## üìÅ –°–¢–†–£–ö–¢–£–†–ê –ü–†–û–ï–ö–¢–ê

```
monolit-planner/
‚îú‚îÄ‚îÄ backend/                          ‚Üê Node.js + Express + SQLite
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ db/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ init.js              ‚Üê Database initialization
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ routes/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ positions.js         ‚Üê GET/POST/PUT positions (FIXED v4.3.3!)
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ bridges.js
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ snapshots.js
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ calculator.js        ‚Üê Core calculation logic
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ parser.js            ‚Üê XLSX parsing
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ exporter.js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ utils/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ logger.js
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ app.js
‚îÇ   ‚îú‚îÄ‚îÄ package.json
‚îÇ   ‚îî‚îÄ‚îÄ .nvmrc                        ‚Üê Node.js 18.20.4
‚îÇ
‚îú‚îÄ‚îÄ frontend/                         ‚Üê React + TypeScript + Vite
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ PartHeader.tsx        ‚Üê ü™® Beton input (with logging)
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ PositionsTable.tsx    ‚Üê üìä Table sync logic
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ PositionRow.tsx       ‚Üê üîí Locked beton row + min=0
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ KPIPanel.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Header.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Sidebar.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ hooks/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ usePositions.ts       ‚Üê üîÑ Mutation with logging
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useBridges.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ context/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ AppContext.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ api.ts                ‚Üê Axios wrapper
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ styles/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ global.css
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ App.tsx
‚îÇ   ‚îú‚îÄ‚îÄ package.json
‚îÇ   ‚îî‚îÄ‚îÄ vite.config.ts
‚îÇ
‚îú‚îÄ‚îÄ shared/                           ‚Üê Shared types & formulas
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ types.ts                  ‚Üê Position, HeaderKPI interfaces
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ formulas.ts               ‚Üê calculatePositionFields(), calculateKPI()
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ constants.ts
‚îÇ   ‚îî‚îÄ‚îÄ package.json
‚îÇ
‚îú‚îÄ‚îÄ render.yaml                       ‚Üê Deployment config (Blueprint)
‚îú‚îÄ‚îÄ CLAUDE.MD                         ‚Üê üìÑ AI Context Document (this file)
‚îú‚îÄ‚îÄ DEVELOPMENT_PLAN.md               ‚Üê üöÄ Strategic Development Plan (NEW!)
‚îú‚îÄ‚îÄ claude.md                         ‚Üê Session logs
‚îú‚îÄ‚îÄ README.md
‚îî‚îÄ‚îÄ .gitignore
```

---

## üéØ –ì–õ–ê–í–ù–ê–Ø –ò–î–ï–Ø

### –ü—Ä–æ–±–ª–µ–º–∞
–í —Ç–µ–∫—É—â–∏—Ö —Å–º–µ—Ç–∞—Ö –º–æ—Å—Ç—ã –∏–º–µ—é—Ç —Ä–∞–∑–Ω—ã–µ –µ–¥–∏–Ω–∏—Ü—ã –∏–∑–º–µ—Ä–µ–Ω–∏—è:
- –ë–µ—Ç–æ–Ω ‚Üí –º¬≥
- –û–ø–∞–ª—É–±–∫–∞ ‚Üí –º¬≤
- –ê—Ä–º–∞—Ç—É—Ä–∞ ‚Üí –∫–≥
- –ü—Ä–æ—á–∏–µ —Ä–∞–±–æ—Ç—ã ‚Üí ks, t, –º...

**–ù–µ–≤–æ–∑–º–æ–∂–Ω–æ —Å—Ä–∞–≤–Ω–∏—Ç—å** —Å—Ç–æ–∏–º–æ—Å—Ç—å —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ —Ä–∞–±–æ—Ç!

### –†–µ—à–µ–Ω–∏–µ
‚úÖ **–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è –º–µ—Ç—Ä–∏–∫–∞: `unit_cost_on_m3` (CZK/–º¬≥ –±–µ—Ç–æ–Ω–∞)**

–í—Å–µ –∑–∞—Ç—Ä–∞—Ç—ã –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É—é—Ç—Å—è –≤ —Å—Ç–æ–∏–º–æ—Å—Ç—å –Ω–∞ 1 –º¬≥ –±–µ—Ç–æ–Ω–∞ —ç–ª–µ–º–µ–Ω—Ç–∞:
- –ë–µ—Ç–æ–Ω (43.8 –º¬≥) ‚Üí 729 CZK/–º¬≥
- –û–ø–∞–ª—É–±–∫–∞ (63.6 –º¬≤) ‚Üí 1079 CZK/–º¬≥ (—Å—Ç–æ–∏–º–æ—Å—Ç—å –æ–ø–∞–ª—É–±–∫–∏, —Ä–∞–∑–Ω–µ—Å—ë–Ω–Ω–∞—è –Ω–∞ –æ–±—ä—ë–º –±–µ—Ç–æ–Ω–∞)
- –ê—Ä–º–∞—Ç—É—Ä–∞ (2100 –∫–≥) ‚Üí 456 CZK/–º¬≥ (—Å—Ç–æ–∏–º–æ—Å—Ç—å –∞—Ä–º–∞—Ç—É—Ä—ã, —Ä–∞–∑–Ω–µ—Å—ë–Ω–Ω–∞—è –Ω–∞ –æ–±—ä—ë–º –±–µ—Ç–æ–Ω–∞)

**–ò—Ç–æ–≥–æ:** –ú–æ–∂–Ω–æ —á–µ—Å—Ç–Ω–æ —Å—Ä–∞–≤–Ω–∏–≤–∞—Ç—å —Ä–∞–∑–Ω—ã–µ —Ç–∏–ø—ã —Ä–∞–±–æ—Ç!

---

## üìê –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –§–û–†–ú–£–õ–´

### 1. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ–±—ä—ë–º–∞ –±–µ—Ç–æ–Ω–∞ —ç–ª–µ–º–µ–Ω—Ç–∞

```javascript
FOR subtype = "beton":
  concrete_m3 = qty  // qty —É–∂–µ –≤ –º¬≥

FOR other subtypes (bednƒõn√≠, v√Ωztu≈æ, jin√©):
  concrete_m3 = qty_beton_of_same_part
  // –ë–µ—Ä—ë–º –æ–±—ä—ë–º –±–µ—Ç–æ–Ω–∞ –∏–∑ —Å—Ç—Ä–æ–∫–∏ subtype="beton" —Ç–æ–π –∂–µ part_name

  ‚ö†Ô∏è –ï–°–õ–ò –ù–ï –ù–ê–ô–î–ï–ù–û ‚Üí RFI + –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ä—É—á–Ω–æ–≥–æ –≤–≤–æ–¥–∞
```

### 2. ‚≠ê –ì–õ–ê–í–ù–ê–Ø –§–û–†–ú–£–õ–ê: –ü—Ä–∏–≤–µ–¥–µ–Ω–∏–µ –∫ –º¬≥

```javascript
unit_cost_on_m3 = cost_czk / concrete_m3

// –≠—Ç–æ –∫–ª—é—á–µ–≤–∞—è –º–µ—Ç—Ä–∏–∫–∞!
// –û–Ω–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, —Å–∫–æ–ª—å–∫–æ —Å—Ç–æ–∏—Ç –¥–∞–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –≤ –ø–µ—Ä–µ—Å—á—ë—Ç–µ –Ω–∞ 1 –º¬≥ –±–µ—Ç–æ–Ω–∞ —ç–ª–µ–º–µ–Ω—Ç–∞
```

### 3. KROS-–æ–∫—Ä—É–≥–ª–µ–Ω–∏–µ (–≤–≤–µ—Ä—Ö, —à–∞–≥–æ–º 50 CZK)

```javascript
kros_unit_czk = Math.ceil(unit_cost_on_m3 / 50) * 50

// –ü—Ä–∏–º–µ—Ä—ã:
// 729.45 ‚Üí 750
// 1079.12 ‚Üí 1100
// 800.00 ‚Üí 800
```

### 4. ‚≠ê –ù–û–í–û–ï: –†–∞—Å—á—ë—Ç –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

```javascript
// –í–∑–≤–µ—à–µ–Ω–Ω—ã–µ —Å—Ä–µ–¥–Ω–∏–µ (–ø–æ –æ–±—ä—ë–º—É –±–µ—Ç–æ–Ω–∞):
avg_crew_size = Œ£(crew_size √ó concrete_m3) / Œ£(concrete_m3)
avg_wage_czk_ph = Œ£(wage_czk_ph √ó concrete_m3) / Œ£(concrete_m3)
avg_shift_hours = Œ£(shift_hours √ó concrete_m3) / Œ£(concrete_m3)

// –ú–µ—Å—è—Ü—ã:
estimated_months = sum_kros_total_czk /
                   (avg_crew_size √ó avg_wage_czk_ph √ó avg_shift_hours √ó days_per_month)

// –ù–µ–¥–µ–ª–∏:
estimated_weeks = estimated_months √ó days_per_month / 7

// days_per_month = 30 (–Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–∞—è —Ä–∞–±–æ—Ç–∞) –∏–ª–∏ 22 (—Ä–∞–±–æ—á–∏–µ –¥–Ω–∏)
```

### 5. –ü—Ä–æ–µ–∫—Ç–Ω—ã–µ KPI

```javascript
sum_concrete_m3 = Œ£(concrete_m3 –¥–ª—è subtype="beton")
sum_kros_total_czk = Œ£(kros_total_czk –¥–ª—è –≤—Å–µ—Ö –ø–æ–∑–∏—Ü–∏–π)

project_unit_cost_czk_per_m3 = sum_kros_total_czk / sum_concrete_m3
project_unit_cost_czk_per_t = project_unit_cost_czk_per_m3 / 2.4  // œÅ=2.4 t/m¬≥
```

---

## üóÇÔ∏è –°–¢–†–£–ö–¢–£–†–ê –î–ê–ù–ù–´–•

### Position (–ü–æ–∑–∏—Ü–∏—è)

```typescript
{
  // –í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–û–†–ê–ù–ñ–ï–í–´–ï –ø–æ–ª—è ‚Äî —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º—ã–µ):
  bridge_id: string          // SO201, SO202...
  part_name: string          // Z√ÅKLADY, ≈ò√çMSY, OPƒöRY...
  item_name: string          // –ù–∞–∑–≤–∞–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–∞ (v4.3: –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –∏–∑ PartHeader)
  subtype: Subtype          // beton | bednƒõn√≠ | v√Ωztu≈æ | ...
  unit: string              // M3, m2, kg, ks...
  qty: number               // ‚≠ê v4.3: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ (–¢–û–õ–¨–ö–û –¥–ª—è beton —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ—Ç—Å—è –≤ PartHeader, –¥–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö ‚Äî –∏–∑ –¥—Ä—É–≥–∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤)
  qty_m3_helper?: number    // –°–ø—Ä–∞–≤–æ—á–Ω–æ (–¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Å–∫–æ—Ä–æ—Å—Ç–∏)

  crew_size: number         // –õ—é–¥–µ–π –≤ –±—Ä–∏–≥–∞–¥–µ (default: 4)
  wage_czk_ph: number       // CZK/—á–∞—Å (default: 398)
  shift_hours: number       // –ß–∞—Å–æ–≤/–¥–µ–Ω—å (default: 10)
  days: number              // –î–Ω–µ–π –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (default: 0)

  // –†–∞—Å—á—ë—Ç–Ω—ã–µ –ø–æ–ª—è (–°–ï–†–´–ï ‚Äî readonly):
  labor_hours: number       // = crew_size √ó shift_hours √ó days
  cost_czk: number          // = labor_hours √ó wage_czk_ph
  unit_cost_native: number  // = cost_czk / qty (—Å–ø—Ä–∞–≤–æ—á–Ω–æ)

  concrete_m3: number       // ‚ö†Ô∏è –ö–õ–Æ–ß–ï–í–û–ï: –æ–±—ä—ë–º –±–µ—Ç–æ–Ω–∞ —ç–ª–µ–º–µ–Ω—Ç–∞
  unit_cost_on_m3: number   // ‚≠ê –ì–õ–ê–í–ù–ê–Ø –ú–ï–¢–†–ò–ö–ê: CZK/–º¬≥ –±–µ—Ç–æ–Ω–∞

  // KROS (–ó–ï–õ–Å–ù–´–ï —è—á–µ–π–∫–∏):
  kros_unit_czk: number     // –û–∫—Ä—É–≥–ª—ë–Ω–Ω–∞—è –µ–¥–∏–Ω–∏—á–Ω–∞—è —Ü–µ–Ω–∞
  kros_total_czk: number    // –ü–æ–ª–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å

  // RFI:
  has_rfi?: boolean
  rfi_message?: string
}
```

### HeaderKPI (–®–∞–ø–∫–∞)

```typescript
{
  // –í—Ö–æ–¥–Ω—ã–µ (—Ä—É—á–Ω–æ–π –≤–≤–æ–¥):
  span_length_m?: number
  deck_width_m?: number
  pd_weeks?: number
  days_per_month_mode: 30 | 22  // –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å!

  // –†–∞—Å—á—ë—Ç–Ω—ã–µ —Å—É–º–º—ã:
  sum_concrete_m3: number
  sum_kros_total_czk: number

  // –ï–¥–∏–Ω–∏—á–Ω—ã–µ —Ü–µ–Ω—ã:
  project_unit_cost_czk_per_m3: number
  project_unit_cost_czk_per_t: number

  // ‚≠ê –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:
  estimated_months: number
  estimated_weeks: number

  // –í–∑–≤–µ—à–µ–Ω–Ω—ã–µ —Å—Ä–µ–¥–Ω–∏–µ:
  avg_crew_size: number
  avg_wage_czk_ph: number
  avg_shift_hours: number
  days_per_month: number

  // –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã:
  rho_t_per_m3: number  // = 2.4
}
```

---

## üîÑ –ü–û–¢–û–ö –î–ê–ù–ù–´–• –ë–ï–¢–û–ù–ê (v4.3.2 - –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (v4.3.2 - FINAL CORRECT DESIGN)

**–ü–†–ê–í–ò–õ–¨–ù–´–ô –ü–û–¢–û–ö (v4.3.2):**
```
PartHeader (—Ä—è–¥–æ–º —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º):
  - –ù–∞–∑–≤–∞–Ω–∏–µ "N√°zev ƒç√°sti": "Z√ÅKLADY ZE ≈ΩELEZOBETONU..." üìù
  - Objem betonu: [INPUT 255] m¬≥ ‚Üê üü† –ì–õ–ê–í–ù–û–ï –ü–û–õ–ï! EDITABLE!
         ‚Üì –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç—Å—è ‚Üì
–¢–∞–±–ª–∏—Ü–∞ –ø–æ–∑–∏—Ü–∏–π –†–ê–ó–í–ï–†–ù–£–¢–ê:
         ‚Üì
–°—Ç—Ä–æ–∫–∞ 'beton' (–ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Ä–∞–±–æ—Ç—É –ø–æ –ë–ï–¢–û–ù–ò–†–û–í–ê–ù–ò–Æ):
  - Podtyp: "beton" (—Ç–∏–ø —Ä–∞–±–æ—Ç—ã - –±–µ—Ç–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ)
  - MJ: M3
  - Mno≈æstv√≠: 255 (–∏–∑ PartHeader) ‚Üê —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–æ!
  - LIDI: 4 (–ª—é–¥–∏ –Ω–∞ —Ä–∞–±–æ—Ç–µ)
  - Kƒå/HOD: 398 (–∑–∞—Ä–ø–ª–∞—Ç–∞ –≤ —á–∞—Å)
  - HOD/DEN: 10 (—á–∞—Å–æ–≤ –≤ –¥–µ–Ω—å)
  - DEN: ? (–¥–Ω–∏ –≤—ã—á–∏—Å–ª—è—é—Ç—Å—è!)
         ‚Üì
–§–æ—Ä–º—É–ª–∞ –≤—ã—á–∏—Å–ª—è–µ—Ç:
  concrete_m3 = position.qty = 255  ‚Üê –û—Å–Ω–æ–≤–∞–Ω–∏–µ —Ä–∞—Å—á–µ—Ç–æ–≤!
         ‚Üì
–û—Å—Ç–∞–ª—å–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏ (bednƒõn√≠=–æ–ø–∞–ª—É–±–∫–∞, v√Ωztu≈æ=–∞—Ä–º–∞—Ç—É—Ä–∞):
  - concrete_m3 = findConcreteVolumeForPart() = 255
  - –ò—Å–ø–æ–ª—å–∑—É—é—Ç –¢–û–ñ–ï –æ–±—ä–µ–º –±–µ—Ç–æ–Ω–∞!
         ‚Üì
‚úÖ –í—Å–µ —Ä–∞—Å—á—ë—Ç—ã: unit_cost_on_m3 = cost_czk / 255!
```

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏ —Ñ—É–Ω–∫—Ü–∏–∏ (v4.3.2 FINAL)

#### PartHeader.tsx (–ù–ê–ó–í–ê–ù–ò–ï + –û–ë–™–ï–ú –ë–ï–¢–û–ù–ê)
```typescript
// –ü–†–ê–í–ò–õ–¨–ù–û: –¥–≤–∞ input –ø–æ–ª—è
interface Props {
  itemName?: string;
  betonQuantity: number;  // ‚Üê –û–±—ä–µ–º –±–µ—Ç–æ–Ω–∞!
  onItemNameUpdate: (itemName: string) => void;
  onBetonQuantityUpdate: (quantity: number) => void;  // ‚Üê –°–∏–Ω—Ö—Ä–æ!
  isLocked: boolean;
}

export default function PartHeader({
  itemName,
  betonQuantity,
  onItemNameUpdate,
  onBetonQuantityUpdate,
  isLocked
}: Props) {
  return (
    <div className="part-header-container">
      {/* Input 1: –ù–∞–∑–≤–∞–Ω–∏–µ */}
      <input
        type="text"
        value={itemName}
        onBlur={handleNameBlur}
        disabled={isLocked}
        placeholder="Z√ÅKLADY ZE ≈ΩELEZOBETONU DO C30/37"
      />

      {/* Input 2: –û–±—ä–µ–º –±–µ—Ç–æ–Ω–∞ - –ì–õ–ê–í–ù–û–ï –ü–û–õ–ï! */}
      <div className="concrete-params">
        <label>Objem betonu celkem:</label>
        <input
          type="number"
          className="concrete-input"  // üü† –û—Ä–∞–Ω–∂–µ–≤–æ–µ!
          value={editedBeton}
          onChange={handleBetonChange}
          onBlur={handleBetonBlur}  // ‚Üê –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ!
          disabled={isLocked}
          step="0.01"
          min="0"
          placeholder="255"
        />
        <span>m¬≥</span>
      </div>
    </div>
  );
}
```

#### PositionRow.tsx (BETON - EDITABLE!)
```typescript
// –ü–†–ê–í–ò–õ–¨–ù–û: beton –ù–ï –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω, —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ—Ç—Å—è —Å–≤–æ–±–æ–¥–Ω–æ
<td className="cell-input">
  <input
    type="number"
    step="0.01"
    className="input-cell"  // üü† –û—Ä–∞–Ω–∂–µ–≤—ã–π input!
    value={getValue('qty')}
    onChange={(e) => handleFieldChange('qty', parseFloat(e.target.value) || 0)}
    onBlur={handleBlur}
    disabled={isLocked}  // ‚Üê –¢–û–õ–¨–ö–û –µ—Å–ª–∏ snapshot locked!
    title={
      position.subtype === 'beton'
        ? 'Objem betonu v m¬≥ (—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–æ–≤–∞–Ω–æ —Å PartHeader –≤—ã—à–µ)'
        : 'Mno≈æstv√≠ v mƒõrn√Ωch jednotk√°ch'
    }
  />
</td>
```

#### PositionsTable.tsx (–°–ò–ù–•–†–û–ù–ò–ó–ê–¶–ò–Ø)
```typescript
// –ü–†–ê–í–ò–õ–¨–ù–û: handleBetonQuantityUpdate() —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç PartHeader ‚Üí Table
const handleBetonQuantityUpdate = (partName: string, newQuantity: number) => {
  // –ù–∞—Ö–æ–¥–∏–º beton position –≤ —á–∞—Å—Ç–∏
  const betonPosition = positions.find(
    p => p.part_name === partName && p.subtype === 'beton'
  );

  // –û–±–Ω–æ–≤–ª—è–µ–º –µ–≥–æ qty
  updatePositions([{
    ...betonPosition,
    qty: newQuantity  // ‚Üê –≠—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–µ–∑–¥–µ!
  }]);
};

// PartHeader –ø–µ—Ä–µ–¥–∞–µ—Ç:
<PartHeader
  betonQuantity={betonQty}  // ‚Üê —á–∏—Ç–∞–µ—Ç —Ç–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
  onBetonQuantityUpdate={(qty) => handleBetonQuantityUpdate(partName, qty)}  // ‚Üê –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç
  ...
/>
```

### –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –î–í–£–°–¢–û–†–û–ù–ù–Ø–Ø —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è

**–°—Ü–µ–Ω–∞—Ä–∏–π 1: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–µ–Ω—è–µ—Ç –≤ PartHeader**
```
PartHeader [255] ‚Üí onBetonQuantityUpdate() ‚Üí PositionsTable
  ‚Üì
updatePositions({beton, qty: 255}) ‚Üí backend
  ‚Üì
React Query –æ–±–Ω–æ–≤–ª—è–µ—Ç positions
  ‚Üì
PartHeader –ø–µ—Ä–µ—Ä–∏—Å–æ–≤—ã–≤–∞–µ—Ç—Å—è: betonQuantity = 255 ‚úì
Table —Å—Ç—Ä–æ–∫–∞ beton –ø–µ—Ä–µ—Ä–∏—Å–æ–≤—ã–≤–∞–µ—Ç—Å—è: qty = 255 ‚úì
```

**–°—Ü–µ–Ω–∞—Ä–∏–π 2: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–µ–Ω—è–µ—Ç –≤ —Ç–∞–±–ª–∏—Ü–µ (beton row)**
```
PositionRow [255] ‚Üí handleFieldChange() ‚Üí updatePositions()
  ‚Üì
backend –æ–±–Ω–æ–≤–ª—è–µ—Ç
  ‚Üì
React Query –æ–±–Ω–æ–≤–ª—è–µ—Ç positions
  ‚Üì
PartHeader –ø–µ—Ä–µ—Ä–∏—Å–æ–≤—ã–≤–∞–µ—Ç—Å—è: betonQuantity = 255 (–≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è!) ‚úì
```

**–ö–ª—é—á–µ–≤–æ–π –º–æ–º–µ–Ω—Ç:** betonQuantity –≤ PartHeader –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –ö–ê–ñ–î–´–ô –†–ê–ó:
```typescript
betonQuantity={partPositions
  .filter(p => p.subtype === 'beton')
  .reduce((sum, p) => sum + (p.qty || 0), 0)}
```

–≠—Ç–æ –∑–Ω–∞—á–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–µ –≤ –õ–Æ–ë–û–ú –º–µ—Å—Ç–µ –±—É–¥–µ—Ç –≤–∏–¥–Ω–æ –≤–µ–∑–¥–µ! ‚úÖ

### –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è (v4.3.1)

#### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç –æ–±—ä—ë–º –±–µ—Ç–æ–Ω–∞
```
1. –û—Ç–∫—Ä—ã–≤–∞–µ—Ç —á–∞—Å—Ç—å –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏: "Z√ÅKLADY"
2. –í–∏–¥–∏—Ç PartHeader —Å –ø–æ–ª–µ–º "N√°zev ƒç√°sti: [Z√ÅKLADY ZE ≈ΩELEZOBETONU...]"
3. –†–∞—Å–∫—Ä—ã–≤–∞–µ—Ç —Ç–∞–±–ª–∏—Ü—É –ø–æ–∑–∏—Ü–∏–π (click –Ω–∞ —Å—Ç—Ä–µ–ª–∫—É ‚ñº)
4. –ù–∞—Ö–æ–¥–∏—Ç —Å—Ç—Ä–æ–∫—É —Å "beton" (–ø–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞)
5. –í –∫–æ–ª–æ–Ω–∫–µ "Mno≈æstv√≠" –≤–∏–¥–∏—Ç –æ—Ä–∞–Ω–∂–µ–≤—ã–π INPUT
6. ‚úçÔ∏è –í–≤–æ–¥–∏—Ç: 43.8 (–º¬≥)
7. –ù–∞–∂–∏–º–∞–µ—Ç Tab –∏–ª–∏ –∫–ª–∏–∫–∞–µ—Ç –≤–Ω–µ –ø–æ–ª—è (onBlur)
8. handleBlur() ‚Üí updatePositions([{id: ..., qty: 43.8}]) ‚Üí backend
9. Backend –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç:
   - concrete_m3 = 43.8 (–¥–ª—è beton position)
   - unit_cost_on_m3 = cost_czk / 43.8 ‚úì (–¥–ª—è –≤—Å–µ—Ö subtypes —á–∞—Å—Ç–∏)
10. React Query –∏–Ω–≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç –∫—ç—à
11. –¢–∞–±–ª–∏—Ü–∞ —Ä–µ-—Ä–µ–Ω–¥–µ—Ä–∏—Ç—Å—è:
    - –°—Ç—Ä–æ–∫–∞ 'beton': qty = 43.8 (–æ—Ä–∞–Ω–∂–µ–≤—ã–π, —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º—ã–π) ‚úçÔ∏è
    - –°—Ç—Ä–æ–∫–∞ 'bednƒõn√≠': concrete_m3 = 43.8 (–≤—ã—á–∏—Å–ª–µ–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏!)
    - –°—Ç—Ä–æ–∫–∞ 'v√Ωztu≈æ': concrete_m3 = 43.8 (–≤—ã—á–∏—Å–ª–µ–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏!)
    - KPI: sum_concrete_m3 = 43.8 –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è
    - –í—Å–µ Kƒç/m¬≥ –ø–µ—Ä–µ—Å—á–∏—Ç–∞–Ω—ã! ‚úÖ
```

#### –°—Ü–µ–Ω–∞—Ä–∏–π 2: Excel –∏–º–ø–æ—Ä—Ç (–≥–æ—Ç–æ–≤–æ!)
```
Excel —Å–æ–¥–µ—Ä–∂–∏—Ç: "ƒå√ÅST KONSTRUKCE" | "SUBTYPE" | "QTY" | "MJ"
–ü—Ä–∏–º–µ—Ä:          "Z√ÅKLADY"        | "beton"   | 43.8  | m3
           ‚Üì
Parser —á–∏—Ç–∞–µ—Ç –∏ —Å–æ–∑–¥–∞—ë—Ç positions
           ‚Üì
Frontend –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Ç–∞–±–ª–∏—Ü—É
           ‚Üì
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç –≥–æ—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å: –∫–ª–∏–∫–∞–µ—Ç –Ω–∞ –æ—Ä–∞–Ω–∂–µ–≤—ã–π input –≤ beton —Å—Ç—Ä–æ–∫–µ
           ‚Üì
–í—Å—ë –æ—Å—Ç–∞–ª—å–Ω–æ–µ –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏! ‚úÖ
```

### CSS —Å—Ç–∏–ª–∏ (v4.3)

```css
/* –†–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º–æ–µ –ø–æ–ª–µ –±–µ—Ç–æ–Ω–∞ –≤ PartHeader */
.concrete-input {
  background: var(--input-bg);      /* üü† #FFA726 –æ—Ä–∞–Ω–∂–µ–≤—ã–π */
  border: 2px solid #FF9800;        /* –û—Ä–∞–Ω–∂–µ–≤—ã–π –±–æ—Ä–¥–µ—Ä */
  padding: 6px 8px;
  width: 100px;                     /* –ö–æ–º–ø–∞–∫—Ç–Ω—ã–π —Ä–∞–∑–º–µ—Ä */
  text-align: right;                /* –í—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ —á–∏—Å–µ–ª */
  font-family: monospace;           /* –ú–æ–Ω–æ-—à—Ä–∏—Ñ—Ç –¥–ª—è —á–∏—Å–µ–ª */
}

/* Read-only –ø–æ–ª–µ –≤ —Ç–∞–±–ª–∏—Ü–µ –¥–ª—è beton */
.input-cell.readonly-style input {
  background: var(--bg-tertiary);   /* üîí #E8E8E8 —Å–µ—Ä—ã–π */
  border-color: var(--border-light);
  color: var(--text-secondary);
  cursor: not-allowed;              /* –ó–∞–ø—Ä–µ—Ç–Ω—ã–π –∫—É—Ä—Å–æ—Ä */
}
```

---

## üé® –î–ò–ó–ê–ô–ù (–í–ê–ñ–ù–û!)

### –¶–≤–µ—Ç–æ–≤–∞—è —Å—Ö–µ–º–∞

```css
/* –ë–µ—Ç–æ–Ω–Ω–∞—è –æ—Å–Ω–æ–≤–∞ */
--light-concrete: #F5F5F5    /* –§–æ–Ω —Å—Ç—Ä–∞–Ω–∏—Ü—ã */
--medium-concrete: #E8E8E8   /* –ö–∞—Ä—Ç–æ—á–∫–∏, —Å–µ–∫—Ü–∏–∏ */
--divider-border: #D0D0D0    /* –õ–∏–Ω–∏–∏ */

/* –ê–∫—Ü–µ–Ω—Ç—ã */
--primary-action: #1E5A96    /* –°–∏–Ω–∏–π (–∫–Ω–æ–ø–∫–∏, –∑–∞–≥–æ–ª–æ–≤–∫–∏) */
--secondary: #F39C12          /* –û—Ä–∞–Ω–∂–µ–≤—ã–π (–ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è) */
--success: #27AE60            /* –ó–µ–ª—ë–Ω—ã–π (KROS) */
--error: #E74C3C              /* –ö—Ä–∞—Å–Ω—ã–π (RFI) */

/* ‚≠ê INPUT CELLS ‚Äî –ê–ü–ï–õ–¨–°–ò–ù–û–í–´–ï! */
--input-bg: #FFA726           /* –§–æ–Ω —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º—ã—Ö –ø–æ–ª–µ–π */
--input-border: #FF9800       /* –ë–æ—Ä–¥–µ—Ä */
--input-focus: #FF7043        /* –§–æ–∫—É—Å (2px ring) */

/* –¢–∞–±–ª–∏—Ü–∞ */
--computed-cells: #F0F0F0     /* –°–µ—Ä—ã–µ readonly */
--kros-success-bg: #F0FFF4    /* –ó–µ–ª—ë–Ω—ã–π —Ñ–æ–Ω KROS */
--rfi-warning: #FEE8E8        /* –ö—Ä–∞—Å–Ω—ã–π —Ñ–æ–Ω RFI */
```

### –ü—Ä–∞–≤–∏–ª–∞ UI

1. **–í—Å–µ input-–ø–æ–ª—è (—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º—ã–µ):**
   - –§–æ–Ω `#FFA726` (–∞–ø–µ–ª—å—Å–∏–Ω–æ–≤—ã–π)
   - –ë–æ—Ä–¥–µ—Ä `#FF9800`
   - –ü—Ä–∏ —Ñ–æ–∫—É—Å–µ: ring `#FF7043` (2px)

2. **Readonly –ø–æ–ª—è (—Ä–∞—Å—á—ë—Ç–Ω—ã–µ):**
   - –§–æ–Ω `#F0F0F0` (—Å–≤–µ—Ç–ª–æ-—Å–µ—Ä—ã–π)
   - –®—Ä–∏—Ñ—Ç bold, tabular-nums
   - –ö—É—Ä—Å–æ—Ä: default

3. **KROS-—è—á–µ–π–∫–∏:**
   - –§–æ–Ω `#F0FFF4` (—Å–≤–µ—Ç–ª–æ-–∑–µ–ª—ë–Ω—ã–π)
   - –¢–µ–∫—Å—Ç `#27AE60` (–∑–µ–ª—ë–Ω—ã–π)
   - Font-weight: 600

4. **RFI-—Å—Ç—Ä–æ–∫–∏:**
   - –§–æ–Ω –≤—Å–µ–π —Å—Ç—Ä–æ–∫–∏: `#FEE8E8`
   - Badge: –∫—Ä–∞—Å–Ω—ã–π —Å –±–µ–ª—ã–º —Ç–µ–∫—Å—Ç–æ–º

---

## üèõÔ∏è –ê–†–•–ò–¢–ï–ö–¢–£–†–ê

### –ú–æ–Ω–æ—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π

```
monolit-planner/
‚îú‚îÄ‚îÄ backend/          ‚Üê Node.js + Express + SQLite
‚îú‚îÄ‚îÄ frontend/         ‚Üê React + TypeScript + Vite
‚îú‚îÄ‚îÄ shared/           ‚Üê –û–±—â–∏–µ —Ç–∏–ø—ã –∏ —Ñ–æ—Ä–º—É–ª—ã
‚îú‚îÄ‚îÄ render.yaml       ‚Üê –ö–æ–Ω—Ñ–∏–≥ –¥–µ–ø–ª–æ—è
‚îú‚îÄ‚îÄ DEPLOY.md         ‚Üê –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏
‚îú‚îÄ‚îÄ CLAUDE.MD         ‚Üê ‚≠ê –≠–¢–û–¢ –§–ê–ô–õ (–¥–ª—è AI)
‚îî‚îÄ‚îÄ README.md         ‚Üê –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

### Backend Stack

- **Node.js 18+** + Express.js
- **SQLite** (better-sqlite3) ‚Äî –≤—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –ë–î
- **XLSX** (xlsx) ‚Äî –ø–∞—Ä—Å–∏–Ω–≥ Excel
- **Multer** ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤
- **API:** REST (JSON)

**–í–∞–∂–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã:**
- `calculator.js` ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ñ–æ—Ä–º—É–ª—ã –∏–∑ shared
- `parser.js` ‚Äî –ø–∞—Ä—Å–∏—Ç XLSX, –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç bridge_id
- `exporter.js` ‚Äî –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç XLSX/CSV –¥–ª—è KROS4

### Frontend Stack

- **React 18** + TypeScript 5
- **Vite 5** ‚Äî —Å–±–æ—Ä—â–∏–∫
- **TanStack React Query** ‚Äî –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ API
- **Axios** ‚Äî HTTP-–∫–ª–∏–µ–Ω—Ç
- **Context API** ‚Äî –≥–ª–æ–±–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ

**–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**
- `Header` ‚Äî –≤—ã–±–æ—Ä –º–æ—Å—Ç–∞, –∏–º–ø–æ—Ä—Ç, —ç–∫—Å–ø–æ—Ä—Ç, –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å –¥–Ω–µ–π
- `Sidebar` ‚Äî —Å–ø–∏—Å–æ–∫ –º–æ—Å—Ç–æ–≤, —Ñ–∏–ª—å—Ç—Ä—ã
- `KPIPanel` ‚Äî –º–µ—Ç—Ä–∏–∫–∏ (–º–µ—Å—è—Ü—ã, –Ω–µ–¥–µ–ª–∏, CZK/–º¬≥...)
- `PositionsTable` ‚Äî —Ç–∞–±–ª–∏—Ü–∞ —Å –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–æ–π –ø–æ part_name
- `PositionRow` ‚Äî —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º–∞—è —Å—Ç—Ä–æ–∫–∞ (–∞–ø–µ–ª—å—Å–∏–Ω–æ–≤—ã–µ inputs!)

### Shared Package

**–¶–µ–ª—å:** –û–¥–Ω–∞ –≤–µ—Ä—Å–∏—è —Ñ–æ—Ä–º—É–ª –¥–ª—è —Ñ—Ä–æ–Ω—Ç–∞ –∏ –±—ç–∫–∞

```typescript
// types.ts ‚Äî –≤—Å–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã
// formulas.ts ‚Äî –≤—Å–µ —Ä–∞—Å—á—ë—Ç—ã (calculatePositionFields, calculateHeaderKPI...)
// constants.ts ‚Äî –¥–µ—Ñ–æ–ª—Ç—ã, —Ü–≤–µ—Ç–∞, feature flags
```

---

## üîÑ WORKFLOW –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø

1. **–û—Ç–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ** ‚Üí –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø—É—Å—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
2. **–ù–∞–∂–∞—Ç—å "Upload XLSX"** ‚Üí –≤—ã–±—Ä–∞—Ç—å —Ñ–∞–π–ª —Å –º–æ—Å—Ç–∞–º–∏
3. **Backend –ø–∞—Ä—Å–∏—Ç XLSX:**
   - –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç bridge_id (–∏–∑ –∫–æ–ª–æ–Ω–∫–∏ "Po≈ô. ƒç√≠slo" –∏–ª–∏ –∞–Ω–∞–ª–æ–≥–∞)
   - –ü—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –º—ç–ø–ø–∏–Ω–≥ –∫–æ–ª–æ–Ω–æ–∫
   - –ü—Ä–∏–º–µ–Ω—è–µ—Ç –º—ç–ø–ø–∏–Ω–≥ ‚Üí –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–∑–∏—Ü–∏–∏
4. **–í—ã–±—Ä–∞—Ç—å –º–æ—Å—Ç** –∏–∑ —Å–ø–∏—Å–∫–∞ –≤ Sidebar
5. **Backend —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç –≤—Å—ë:**
   - –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç concrete_m3 –¥–ª—è –∫–∞–∂–¥–æ–π –ø–æ–∑–∏—Ü–∏–∏
   - –í—ã—á–∏—Å–ª—è–µ—Ç unit_cost_on_m3 (‚≠ê –≥–ª–∞–≤–Ω–∞—è –º–µ—Ç—Ä–∏–∫–∞)
   - –û–∫—Ä—É–≥–ª—è–µ—Ç KROS
   - –í—ã—á–∏—Å–ª—è–µ—Ç –º–µ—Å—è—Ü—ã/–Ω–µ–¥–µ–ª–∏
6. **Frontend –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç:**
   - KPI-–ø–∞–Ω–µ–ª—å —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏
   - –¢–∞–±–ª–∏—Ü—É –ø–æ–∑–∏—Ü–∏–π (–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ part_name)
   - –ê–ø–µ–ª—å—Å–∏–Ω–æ–≤—ã–µ input-—è—á–µ–π–∫–∏
   - –°–µ—Ä—ã–µ readonly-—è—á–µ–π–∫–∏
7. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ—Ç** (qty, crew_size, days...) ‚Üí –∞–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
8. **–ü–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç —Ä–µ–∂–∏–º –¥–Ω–µ–π** (30 ‚Üî 22) ‚Üí –ø–µ—Ä–µ—Å—á—ë—Ç –º–µ—Å—è—Ü–µ–≤/–Ω–µ–¥–µ–ª—å
9. **–≠–∫—Å–ø–æ—Ä—Ç XLSX/CSV** ‚Üí –≥–æ—Ç–æ–≤–æ –¥–ª—è KROS4

---

## ‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ü–†–ê–í–ò–õ–ê

### 1. Zero Regression
- **–ù–ï –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤—ã–≤–∞—Ç—å** –∏—Å—Ö–æ–¥–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏ XLSX
- –¢–æ–ª—å–∫–æ **–º—ç–ø–ø–∏–Ω–≥ —á–µ—Ä–µ–∑ UI**

### 2. RFI-—Å–∏—Å—Ç–µ–º–∞ (Request For Information)
- –ü–æ–¥—Å–≤–µ—á–∏–≤–∞–µ—Ç –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- **–ù–ï –±–ª–æ–∫–∏—Ä—É–µ—Ç** —Ä–∞—Å—á—ë—Ç—ã (—Ä–∞—Å—á—ë—Ç—ã –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —Å 0 –∏–ª–∏ null)
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –≤—Ä—É—á–Ω—É—é –≤–≤–µ—Å—Ç–∏ –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è

**–ü—Ä–∏–º–µ—Ä—ã RFI:**
- ‚ùå "–ù–µ –Ω–∞–π–¥–µ–Ω–∞ —Å—Ç—Ä–æ–∫–∞ beton –¥–ª—è —á–∞—Å—Ç–∏ '≈ò√çMSY'"
- ‚ö†Ô∏è "–ü—É—Å—Ç–æ: den (koef 1). –†–∞—Å—á—ë—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω (cost_czk=0)"
- ‚ÑπÔ∏è "–ù–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω Po≈ô. ƒç√≠slo ‚Äî –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –º—ç–ø–ø–∏–Ω–≥"

### 3. –§–æ—Ä–º—É–ª—ã –ø—Ä–æ–∑—Ä–∞—á–Ω—ã
- –ö–∞–∂–¥–æ–µ —Ä–∞—Å—á—ë—Ç–Ω–æ–µ –ø–æ–ª–µ ‚Üí tooltip —Å —Ñ–æ—Ä–º—É–ª–æ–π
- –ü—Ä–∏–º–µ—Ä: –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ –Ω–∞ `kros_unit_czk` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è:
  ```
  = ceil(unit_cost_on_m3 / 50) √ó 50
  = ceil(729.45 / 50) √ó 50
  = ceil(14.589) √ó 50
  = 15 √ó 50
  = 750 CZK
  ```

### 4. –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å –¥–Ω–µ–π/–º–µ—Å—è—Ü–∞
- **30 –¥–Ω–µ–π/–º–µ—Å—è—Ü** ‚Äî –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–∞—è —Å—Ç—Ä–æ–π–∫–∞ (7 –¥–Ω–µ–π –≤ –Ω–µ–¥–µ–ª—é)
- **22 –¥–Ω—è/–º–µ—Å—è—Ü** ‚Äî —Ä–∞–±–æ—á–∏–µ –¥–Ω–∏ (5 –¥–Ω–µ–π –≤ –Ω–µ–¥–µ–ª—é + –ø—Ä–∞–∑–¥–Ω–∏–∫–∏)
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ `project_config.days_per_month_mode`
- –ü—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ ‚Üí –ø–µ—Ä–µ—Å—á—ë—Ç –º–µ—Å—è—Ü–µ–≤/–Ω–µ–¥–µ–ª—å –¥–ª—è –≤—Å–µ—Ö –º–æ—Å—Ç–æ–≤

---

## üöÄ DEPLOYMENT (Render)

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Blueprint! (render.yaml)

**–ù–ï —Å–æ–∑–¥–∞–≤–∞–π –≤—Ä—É—á–Ω—É—é "New Web Service"!**

### –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å:

1. **Push –∫–æ–¥ –Ω–∞ GitHub** ‚úÖ (—É–∂–µ —Å–¥–µ–ª–∞–Ω–æ)

2. **–í Render Dashboard:**
   - –ù–∞–∂–∞—Ç—å **"New" ‚Üí "Blueprint"**
   - –í—ã–±—Ä–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π `alpro1000/Monolit-Planner`
   - Render –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞–π–¥—ë—Ç `render.yaml`
   - –ù–∞–∂–∞—Ç—å **"Create New Resources"**

3. **Render —Å–æ–∑–¥–∞—Å—Ç 2 —Å–µ—Ä–≤–∏—Å–∞:**
   - `monolit-planner-api` (backend)
   - `monolit-planner-frontend` (frontend)

4. **–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –¥–µ–ø–ª–æ—è backend:**
   - Backend –ø–æ–ª—É—á–∏—Ç URL —Ç–∏–ø–∞: `https://monolit-planner-api.onrender.com`
   - ‚ö†Ô∏è **–í–ê–ñ–ù–û**: –ù—É–∂–Ω–æ –≤—Ä—É—á–Ω—É—é –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å frontend!

5. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ frontend (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û!):**
   - –û—Ç–∫—Ä–æ–π Render Dashboard ‚Üí `monolit-planner-frontend` ‚Üí Environment
   - –î–æ–±–∞–≤—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `VITE_API_URL` = `https://monolit-planner-api.onrender.com`
   - –ù–∞–∂–º–∏ **"Save Changes"** ‚Üí frontend –ø–µ—Ä–µ—Å–æ–±—Ä—ë—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

6. **(–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å CORS:**
   - –ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è frontend –ø–æ–ª—É—á–∏—Ç URL —Ç–∏–ø–∞: `https://monolit-planner-frontend.onrender.com`
   - –û—Ç–∫—Ä–æ–π backend Environment
   - –ò–∑–º–µ–Ω–∏ `CORS_ORIGIN` —Å `*` –Ω–∞ URL frontend'–∞ –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

7. **URLs:**
   - Frontend: `https://monolit-planner-frontend.onrender.com`
   - Backend: `https://monolit-planner-api.onrender.com`

### ‚ö†Ô∏è –ù–ï –¥–µ–ª–∞–π:
- ‚ùå New Web Service –≤—Ä—É—á–Ω—É—é (—Å–ª–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —Å–≤—è–∑–∏)
- ‚ùå –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å build commands –≤—Ä—É—á–Ω—É—é (–≤—Å—ë –≤ render.yaml)

### ‚úÖ –î–µ–ª–∞–π:
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π Blueprint (render.yaml)
- ‚úÖ Auto-deploy: push –≤ main ‚Üí –∞–≤—Ç–æ–¥–µ–ø–ª–æ–π

### üìù –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å render.yaml:

**Backend (Web Service):**
```yaml
- type: web
  name: monolit-planner-api
  env: node
  plan: free
  buildCommand: ...
  startCommand: ...
```

**Frontend (Static Site):**
```yaml
- type: web              # ‚ö†Ô∏è –ù–ï "static"!
  name: monolit-planner-frontend
  env: static            # –≠—Ç–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ static site
  buildCommand: ...
  staticPublishPath: frontend/dist
```

‚ö†Ô∏è **–í–ê–ñ–ù–û:**
- Render Blueprint –ù–ï –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç `type: static`
- –ò—Å–ø–æ–ª—å–∑—É–π `type: web` + `env: static` –¥–ª—è static sites
- –ù–ï –¥–æ–±–∞–≤–ª—è–π `region` ‚Äî –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è free tier
- **Node.js –≤–µ—Ä—Å–∏—è –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–ê**: better-sqlite3 —Ç—Ä–µ–±—É–µ—Ç Node 18.x
  - ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω .nvmrc ‚Üí 18.20.4
  - ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω NODE_VERSION –≤ render.yaml
  - ‚ùå Node 25.x –ù–ï –†–ê–ë–û–¢–ê–ï–¢ (–æ—à–∏–±–∫–∏ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ C++)

### üîç –ü–æ—á–µ–º—É CORS_ORIGIN="*" –∏ VITE_API_URL=sync:false - –ù–ï –∫–æ—Å—Ç—ã–ª–∏?

**–ü—Ä–æ–±–ª–µ–º–∞ fromService (circular dependency):**

–ü—Ä–∏ –ø–µ—Ä–≤–æ–º –¥–µ–ø–ª–æ–µ —á–µ—Ä–µ–∑ Blueprint —Å fromService –≤–æ–∑–Ω–∏–∫–∞–µ—Ç deadlock:
```yaml
# ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û - —Å–æ–∑–¥–∞—ë—Ç deadlock:
backend:
  envVars:
    - key: CORS_ORIGIN
      fromService:
        name: frontend  # Backend –∂–¥—ë—Ç URL frontend

frontend:
  envVars:
    - key: VITE_API_URL
      fromService:
        name: backend   # Frontend –∂–¥—ë—Ç URL backend
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** Backend –∂–¥—ë—Ç frontend ‚Üí Frontend –∂–¥—ë—Ç backend ‚Üí **–ë–µ—Å–∫–æ–Ω–µ—á–Ω—ã–π —Ü–∏–∫–ª!**

**‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û–ï —Ä–µ—à–µ–Ω–∏–µ:**

1. **CORS_ORIGIN = "\*"**:
   - –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞ –¥–ª—è development
   - –ü–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –æ—Ç –ª—é–±–æ–≥–æ origin –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –¥–µ–ø–ª–æ–µ
   - –ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è frontend –º–æ–∂–Ω–æ –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –¥–æ–º–µ–Ω
   - –í production: —É—Å—Ç–∞–Ω–æ–≤–∏ `CORS_ORIGIN=https://monolit-planner-frontend.onrender.com`

2. **VITE_API_URL = sync:false**:
   - –ì–æ–≤–æ—Ä–∏—Ç Render –ù–ï –∂–¥–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –æ—Ç –¥—Ä—É–≥–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
   - –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –≤—Ä—É—á–Ω—É—é –≤ Dashboard –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è backend
   - –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω –¥–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Å–∞–π—Ç–æ–≤ —Å –æ—Ç–¥–µ–ª—å–Ω—ã–º API

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã –∏ –ø–æ—á–µ–º—É –æ–Ω–∏ —Ö—É–∂–µ:**

- ‚ùå **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–¥–∏–Ω —Å–µ—Ä–≤–∏—Å**: —Ç–µ—Ä—è–µ–º –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å –∏ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏
- ‚ùå **Reverse proxy –Ω–∞ frontend**: —É—Å–ª–æ–∂–Ω—è–µ—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É, –Ω—É–∂–µ–Ω nginx/express
- ‚ùå **–û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ URL (/api)**: –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Å–∞–π—Ç–æ–≤ –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –¥–æ–º–µ–Ω–∞—Ö

**–ò—Ç–æ–≥:** –≠—Ç–æ –ù–ï –∫–æ—Å—Ç—ã–ª–∏, –∞ –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –¥–ª—è –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤!

### ü§ñ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–±–æ—Ä–∫–∞ shared –ø–∞–∫–µ—Ç–∞

**ensure-shared-build.js** (–≤ backend/scripts –∏ frontend/scripts):

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ TypeScript –≤ shared/
- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
- –°–æ–±–∏—Ä–∞–µ—Ç shared –ø–∞–∫–µ—Ç, –µ—Å–ª–∏ dist/ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç
- –ü—Ä–æ–ø—É—Å–∫–∞–µ—Ç —Å–±–æ—Ä–∫—É, –µ—Å–ª–∏ dist/ —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –ù–µ –Ω—É–∂–Ω–æ —è–≤–Ω–æ —Å–æ–±–∏—Ä–∞—Ç—å shared –≤ render.yaml buildCommand
- prestart/prebuild —Ö—É–∫–∏ –¥–µ–ª–∞—é—Ç –≤—Å—ë –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- –£—Å–∫–æ—Ä—è–µ—Ç –ª–æ–∫–∞–ª—å–Ω—É—é —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É (—Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤–∞—è —Å–±–æ—Ä–∫–∞)

---

## üìù FEATURE FLAGS

–í—Å–µ –≤ `shared/src/constants.ts`:

```typescript
FEATURE_FLAGS = {
  FF_AI_DAYS_SUGGEST: false,    // AI-–ø–æ–¥—Å–∫–∞–∑–∫–∏ –¥–ª—è –¥–Ω–µ–π
  FF_PUMP_MODULE: false,         // –ú–æ–¥—É–ª—å –±–µ—Ç–æ–Ω–æ–Ω–∞—Å–æ—Å–∞
  FF_ADVANCED_METRICS: false,    // –ê–Ω–∞–ª–∏–∑ —Å–∫–æ—Ä–æ—Å—Ç–∏
  FF_DARK_MODE: false,           // –¢—ë–º–Ω–∞—è —Ç–µ–º–∞
  FF_SPEED_ANALYSIS: false       // –°–∫–æ—Ä–æ—Å—Ç—å –º¬≤/–¥–µ–Ω—å
}
```

**–ö–∞–∫ –≤–∫–ª—é—á–∏—Ç—å:**
```http
POST /api/config
{
  "feature_flags": {
    "FF_DARK_MODE": true
  }
}
```

---

## üéØ ROADMAP (–ë—É–¥—É—â–µ–µ)

- [ ] AI-–ø–æ–¥—Å–∫–∞–∑–∫–∏ –¥–ª—è –¥–Ω–µ–π (ML-–º–æ–¥–µ–ª—å)
- [ ] –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –±–µ—Ç–æ–Ω–æ–Ω–∞—Å–æ—Å–∞
- [ ] –ê–Ω–∞–ª–∏–∑ —Å–∫–æ—Ä–æ—Å—Ç–∏ (–º¬≤/–¥–µ–Ω—å –ø–æ —ç–ª–µ–º–µ–Ω—Ç–∞–º)
- [ ] Multilang (EN, DE)
- [ ] PDF-–æ—Ç—á—ë—Ç—ã
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –±—É—Ö–≥–∞–ª—Ç–µ—Ä–∏–µ–π
- [ ] –ú–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (React Native)

---

## üìå –ò–ù–°–¢–†–£–ö–¶–ò–ò –î–õ–Ø AI

### –ö–æ–≥–¥–∞ –Ω–∞—á–∏–Ω–∞–µ—à—å —Ä–∞–±–æ—Ç—É:

1. **–í–°–ï–ì–î–ê —á–∏—Ç–∞–π CLAUDE.MD** –ø–µ—Ä–µ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º –∑–∞–¥–∞—á
2. –ü—Ä–æ–≤–µ—Ä—å –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å —Ñ–æ—Ä–º—É–ª –≤ `shared/src/formulas.ts`
3. –£–±–µ–¥–∏—Å—å, —á—Ç–æ –¥–∏–∑–∞–π–Ω —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ü–≤–µ—Ç–æ–≤–æ–π –ø–∞–ª–∏—Ç—Ä–µ

### –ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ —Ñ—É–Ω–∫—Ü–∏–π:

1. **–û–±–Ω–æ–≤–∏ CLAUDE.MD** —Å –Ω–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å—é
2. –î–æ–±–∞–≤—å —Ñ–æ—Ä–º—É–ª—ã –≤ —Ä–∞–∑–¥–µ–ª "–ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –§–û–†–ú–£–õ–´"
3. –û–±–Ω–æ–≤–∏ ROADMAP
4. –î–æ–±–∞–≤—å feature flag, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ

### –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ñ–æ—Ä–º—É–ª:

1. **‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ù–û:** –û–±–Ω–æ–≤–∏ `shared/src/formulas.ts`
2. –û–±–Ω–æ–≤–∏ `backend/src/services/calculator.js` (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç shared)
3. –û–±–Ω–æ–≤–∏ CLAUDE.MD —Å –Ω–æ–≤–æ–π —Ñ–æ—Ä–º—É–ª–æ–π
4. –î–æ–±–∞–≤—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –≤ –∫–æ–¥ —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏

### –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –¥–∏–∑–∞–π–Ω–∞:

1. –û–±–Ω–æ–≤–∏ `frontend/src/styles/global.css`
2. –ü—Ä–æ–≤–µ—Ä—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ü–≤–µ—Ç–∞–º –≤ CLAUDE.MD
3. –û–±–Ω–æ–≤–∏ CSS-–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ

### –ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ API endpoints:

1. –î–æ–±–∞–≤—å –≤ `backend/src/routes/`
2. –û–±–Ω–æ–≤–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –≤ README.md
3. –î–æ–±–∞–≤—å –≤ API-–∫–ª–∏–µ–Ω—Ç `frontend/src/services/api.ts`
4. –û–±–Ω–æ–≤–∏ —Ç–∏–ø—ã –≤ `shared/src/types.ts`, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ

---

## üîç DEBUGGING CHECKLIST

### –ï—Å–ª–∏ —Ä–∞—Å—á—ë—Ç—ã –Ω–µ–≤–µ—Ä–Ω—ã–µ:

1. –ü—Ä–æ–≤–µ—Ä—å `concrete_m3` ‚Äî –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ª–∏ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω?
2. –ü—Ä–æ–≤–µ—Ä—å `unit_cost_on_m3` ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ª–∏ concrete_m3 –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞?
3. –ü—Ä–æ–≤–µ—Ä—å KROS-–æ–∫—Ä—É–≥–ª–µ–Ω–∏–µ ‚Äî `Math.ceil`, –Ω–µ `Math.round`!
4. –ü—Ä–æ–≤–µ—Ä—å weighted averages ‚Äî –≤–∑–≤–µ—à–µ–Ω—ã –ª–∏ –ø–æ concrete_m3?

### –ï—Å–ª–∏ UI –Ω–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è:

1. –ü—Ä–æ–≤–µ—Ä—å React Query cache
2. –ü—Ä–æ–≤–µ—Ä—å Context API ‚Äî –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ª–∏ —Å–æ—Å—Ç–æ—è–Ω–∏–µ?
3. –ü—Ä–æ–≤–µ—Ä—å `usePositions` hook ‚Äî –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –ª–∏ invalidation?

### –ï—Å–ª–∏ –∏–º–ø–æ—Ä—Ç XLSX –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:

1. –ü—Ä–æ–≤–µ—Ä—å –ø–∞—Ä—Å–µ—Ä ‚Äî –Ω–∞—Ö–æ–¥–∏—Ç –ª–∏ bridge_id?
2. –ü—Ä–æ–≤–µ—Ä—å –º—ç–ø–ø–∏–Ω–≥ ‚Äî –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ª–∏ –∫–æ–ª–æ–Ω–∫–∏?
3. –ü—Ä–æ–≤–µ—Ä—å –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—é ‚Äî –≤—Å–µ –ª–∏ –ø–æ–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω—ã?

---

## üìä SUCCESS CRITERIA

–ü—Ä–æ–µ–∫—Ç –≥–æ—Ç–æ–≤, –∫–æ–≥–¥–∞:

- ‚úÖ –í—Å–µ –ø–æ–¥—Ç–∏–ø—ã –ø—Ä–∏–≤–µ–¥–µ–Ω—ã –∫ CZK/–º¬≥ –±–µ—Ç–æ–Ω–∞
- ‚úÖ KROS-–æ–∫—Ä—É–≥–ª–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç (–≤–≤–µ—Ä—Ö, —à–∞–≥ 50)
- ‚úÖ –ú–µ—Å—è—Ü—ã –∏ –Ω–µ–¥–µ–ª–∏ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å 30/22 –¥–Ω—è —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –ê–ø–µ–ª—å—Å–∏–Ω–æ–≤—ã–µ input-–ø–æ–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ –æ—Ç–ª–∏—á–∏–º—ã
- ‚úÖ RFI-—Å–∏—Å—Ç–µ–º–∞ –ø–æ–¥—Å–≤–µ—á–∏–≤–∞–µ—Ç –ø—Ä–æ–ø—É—Å–∫–∏ (–Ω–æ –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç)
- ‚úÖ –≠–∫—Å–ø–æ—Ä—Ç XLSX/CSV –≥–æ—Ç–æ–≤ –∫ KROS4
- ‚úÖ –î–µ–ø–ª–æ–π –Ω–∞ Render —á–µ—Ä–µ–∑ Blueprint —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ Frontend –∏ Backend —Ä–∞–±–æ—Ç–∞—é—Ç —Ä–∞–∑–¥–µ–ª—å–Ω–æ

---

## üõ†Ô∏è –£–°–¢–ê–ù–û–í–ö–ê –ò –ù–ê–°–¢–†–û–ô–ö–ê

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã

- **Node.js**: 18.20.4 (–∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–æ –≤ `.nvmrc`)
  - ‚ö†Ô∏è **–ö–†–ò–¢–ò–ß–ù–û**: better-sqlite3 —Ç—Ä–µ–±—É–µ—Ç –∏–º–µ–Ω–Ω–æ Node 18.x
  - ‚ùå Node.js 25.x –ù–ï –†–ê–ë–û–¢–ê–ï–¢ (–æ—à–∏–±–∫–∏ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ C++)
  - –£—Å—Ç–∞–Ω–æ–≤–∫–∞: `nvm install 18.20.4 && nvm use 18.20.4`

- **npm**: –≤–µ—Ä—Å–∏—è 9+
- **Git**: –¥–ª—è –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∏ —Ä–∞–±–æ—Ç—ã —Å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–º

### –õ–æ–∫–∞–ª—å–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞

#### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
```bash
git clone https://github.com/alpro1000/Monolit-Planner.git
cd Monolit-Planner
```

#### 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π shared –ø–∞–∫–µ—Ç–∞
```bash
cd shared
npm install
npm run build
cd ..
```

#### 3. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ backend
```bash
cd backend
npm install
```

**Environment –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (backend/.env):**
```env
NODE_ENV=development
PORT=3001
CORS_ORIGIN=*
DATABASE_URL=./data/monolit.db
```

#### 4. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ frontend
```bash
cd frontend
npm install
```

**Environment –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (frontend/.env.local):**
```env
VITE_API_URL=http://localhost:3001
```

#### 5. –ó–∞–ø—É—Å–∫ –≤ —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

**Backend:**
```bash
cd backend
npm run dev
# –ò–ª–∏ –¥–ª—è production: npm start
```

**Frontend (–≤ –Ω–æ–≤–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ):**
```bash
cd frontend
npm run dev
# –û—Ç–∫—Ä–æ–µ—Ç—Å—è –Ω–∞ http://localhost:5173
```

**–û–±–µ –∫–æ–º–∞–Ω–¥—ã –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ (–∫–æ—Ä–Ω–µ–≤–æ–π –∫–∞—Ç–∞–ª–æ–≥):**
```bash
# –¢—Ä–µ–±—É–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–≥–æ concurrently (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
npm install -g concurrently
concurrently "cd backend && npm run dev" "cd frontend && npm run dev"
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ backend:
```bash
cd backend
npm run dev
# –°–æ–∑–¥–∞—ë—Ç ./data/monolit.db —Å —Ç–∞–±–ª–∏—Ü–∞–º–∏:
# - bridges
# - positions
# - snapshots
# - project_config
# - rfi_messages
```

### –°–±–æ—Ä–∫–∞ –¥–ª—è production

```bash
# Shared –ø–∞–∫–µ—Ç
cd shared && npm run build && cd ..

# Frontend
cd frontend && npm run build
# –†–µ–∑—É–ª—å—Ç–∞—Ç: frontend/dist/

# Backend
cd backend && npm start
# –ó–∞–ø—É—Å–∫–∞–µ—Ç express —Å–µ—Ä–≤–µ—Ä –Ω–∞ –ø–æ—Ä—Ç—É 3001
```

### –†–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ –Ω–∞ Render

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **Blueprint** (`render.yaml`):

1. Push –∫–æ–¥ –Ω–∞ GitHub
2. –í Render Dashboard: **"New" ‚Üí "Blueprint"**
3. –í—ã–±—Ä–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π `alpro1000/Monolit-Planner`
4. Render –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞–π–¥—ë—Ç `render.yaml`
5. –ù–∞–∂–∞—Ç—å **"Create New Resources"**

–ü–æ—Å–ª–µ —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—è:
- Backend –ø–æ–ª—É—á–∏—Ç URL: `https://monolit-planner-api.onrender.com`
- Frontend –ø–æ–ª—É—á–∏—Ç URL: `https://monolit-planner-frontend.onrender.com`
- –í Render Dashboard ‚Üí frontend ‚Üí Environment ‚Üí –¥–æ–±–∞–≤–∏—Ç—å `VITE_API_URL=https://monolit-planner-api.onrender.com`

---

## üìã –°–ï–°–°–ò–Ø v4.3.3 - –†–ï–ó–Æ–ú–ï

### –ü—Ä–æ–±–ª–µ–º—ã, –≤—ã—è–≤–ª–µ–Ω–Ω—ã–µ –≤ –Ω–∞—á–∞–ª–µ —Å–µ—Å—Å–∏–∏

#### 1. ‚ùå Backend –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 500 –æ—à–∏–±–∫—É –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –ø–æ–∑–∏—Ü–∏–π
**–°–∏–º–ø—Ç–æ–º:** `monolit-planner-api.onrender.com/api/positions:1 Failed to load resource: the server responded with a status of 500`

**–ü—Ä–∏—á–∏–Ω–∞:** SQL statement –≤ `backend/src/routes/positions.js` –≤ PUT-–æ–±—Ä–∞–±–æ—Ç—á–∏–∫–µ —Å—Ç—Ä–æ–∏–ª—Å—è –æ–¥–∏–Ω —Ä–∞–∑ –≤ –Ω–∞—á–∞–ª–µ —Ñ—É–Ω–∫—Ü–∏–∏, –∏—Å–ø–æ–ª—å–∑—É—è –∫–ª—é—á–∏ –ø–æ–ª–µ–π –∏–∑ `updates[0]`. –ù–æ –∫–∞–∂–¥–∞—è –ø–æ–∑–∏—Ü–∏—è –º–æ–∂–µ—Ç –∏–º–µ—Ç—å —Ä–∞–∑–Ω—ã–µ –ø–æ–ª—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è, —á—Ç–æ –≤—ã–∑—ã–≤–∞–ª–æ –æ—à–∏–±–∫—É SQL.

**–†–µ—à–µ–Ω–∏–µ:** –ü–µ—Ä–µ–¥–µ–ª–∞–Ω PUT-–æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫—É—é –≥–µ–Ω–µ—Ä–∞—Ü–∏—é SQL –¥–ª—è –ö–ê–ñ–î–û–ì–û –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –æ—Ç–¥–µ–ª—å–Ω–æ.

**–§–∞–π–ª:** `backend/src/routes/positions.js` (v4.3.3)

#### 2. ‚ùå –û–±—ä—ë–º –±–µ—Ç–æ–Ω–∞ –Ω–µ –ø–µ—Ä–µ–Ω–æ—Å–∏—Ç—Å—è –∏–∑ PartHeader –≤ —Ç–∞–±–ª–∏—Ü—É
**–°–∏–º–ø—Ç–æ–º:** –ü—Ä–∏ –≤–≤–æ–¥–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ `Objem betonu celkem:` –ø–æ–ª–µ –≤ PartHeader —ç—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ –Ω–µ –ø–æ—è–≤–ª—è–ª–æ—Å—å –≤ —Å—Ç—Ä–æ–∫–µ beton (Mno≈æstv√≠ –∫–æ–ª–æ–Ω–∫–∞).

**–ü—Ä–∏—á–∏–Ω–∞:**
- –ë—ã–ª–∞ –ø–æ–ø—ã—Ç–∫–∞ —Å–æ–∑–¥–∞—Ç—å —Å–ª–æ–∂–Ω—É—é –¥–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω—é —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é
- –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –±—ã–ª –∑–∞–ø—É—Ç–∞–Ω–Ω—ã–º (–Ω–µ —è—Å–Ω–æ –≥–¥–µ –≤–≤–æ–¥–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ)
- Backend 500 –æ—à–∏–±–∫–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∞–ª–∏ –ø–µ—Ä–µ–¥–∞—á—É –¥–∞–Ω–Ω—ã—Ö

**–†–µ—à–µ–Ω–∏–µ:**
- –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –ø—Ä–æ—Å—Ç–∞—è, –ø–æ–Ω—è—Ç–Ω–∞—è **–æ–¥–Ω–æ—Å—Ç–æ—Ä–æ–Ω—è—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**
- PartHeader —Å–æ–¥–µ—Ä–∂–∏—Ç INPUT –ø–æ–ª–µ "Objem betonu celkem:" –¥–ª—è –≤–≤–æ–¥–∞ –æ–±—ä—ë–º–∞
- –≠—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü—É beton row —á–µ—Ä–µ–∑ `handleBetonQuantityUpdate()`
- –°—Ç—Ä–æ–∫–∞ beton "–∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞" (disabled=true, readonly-style CSS) –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è —Å–ª—É—á–∞–π–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π

**–§–∞–π–ª—ã:**
- `frontend/src/components/PartHeader.tsx` (–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –ø–æ–ª–µ –≤–≤–æ–¥–∞)
- `frontend/src/components/PositionsTable.tsx` (–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏)
- `frontend/src/components/PositionRow.tsx` (–∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞ beton —Å—Ç—Ä–æ–∫–∞)

#### 3. ‚ùå –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç –≤–≤–æ–¥–∏—Ç—å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
**–°–∏–º–ø—Ç–æ–º:** –í –ø–æ–ª—è—Ö –≤–≤–æ–¥–∞ (qty, crew_size, wage_czk_ph, shift_hours, days) –º–æ–∂–Ω–æ –±—ã–ª–æ –≤–≤–µ—Å—Ç–∏ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ —á–∏—Å–ª–∞.

**–ü—Ä–∏—á–∏–Ω–∞:** Input-–ø–æ–ª—è –Ω–µ –∏–º–µ–ª–∏ `min="0"` –∞—Ç—Ä–∏–±—É—Ç–∞ –∏ –Ω–µ –±—ã–ª–æ JavaScript-–≤–∞–ª–∏–¥–∞—Ü–∏–∏.

**–†–µ—à–µ–Ω–∏–µ:**
- –î–æ–±–∞–≤–ª–µ–Ω `min="0"` HTML-–∞—Ç—Ä–∏–±—É—Ç –∫–æ –≤—Å–µ–º —á–∏—Å–ª–æ–≤—ã–º input-–ø–æ–ª—è–º
- –î–æ–±–∞–≤–ª–µ–Ω–∞ JavaScript-–≤–∞–ª–∏–¥–∞—Ü–∏—è: `Math.max(0, parseFloat(...) || 0)` –≤ onChange –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞—Ö
- –î–≤–æ–π–Ω–∞—è –∑–∞—â–∏—Ç–∞ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –≤–≤–æ–¥ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π

**–§–∞–π–ª:** `frontend/src/components/PositionRow.tsx` (–æ–±–Ω–æ–≤–ª–µ–Ω—ã –≤—Å–µ —á–∏—Å–ª–æ–≤—ã–µ –ø–æ–ª—è)

### –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

#### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –±–µ—Ç–æ–Ω–∞ (v4.3.3 - –û–ö–û–ù–ß–ê–¢–ï–õ–¨–ù–ê–Ø)

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ PartHeader (—Ä—è–¥–æ–º —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º)          ‚îÇ
‚îÇ ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚îÇ
‚îÇ "N√°zev ƒç√°sti": [Z√ÅKLADY...] üìù          ‚îÇ
‚îÇ "Objem betonu celkem": [255] m¬≥ ‚Üê INPUT ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                   ‚îÇ onBetonQuantityUpdate()
                   ‚Üì
        updatePositions(updates)
                   ‚Üì
     PUT /api/positions (backend)
                   ‚Üì
Backend calculates: concrete_m3, unit_cost_on_m3, etc.
                   ‚Üì
        Response with full positions[]
                   ‚Üì
    React Query invalidates + refetches
                   ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Table positions (—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–æ)       ‚îÇ
‚îÇ ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚îÇ
‚îÇ beton row:                               ‚îÇ
‚îÇ - Mno≈æstv√≠: 255 m¬≥ (READ-ONLY üîí)       ‚îÇ
‚îÇ - LIDI: 4                                ‚îÇ
‚îÇ - Kƒå/HOD: 398                            ‚îÇ
‚îÇ - –û—Å—Ç–∞–ª—å–Ω—ã–µ fields —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º—ã         ‚îÇ
‚îÇ                                          ‚îÇ
‚îÇ –æ—Å—Ç–∞–ª—å–Ω—ã–µ rows (bednƒõn√≠, v√Ωztu≈æ):      ‚îÇ
‚îÇ - –ò—Å–ø–æ–ª—å–∑—É—é—Ç concrete_m3 = 255          ‚îÇ
‚îÇ - –í—Å–µ —Ä–∞—Å—á–µ—Ç—ã (Kƒç/m¬≥, KROS) –ø—Ä–∞–≤–∏–ª—å–Ω—ã!‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

#### –ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –∏ –∏—Ö —Ñ—É–Ω–∫—Ü–∏–∏

**1. `frontend/src/components/PartHeader.tsx`** (–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ)
- ‚úÖ Input –¥–ª—è –Ω–∞–∑–≤–∞–Ω–∏—è —á–∞—Å—Ç–∏ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ ("N√°zev ƒç√°sti")
- ‚úÖ Input –¥–ª—è –æ–±—ä—ë–º–∞ –±–µ—Ç–æ–Ω–∞ ("Objem betonu celkem") ‚Äî **–ì–õ–ê–í–ù–û–ï –ü–û–õ–ï**
- ‚úÖ Callbacks: `onItemNameUpdate()`, `onBetonQuantityUpdate()`
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ ü™® –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
- ‚úÖ –ü–æ–ª–µ —Å `min="0"`, `step="0.01"`

**2. `frontend/src/components/PositionsTable.tsx`** (–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è)
- ‚úÖ Function: `handleBetonQuantityUpdate(partName, newQuantity)`
- ‚úÖ –ù–∞—Ö–æ–¥–∏—Ç beton position –≤ —á–∞—Å—Ç–∏
- ‚úÖ –í—ã–∑—ã–≤–∞–µ—Ç `updatePositions()` –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ üìä –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

**3. `frontend/src/components/PositionRow.tsx`** (–∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞ + –≤–∞–ª–∏–¥–∞—Ü–∏—è)
```typescript
// –î–ª—è beton row:
disabled={isLocked || position.subtype === 'beton'}  // –ó–ê–ë–õ–û–ö–ò–†–û–í–ê–ù–ê
className={`input-cell ${position.subtype === 'beton' ? 'readonly-style' : ''}`}

// –î–ª—è –≤—Å–µ—Ö —á–∏—Å–ª–æ–≤—ã—Ö fields:
min="0"
onChange={(e) => handleFieldChange(field, Math.max(0, parseFloat(e.target.value) || 0))}
```

**4. `frontend/src/hooks/usePositions.ts`** (—Ä–∞—Å—à–∏—Ä–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ)
- ‚úÖ –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ mutationFn
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ onSuccess (–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞)
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ onError
- ‚úÖ Cache invalidation —Å –ª–æ–≥–∞–º–∏

**5. `frontend/src/services/api.ts`** (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
- ‚úÖ –í—Å–µ endpoints —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ PUT /api/positions –º–æ–∂–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å partial updates

**6. `backend/src/routes/positions.js`** (–ö–†–ò–¢–ò–ß–ï–°–ö–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï v4.3.3)
```javascript
// ‚ùå –ë–´–õ–û (v4.3.2 - –≤—ã–∑—ã–≤–∞–ª–æ 500 –æ—à–∏–±–∫—É):
const fieldNames = Object.keys(updates[0]);  // ‚Üê –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–π update!
const fieldPlaceholders = fieldNames.map(f => `${f} = ?`).join(', ');
const sql = `UPDATE positions SET ${fieldPlaceholders} WHERE id = ? AND bridge_id = ?`;
// ‚úó –ï—Å–ª–∏ updates[2] –∏–º–µ–µ—Ç –¥—Ä—É–≥–∏–µ –ø–æ–ª—è ‚Üí –æ—à–∏–±–∫–∞ SQL!

// ‚úÖ –°–¢–ê–õ–û (v4.3.3 - –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ):
for (const update of updates) {
  const { id, ...fields } = update;

  // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º SQL –¥–ª—è –ö–ê–ñ–î–û–ì–û update –æ—Ç–¥–µ–ª—å–Ω–æ!
  const fieldNames = Object.keys(fields);
  const fieldPlaceholders = fieldNames.map(f => `${f} = ?`).join(', ');
  const sql = `UPDATE positions SET ${fieldPlaceholders} WHERE id = ? AND bridge_id = ?`;

  const values = [...Object.values(fields), id, bridge_id];
  db.prepare(sql).run(...values);  // ‚úì –†–∞–±–æ—Ç–∞–µ—Ç!
}
```

### –ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö (–ø—Ä–∏–º–µ—Ä)

**–°—Ü–µ–Ω–∞—Ä–∏–π: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–µ–Ω—è–µ—Ç –æ–±—ä—ë–º –±–µ—Ç–æ–Ω–∞**

```
1Ô∏è‚É£  User –≤ PartHeader –≤–≤–æ–¥–∏—Ç: "255" (–≤ –ø–æ–ª–µ "Objem betonu celkem")
    –ù–∞–∂–∏–º–∞–µ—Ç Tab/—â–µ–ª–∫–∞–µ—Ç –≤–Ω–µ –ø–æ–ª—è

2Ô∏è‚É£  PartHeader.handleBetonBlur() —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç
    –õ–æ–≥–∏: ü™® PartHeader.handleBetonBlur: value="255", parsed=255, current=255
    –í—ã–∑—ã–≤–∞–µ—Ç: onBetonQuantityUpdate(255)

3Ô∏è‚É£  PositionsTable.handleBetonQuantityUpdate() –ø–æ–ª—É—á–∞–µ—Ç –≤—ã–∑–æ–≤
    –õ–æ–≥–∏: üìä handleBetonQuantityUpdate called: part="Z√ÅKLADY", qty=255
    –ù–∞—Ö–æ–¥–∏—Ç beton position: id=abc123
    –õ–æ–≥–∏: ‚úÖ Found beton position: id=abc123, current qty=43.8, new qty=255

4Ô∏è‚É£  –í—ã–∑—ã–≤–∞–µ—Ç updatePositions([{id: abc123, qty: 255}])
    –õ–æ–≥–∏: üì§ Calling updatePositions with: [{id: abc123, qty: 255}]

5Ô∏è‚É£  usePositions.updateMutation —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç
    –õ–æ–≥–∏: üîÑ updateMutation: sending 1 updates to backend
    –õ–æ–≥–∏: Updates: [{"id":"abc123","qty":255}]

6Ô∏è‚É£  Frontend –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç: PUT /api/positions
    Body: {bridge_id: "SO201", updates: [{id: "abc123", qty: 255}]}

7Ô∏è‚É£  Backend –ø–æ–ª—É—á–∞–µ—Ç –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç
    –õ–æ–≥–∏: üìù PUT /api/positions: bridge_id=SO201, 1 updates
    –õ–æ–≥–∏: Updating position id=abc123: qty

    –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç: UPDATE positions SET qty = ? WHERE id = ? AND bridge_id = ?
    –í—ã–ø–æ–ª–Ω—è–µ—Ç —Å values: [255, "abc123", "SO201"]

8Ô∏è‚É£  Backend –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç –í–°–ï –ø–æ–ª—è:
    - concrete_m3 = 255 (–¥–ª—è beton)
    - unit_cost_on_m3 = cost_czk / 255 (–¥–ª—è –≤—Å–µ—Ö subtypes —á–∞—Å—Ç–∏)
    - kros_unit_czk, kros_total_czk, etc.

9Ô∏è‚É£  –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç response
    –õ–æ–≥–∏: ‚úÖ updateMutation: response received {positions: [...], header_kpi: {...}}

üîü  React Query invalidates cache
    –õ–æ–≥–∏: ‚úÖ updateMutation.onSuccess: invalidated query cache

1Ô∏è‚É£1Ô∏è‚É£ Query re-fetches data (GET /api/positions?bridge_id=SO201)

1Ô∏è‚É£2Ô∏è‚É£ usePositions context updated
    setPositions(newPositions)
    setHeaderKPI(newHeaderKPI)

1Ô∏è‚É£3Ô∏è‚É£ PositionsTable –∏ PartHeader re-render
    PartHeader: betonQuantity = 255 (–≤—ã—á–∏—Å–ª–µ–Ω–æ –∏–∑ beton row)
    Table: beton row qty = 255 ‚úì
    –í—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–æ–ª—è –ø–µ—Ä–µ—Å—á–∏—Ç–∞–Ω—ã —Å –Ω–æ–≤—ã–º concrete_m3!

1Ô∏è‚É£4Ô∏è‚É£ KPI –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è
    sum_concrete_m3 = 255
    project_unit_cost_czk_per_m3 = sum_kros_total_czk / 255
    estimated_months/weeks –ø–µ—Ä–µ—Å—á–∏—Ç–∞–Ω—ã!
```

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (–ø—Ä–æ–≤–µ—Ä–µ–Ω —Ä–∞–±–æ—Ç–∞–µ—Ç)

‚úÖ **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ –≤ –±—Ä–∞—É–∑–µ—Ä–µ (F12 Console):**

1. –í–≤–æ–¥ –æ–±—ä—ë–º–∞ –≤ PartHeader "Objem betonu celkem"
   - –õ–æ–≥–∏ ü™® –ø–æ—è–≤–ª—è—é—Ç—Å—è
   - –ó–Ω–∞—á–µ–Ω–∏–µ –ø–µ—Ä–µ–Ω–æ—Å–∏—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü—É beton row
   - –í—Å–µ —Ä–∞—Å—á—ë—Ç—ã –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è

2. –ü–æ–ø—ã—Ç–∫–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å beton row –≤ —Ç–∞–±–ª–∏—Ü–µ
   - –ü–æ–ª–µ disabled (—Å–µ—Ä–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞)
   - Tooltip: "Objem betonu (ƒçte se z PartHeader v√Ω≈°e)"
   - Edit –Ω–µ–≤–æ–∑–º–æ–∂–µ–Ω

3. –ü–æ–ø—ã—Ç–∫–∞ –≤–≤–µ—Å—Ç–∏ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤ –ª—é–±–æ–µ —á–∏—Å–ª–æ–≤–æ–µ –ø–æ–ª–µ
   - HTML min="0" –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç
   - JavaScript Math.max() –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç

4. Backend PUT –æ–±—Ä–∞–±–æ—Ç—á–∏–∫
   - –ë–æ–ª—å—à–µ –Ω–µ—Ç 500 –æ—à–∏–±–æ–∫
   - –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π SQL —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
   - –í—Å–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è —É—Å–ø–µ—à–Ω–æ

### Commits –≤ —ç—Ç–æ–π —Å–µ—Å—Å–∏–∏

- ‚úÖ `f92a03d` - üîß Fix: Prevent negative values + fix backend update logic + add logging
- ‚úÖ `fc43f9f` - üîß Debug: Add logging + lock beton row as READ-ONLY
- ‚úÖ `a89ec0b` - üìù v4.3.2: Document correct concrete volume architecture
- ‚úÖ `6ade33e` - ‚ú® v4.3.2: Restore concrete volume input in PartHeader with bidirectional sync
- ‚úÖ `ad1befb` - üìù Update CLAUDE.MD: Document v4.3.1 concrete volume architecture fix

---

## üöÄ –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò

### –ë–ª–∏–∂–∞–π—à–∏–µ –∑–∞–¥–∞—á–∏ (–ì–æ—Ç–æ–≤–æ –∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é)

#### 1. ‚úÖ **–û—Ç–ø—Ä–∞–≤–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π –Ω–∞ GitHub**
```bash
git push origin claude/finalize-documentation-011CUv1xKwDSHYhEg5M8d5uA
```

#### 2. üß™ **–ö–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (–≤—Ä—É—á–Ω—É—é)**

**–¢–µ—Å—Ç 1: –í–≤–æ–¥ –æ–±—ä—ë–º–∞ –±–µ—Ç–æ–Ω–∞**
- [ ] –û—Ç–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
- [ ] –í—ã–±—Ä–∞—Ç—å –º–æ—Å—Ç
- [ ] –ù–∞–π—Ç–∏ —á–∞—Å—Ç—å –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, Z√ÅKLADY)
- [ ] –í PartHeader –≤–≤–µ—Å—Ç–∏ "100" –≤ –ø–æ–ª–µ "Objem betonu celkem"
- [ ] –ù–∞–∂–∞—Ç—å Tab
- [ ] **–û–∂–∏–¥–∞–µ–º–æ**: –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü–µ beton row, –≤—Å–µ —Ñ–æ—Ä–º—É–ª—ã –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è
- [ ] **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ F12**: –õ–æ–≥–∏ ü™®, üìä, üîÑ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤–∏–¥–Ω—ã

**–¢–µ—Å—Ç 2: –ü–æ–ø—ã—Ç–∫–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è beton row**
- [ ] –ö–ª–∏–∫–Ω—É—Ç—å –Ω–∞ –ø–æ–ª–µ "Mno≈æstv√≠" –≤ beton —Å—Ç—Ä–æ–∫–µ
- [ ] **–û–∂–∏–¥–∞–µ–º–æ**: –ü–æ–ª–µ –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ–µ (—Å–µ—Ä—ã–π —Ü–≤–µ—Ç, cursor: not-allowed)
- [ ] **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å**: Tooltip –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç "Objem betonu (ƒçte se z PartHeader)"

**–¢–µ—Å—Ç 3: –í–∞–ª–∏–¥–∞—Ü–∏—è –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π**
- [ ] –í –ø–æ–ª–µ "Crew size" –ø–æ–ø—ã—Ç–∞—Ç—å—Å—è –≤–≤–µ—Å—Ç–∏ "-5"
- [ ] **–û–∂–∏–¥–∞–µ–º–æ**: HTML min="0" –±–ª–æ–∫–∏—Ä—É–µ—Ç –æ—Ç–ø—Ä–∞–≤–∫—É
- [ ] –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –≤ –¥—Ä—É–≥–∏—Ö –ø–æ–ª—è—Ö (qty, wage, shift_hours, days)
- [ ] **–í—Å–µ –¥–æ–ª–∂–Ω—ã –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è**

**–¢–µ—Å—Ç 4: Backend PUT –æ–±—Ä–∞–±–æ—Ç—á–∏–∫**
- [ ] –í F12 Network tab –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –ø–æ–∑–∏—Ü–∏–π
- [ ] **–û–∂–∏–¥–∞–µ–º–æ**: –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç 200 OK (–±–µ–∑ 500 –æ—à–∏–±–æ–∫)
- [ ] **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å**: Backend console –ª–æ–≥–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π SQL

**–¢–µ—Å—Ç 5: –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –≤ –æ–±–µ —Å—Ç–æ—Ä–æ–Ω—ã**
- [ ] –ò–∑–º–µ–Ω–∏—Ç—å qty –≤ —Ç–∞–±–ª–∏—Ü–µ beton row (—á–µ—Ä–µ–∑ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥—Ä—É–≥–æ–π —á–∞—Å—Ç–∏)
- [ ] **–û–∂–∏–¥–∞–µ–º–æ**: PartHeader "Objem betonu celkem" –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è
- [ ] –ò–∑–º–µ–Ω–∏—Ç—å –≤ PartHeader **–û–±–≤–µ–º betonu celkem"
- [ ] **–û–∂–∏–¥–∞–µ–º–æ**: Table beton row –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è

#### 3. üìä **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ä–º—É–ª**

- [ ] –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ `concrete_m3 = qty` –¥–ª—è beton positions
- [ ] –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ `unit_cost_on_m3 = cost_czk / concrete_m3` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
- [ ] –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ KROS-–æ–∫—Ä—É–≥–ª–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç: `ceil(unit_cost_on_m3 / 50) * 50`
- [ ] –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –º–µ—Å—è—Ü—ã/–Ω–µ–¥–µ–ª–∏ –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è —Å –Ω–æ–≤—ã–º concrete_m3

#### 4. üöÄ **Deployment –Ω–∞ Render (–∫–æ–≥–¥–∞ –≥–æ—Ç–æ–≤–æ)**

```bash
# –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –≤—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—à–ª–∏
git push origin claude/finalize-documentation-011CUv1xKwDSHYhEg5M8d5uA

# –í Render Dashboard:
# - Blueprint ‚Üí alpro1000/Monolit-Planner
# - Auto-deploy –Ω–∞—á–Ω—ë—Ç—Å—è –ø—Ä–∏ push –≤ main
```

### –°—Ä–µ–¥–Ω–µ—Å—Ä–æ—á–Ω—ã–µ –∑–∞–¥–∞—á–∏ (TODO)

#### üìù **–£–ª—É—á—à–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏**
- [ ] –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ README.md
- [ ] –°–æ–∑–¥–∞—Ç—å user guide –Ω–∞ —á–µ—à—Å–∫–æ–º —è–∑—ã–∫–µ
- [ ] –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å API endpoints
- [ ] –î–æ–±–∞–≤–∏—Ç—å –≤–∏–¥–µ–æ—É—Ä–æ–∫–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

#### üé® **UX/UI —É–ª—É—á—à–µ–Ω–∏—è**
- [ ] –£–±—Ä–∞—Ç—å –∏–ª–∏ —Å–∫—Ä—ã—Ç—å console.log() –ª–æ–≥–∏ –¥–ª—è production
- [ ] –î–æ–±–∞–≤–∏—Ç—å toast-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø—Ä–∏ —É—Å–ø–µ—à–Ω–æ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏
- [ ] –î–æ–±–∞–≤–∏—Ç—å spinner-–∞–Ω–∏–º–∞—Ü–∏—é –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
- [ ] –£–ª—É—á—à–∏—Ç—å error handling (–ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –æ—à–∏–±–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é)

#### üß™ **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**
- [ ] –ù–∞–ø–∏—Å–∞—Ç—å unit-—Ç–µ—Å—Ç—ã –¥–ª—è formulas.ts
- [ ] –ù–∞–ø–∏—Å–∞—Ç—å e2e-—Ç–µ—Å—Ç—ã –¥–ª—è —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ (Cypress/Playwright)
- [ ] –î–æ–±–∞–≤–∏—Ç—å GitHub Actions CI/CD

#### üìà **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è (ROADMAP)**
- [ ] Excel import —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –ø–∞—Ä—Å–∏–Ω–≥–æ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
- [ ] Snapshots —Å –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ–º (—É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ, –Ω—É–∂–Ω–æ UI)
- [ ] RFI —Å–∏—Å—Ç–µ–º–∞ —Å notifications
- [ ] –≠–∫—Å–ø–æ—Ä—Ç –≤ KROS4 XML
- [ ] Multi-bridge aggregation (—Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –º–æ—Å—Ç–æ–≤)
- [ ] AI-–ø–æ–¥—Å–∫–∞–∑–∫–∏ –¥–ª—è –¥–Ω–µ–π (ML-–º–æ–¥–µ–ª—å)

#### üîê **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ production**
- [ ] CORS_ORIGIN –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –¥–æ–º–µ–Ω (–Ω–µ "*")
- [ ] Authentication/Authorization —Å–∏—Å—Ç–µ–º–∞
- [ ] Rate limiting –Ω–∞ API
- [ ] SQL injection protection (—É–∂–µ –µ—Å—Ç—å —á–µ—Ä–µ–∑ prepared statements)
- [ ] HTTPS everywhere
- [ ] Database backup strategy

### –ó–Ω–∞–∫–æ–º—Å—Ç–≤–æ —Å –∫–æ–¥–æ–º (–¥–ª—è –Ω–æ–≤—ã—Ö —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤)

1. **–ü—Ä–æ—á–∏—Ç–∞–π CLAUDE.MD** (—ç—Ç–æ—Ç —Ñ–∞–π–ª) ‚Äî –∏—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã
2. **–ò–∑—É—á–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø—Ä–æ–µ–∫—Ç–∞**: `ls -la` –≤ –∫–∞–∂–¥–æ–π –ø–∞–ø–∫–µ
3. **–ó–∞–ø—É—Å—Ç–∏ –ª–æ–∫–∞–ª—å–Ω–æ**: `npm run dev` –≤ backend –∏ frontend
4. **–û—Ç–∫—Ä–æ–π—Ç–µ F12 Console** –∏ –ø–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö
5. **–ü—Ä–æ—á–∏—Ç–∞–π—Ç–µ commitis**: `git log --oneline` (–∏—Å—Ç–æ—Ä–∏—è —Ä–µ—à–µ–Ω–∏–π)
6. **–ü—Ä–æ—á–∏—Ç–∞–π—Ç–µ formulas.ts**: –≥–¥–µ –≤—Å–µ —Ä–∞—Å—á—ë—Ç—ã –ø—Ä–æ–∏—Å—Ö–æ–¥—è—Ç

### –°–±–æ–π –∏ recovery

**–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ —Å–ª–æ–º–∞–ª–æ—Å—å –ø–æ—Å–ª–µ pull:**
```bash
# 1. –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å shared –ø–∞–∫–µ—Ç
cd shared && npm install && npm run build && cd ..

# 2. –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
cd backend && rm -rf node_modules && npm install && cd ..
cd frontend && rm -rf node_modules && npm install && cd ..

# 3. –ó–∞–ø—É—Å—Ç–∏—Ç—å –∑–∞–Ω–æ–≤–æ
cd backend && npm run dev
# –í –Ω–æ–≤–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ:
cd frontend && npm run dev
```

**–ï—Å–ª–∏ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∞:**
```bash
# –£–¥–∞–ª–∏—Ç—å –∏ –ø–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å
rm backend/data/monolit.db

# –ó–∞–ø—É—Å—Ç–∏—Ç—å backend (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—Å—Ç –ë–î)
cd backend && npm run dev
```

---

## üîê –í–ï–†–°–ò–û–ù–ò–†–û–í–ê–ù–ò–ï

**–¢–µ–∫—É—â–∞—è –≤–µ—Ä—Å–∏—è:** v4.3.8 (2025-11-08)

**–ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π:**

- **v4.3.8** (2025-11-08) - **KPI Single Row Layout + Add Row Functionality** ‚ú®
  - ‚úÖ **KPI –≤ –æ–¥–Ω—É —Å—Ç—Ä–æ–∫—É** (8 –∫–æ–ª–æ–Ω–æ–∫ –≤–º–µ—Å—Ç–æ 4x2 —Å–µ—Ç–∫–∏):
    - Grid: `repeat(4, 1fr)` ‚Üí `repeat(8, 1fr)` (–≤—Å–µ 8 –º–µ—Ç—Ä–∏–∫ –≤ –æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–µ)
    - Gap: 8px ‚Üí 6px (–ø–ª–æ—Ç–Ω–µ–µ)
    - Padding: 4px 6px ‚Üí 6px 8px (–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ –¥–ª—è –æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏)
    - Min-height: 48px ‚Üí 50px (–≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–µ —Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ)
    - Label font: 9px ‚Üí 10px ‚úì
    - Value font: 14px ‚Üí **15px** ‚úì (–ª—É—á—à–µ —á–∏—Ç–∞–µ—Ç—Å—è!)
    - Unit font: 9px ‚Üí 10px ‚úì
    - **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –í—Å–µ KPI –≤ –æ–¥–Ω–æ–π –∫–æ–º–ø–∞–∫—Ç–Ω–æ–π —Å—Ç—Ä–æ–∫–µ, –±–æ–ª—å—à–∏–π —à—Ä–∏—Ñ—Ç!
  - ‚úÖ **–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Å—Ç—Ä–æ–∫–∏** (—É–±—Ä–∞–Ω–∞ TODO alert):
    - `handleAddRow(partName)` —Å–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—É—é –ø–æ–∑–∏—Ü–∏—é —Å default –∑–Ω–∞—á–µ–Ω–∏—è–º–∏
    - Subtype: 'jin√©' (–ü—Ä–æ—á–µ–µ)
    - Unit: 'ks' (—à—Ç—É–∫)
    - Default –ø–∞—Ä–∞–º–µ—Ç—Ä—ã: crew_size=4, wage_czk_ph=398, shift_hours=10, days=0
    - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–∞ backend, –æ–±–Ω–æ–≤–ª—è–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç –∏ KPI
    - Console logs –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ (‚ûï, ‚úÖ, ‚ùå)
    - Error handling —Å alert –ø—Ä–∏ –æ—à–∏–±–∫–µ
  - **Files modified**: `frontend/src/styles/components.css`, `frontend/src/components/PositionsTable.tsx`
  - **Impact**: ‚úÖ KPI –∫—Ä–∞—Å–∏–≤–æ –≤ –æ–¥–Ω—É —Å—Ç—Ä–æ–∫—É, –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å —Å—Ç—Ä–æ–∫–∏ –Ω–∞–∂–∞–≤ –∫–Ω–æ–ø–∫—É!

- **v4.3.7** (2025-11-08) - **UX Improvements: RFI Warning + Optimize KPI Width** ‚ú®
  - ‚úÖ **–î–æ–±–∞–≤–ª–µ–Ω–æ RFI Warning** –∫–æ–≥–¥–∞ –Ω–µ –≤–≤–µ–¥–µ–Ω –æ–±—ä—ë–º –±–µ—Ç–æ–Ω–∞ (concrete_m3 = 0)
    - –î–ª—è beton –ø–æ–∑–∏—Ü–∏–π: –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç `‚ö†Ô∏è Chyb√≠ objem betonu! Zadejte "Objem betonu celkem" v PartHeader v√Ω≈°e.`
    - –î–ª—è –¥—Ä—É–≥–∏—Ö —Ç–∏–ø–æ–≤ —Ä–∞–±–æ—Ç: –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —á—Ç–æ –Ω—É–∂–Ω–æ –≤–≤–µ—Å—Ç–∏ –æ–±—ä—ë–º –±–µ—Ç–æ–Ω–∞
    - –ü–æ–º–æ–≥–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –ø–æ–Ω—è—Ç—å, –ø–æ—á–µ–º—É —Å–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å = 0 (–Ω–µ –º–æ–∂–µ—Ç –¥–µ–ª–∏—Ç—å –Ω–∞ 0!)
    - –°—Ç—Ä–æ–∫–∞ —Å RFI –≤—ã–¥–µ–ª—è–µ—Ç—Å—è –∫—Ä–∞—Å–Ω—ã–º —Å ‚ö†Ô∏è –∑–Ω–∞—á–∫–æ–º
  - ‚úÖ **–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ —à–∏—Ä–∏–Ω–∞ KPI panel** (–±–æ–ª–µ–µ –∫–æ–º–ø–∞–∫—Ç–Ω–∞—è):
    - Padding: 8px 10px ‚Üí 4px 6px (—Å–æ—Ö—Ä–∞–Ω—è–µ—Ç 8px –Ω–∞ –∫–∞–∂–¥—É—é –∫–∞—Ä—Ç—É)
    - Label font: 10px ‚Üí 9px
    - Value font: 16px ‚Üí 14px
    - Unit font: 11px ‚Üí 9px
    - Gap –º–µ–∂–¥—É –∫–∞—Ä—Ç–∞–º–∏: 10px ‚Üí 8px
    - Min-height: 60px ‚Üí 48px
    - **–†–µ–∑—É–ª—å—Ç–∞—Ç:** KPI footer –∑–∞–Ω–∏–º–∞–µ—Ç ~30% –º–µ–Ω—å—à–µ –º–µ—Å—Ç–∞!
  - **Files modified**: `shared/src/formulas.ts`, `frontend/src/styles/components.css`
  - **Impact**: ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ missing concrete volume, KPI –ø–∞–Ω–µ–ª—å –±–æ–ª–µ–µ –∫–æ–º–ø–∞–∫—Ç–Ω–∞

- **v4.3.6** (2025-11-08) - **CRITICAL FIX: Only send editable fields to backend** üîßüîßüîß
  - ‚úÖ **–ù–ê–ô–î–ï–ù–ê –ò –ò–°–ü–†–ê–í–õ–ï–ù–ê –ù–ê–°–¢–û–Ø–©–ê–Ø –ü–†–û–ë–õ–ï–ú–ê**: PositionsTable –æ—Ç–ø—Ä–∞–≤–ª—è–ª–∞ –í–°–ï –ø–æ–ª—è (–≤–∫–ª—é—á–∞—è –≤—ã—á–∏—Å–ª–µ–Ω–Ω—ã–µ) –Ω–∞ backend!
  - **–ü—Ä–æ–±–ª–µ–º–∞**: `handleBetonQuantityUpdate()` –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞ `...betonPosition` —á—Ç–æ –∫–æ–ø–∏—Ä–æ–≤–∞–ª–æ –≤—Å–µ –ø–æ–ª—è:
    ```typescript
    // ‚ùå –ë–´–õ–û (v4.3.5):
    const updates = [{
      ...betonPosition,      // –ö–æ–ø–∏—Ä—É–µ—Ç –í–°–ï!
      qty: newQuantity       // labor_hours, cost_czk, unit_cost_on_m3, kros_total_czk...
    }];
    // –≠—Ç–æ –≤—ã–∑—ã–≤–∞–µ—Ç SQL –æ—à–∏–±–∫—É ‚Üí 500!
    ```
  - **–†–µ—à–µ–Ω–∏–µ**: –û—Ç–ø—Ä–∞–≤–ª—è—Ç—å –¢–û–õ–¨–ö–û —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º—ã–µ –ø–æ–ª—è:
    ```typescript
    // ‚úÖ –°–¢–ê–õ–û (v4.3.6):
    const updates = [{
      id: betonPosition.id,
      qty: newQuantity
      // –¢–û–õ–¨–ö–û —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º—ã–µ! backend —Å–∞–º –ø–µ—Ä–µ—Å—á–∏—Ç–∞–µ—Ç labor_hours, cost_czk –∏ —Ç.–¥.
    }];
    ```
  - **–ü–æ—á–µ–º—É 500 –æ—à–∏–±–∫–∞?** Backend –ø—ã—Ç–∞–ª—Å—è –∑–∞–ø—É—Å—Ç–∏—Ç—å –Ω–µ–≤–µ—Ä–Ω—ã–π SQL:
    ```sql
    UPDATE positions SET qty=?, labor_hours=?, cost_czk=?, unit_cost_on_m3=?, ... id=?, bridge_id=?
    -- –ö–æ–ª–æ–Ω–∫–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç! –û—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –≤—ã—á–∏—Å–ª–µ–Ω–Ω—ã–µ –ø–æ–ª—è –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ UPDATE
    ```
  - **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ**:
    ```
    1. PartHeader: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç "Objem betonu celkem" ‚úì
    2. PartHeader.handleBetonBlur() ‚Üí onBetonQuantityUpdate(value) ‚úì
    3. PositionsTable.handleBetonQuantityUpdate() ‚Üí –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –¢–û–õ–¨–ö–û {id, qty} ‚úì
    4. Backend: UPDATE positions SET qty=?, updated_at=CURRENT_TIMESTAMP ‚úì
    5. Backend: calculatePositionFields() –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç –í–°–ï derived fields ‚úì
    6. Response: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–æ–ª–Ω—ã–µ —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–Ω—ã–µ –ø–æ–∑–∏—Ü–∏–∏ ‚úì
    7. Frontend: React Query –æ–±–Ω–æ–≤–ª—è–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç ‚úì
    8. PartHeader useEffect: –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç editedBeton = newValue ‚úì
    9. Table: –ü–µ—Ä–µ–¥–∏-—Ä–µ–Ω–¥–µ—Ä–∏—Ç—Å—è —Å –Ω–æ–≤—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º ‚úì
    ```
  - **Files modified**: `frontend/src/components/PositionsTable.tsx` (handleBetonQuantityUpdate + handleItemNameUpdate)
  - **Impact**: ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è! –ó–Ω–∞—á–µ–Ω–∏–µ —Ç–µ–ø–µ—Ä—å –ø–µ—Ä–µ–Ω–æ—Å–∏—Ç—Å—è –∏–∑ PartHeader –≤ —Ç–∞–±–ª–∏—Ü—É –ø—Ä–∞–≤–∏–ª—å–Ω–æ!

- **v4.3.5** (2025-11-08) - **UX & Robustness: Rename 'beton' to 'Betonov√°n√≠'** ‚ú®
  - ‚úÖ **–£–ª—É—á—à–µ–Ω–∏–µ UX**: –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–æ "beton" ‚Üí "Betonov√°n√≠" (–ë–µ—Ç–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ) –¥–ª—è –±–æ–ª–µ–µ –ø–æ–Ω—è—Ç–Ω–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
  - ‚úÖ **–î–æ–±–∞–≤–ª–µ–Ω–æ SUBTYPE_LABELS**: –ú–∞–ø–ø–∏–Ω–≥ –¥–ª—è –ø–æ–∫–∞–∑—ã–≤–∞–µ–º—ã—Ö –Ω–∞–∑–≤–∞–Ω–∏–π –ø–æ–¥—Ç–∏–ø–æ–≤ —Ä–∞–±–æ—Ç (—á–µ—à—Å–∫–∏–π —è–∑—ã–∫)
  - ‚úÖ **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è 500 –æ—à–∏–±–∫–∞**: Edge case –∫–æ–≥–¥–∞ –Ω–µ—Ç –ø–æ–ª–µ–π –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è ‚Üí –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø—É—Å—Ç–æ–π fieldNames
  - **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞**:
    ```
    ‚úì "Objem betonu celkem" INPUT –ø–æ–ª–µ –≤ PartHeader (–≤–≤–æ–¥–∏—Ç—Å—è –≤—Ä—É—á–Ω—É—é, –ø–æ—Ç–æ–º –º–æ–∂–µ—Ç –±—ã—Ç—å –∏–∑ XLSX)
    ‚úì Beton row –≤ —Ç–∞–±–ª–∏—Ü–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –∫–∞–∫ READ-ONLY (–ø–æ–º–µ—á–µ–Ω–æ –∫–∞–∫ "Betonov√°n√≠")
    ‚úì –û–¥–Ω–æ—Å—Ç–æ—Ä–æ–Ω–Ω—è—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è: PartHeader ‚Üí Table (–ø—Ä–æ–≤–µ—Ä–µ–Ω–æ –≤ v4.3.4)
    ‚úì –í—Å–µ —Ä–∞—Å—á—ë—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç —ç—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ concrete_m3
    ```
  - **Files modified**: `shared/src/constants.ts`, `frontend/src/components/PositionRow.tsx`, `backend/src/routes/positions.js`
  - **Impact**: –£–ª—É—á—à–µ–Ω–∞ UX (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç "Betonov√°n√≠" –≤–º–µ—Å—Ç–æ "beton"), –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è SQL –æ—à–∏–±–∫–∞

- **v4.3.4** (2025-11-08) - **FIX: PartHeader state synchronization** üîß
  - ‚úÖ **–†–ï–®–ï–ù–ê**: PartHeader –Ω–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–ª–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–µ `editedBeton` –∫–æ–≥–¥–∞ `betonQuantity` –º–µ–Ω—è–ª–æ—Å—å –∏–∑–≤–Ω–µ
  - **–ü—Ä–æ–±–ª–µ–º–∞**: `editedBeton` –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–ª—Å—è –æ–¥–∏–Ω —Ä–∞–∑ —á–µ—Ä–µ–∑ `useState`, –Ω–æ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –æ–±–Ω–æ–≤–ª—è–ª—Å—è –∫–æ–≥–¥–∞ –∑–Ω–∞—á–µ–Ω–∏–µ –ø—Ä–∏—Ö–æ–¥–∏–ª–æ —á–µ—Ä–µ–∑ props
  - **–†–µ—à–µ–Ω–∏–µ**: –î–æ–±–∞–≤–ª–µ–Ω—ã `useEffect` –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏:
    ```typescript
    useEffect(() => {
      setEditedName(itemName || '');
    }, [itemName]);

    useEffect(() => {
      setEditedBeton(betonQuantity.toString());
    }, [betonQuantity]);
    ```
  - **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –î–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω—è—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ - –∏–∑–º–µ–Ω–µ–Ω–∏–µ –≤ —Ç–∞–±–ª–∏—Ü–µ ‚Üí –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤ PartHeader ‚úì
  - **Files modified**: `frontend/src/components/PartHeader.tsx`
  - **Impact**: –†–µ—à–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—É —Å —Ä–∞—Å—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–µ–π –∑–Ω–∞—á–µ–Ω–∏–π "Podtyp beton" ‚Üî "Objem betonu celkem"

- **v4.3.3** (2025-11-08) - **Session Complete: All Issues Fixed + Documentation** ‚úÖ‚úÖ‚úÖ
  - ‚úÖ **–†–ï–®–ï–ù–ê**: Backend 500 –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –ø–æ–∑–∏—Ü–∏–π
    - –ü—Ä–æ–±–ª–µ–º–∞: SQL statement —Å—Ç—Ä–æ–∏–ª—Å—è –æ–¥–∏–Ω —Ä–∞–∑ –¥–ª—è updates[0], –Ω–æ –∫–∞–∂–¥—ã–π update –∏–º–µ–µ—Ç —Ä–∞–∑–Ω—ã–µ –ø–æ–ª—è
    - –†–µ—à–µ–Ω–∏–µ: –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è SQL –¥–ª—è –∫–∞–∂–¥–æ–≥–æ update –æ—Ç–¥–µ–ª—å–Ω–æ
  - ‚úÖ **–†–ï–®–ï–ù–ê**: –û–±—ä—ë–º –±–µ—Ç–æ–Ω–∞ –Ω–µ –ø–µ—Ä–µ–Ω–æ—Å–∏–ª—Å—è –∏–∑ PartHeader –≤ —Ç–∞–±–ª–∏—Ü—É
    - –ü—Ä–æ–±–ª–µ–º–∞: –ù–µ—è—Å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞, –≥–¥–µ –≤–≤–æ–¥–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ
    - –†–µ—à–µ–Ω–∏–µ: –ü—Ä–æ—Å—Ç–∞—è –æ–¥–Ω–æ—Å—Ç–æ—Ä–æ–Ω—è—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ - INPUT –≤ PartHeader, READ-ONLY –≤ —Ç–∞–±–ª–∏—Ü–µ
  - ‚úÖ **–†–ï–®–ï–ù–ê**: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥–ª–∏ –≤–≤–æ–¥–∏—Ç—å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
    - –ü—Ä–æ–±–ª–µ–º–∞: –û—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ —á–∏—Å–ª–∞
    - –†–µ—à–µ–Ω–∏–µ: –î–æ–±–∞–≤–ª–µ–Ω min="0" HTML + Math.max() JavaScript –≤–∞–ª–∏–¥–∞—Ü–∏—è
  - üìù **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: –î–æ–±–∞–≤–ª–µ–Ω—ã —Ä–∞–∑–¥–µ–ª—ã –£—Å—Ç–∞–Ω–æ–≤–∫–∞, –†–µ–∑—é–º–µ —Å–µ—Å—Å–∏–∏, –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏
  - üìã **–î–µ—Ç–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: –ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö, –ø—Ä–∏–º–µ—Ä—ã —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤, —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, troubleshooting
  - **Files modified**: PartHeader.tsx, PositionsTable.tsx, PositionRow.tsx, usePositions.ts, positions.js, CLAUDE.MD
  - **Result**: Production-ready, –ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–æ, –≥–æ—Ç–æ–≤–æ –∫ deployment

- **v4.3.2** (2025-11-08) - **FINAL: Correct Concrete Volume Architecture** ‚≠ê‚≠ê‚≠ê DEFINITIVE FIX
  - ‚ú® **–†–ï–®–ï–ù–ò–ï**: –ü–æ–ª–µ –¥–ª—è –≤–≤–æ–¥–∞ –æ–±—ä–µ–º–∞ –±–µ—Ç–æ–Ω–∞ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –ì–î–ï –ù–ê–î–û - –≤ PartHeader, –†–Ø–î–û–ú —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º!
  - üéØ **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ v4.3.2 (–ü–†–ê–í–ò–õ–¨–ù–ê–Ø)**:
    ```
    PartHeader:
      - "N√°zev ƒç√°sti konstrukce": [—Ç–µ–∫—Å—Ç] ‚Üê –ù–∞–∑–≤–∞–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–∞
      - "Objem betonu celkem": [255] m¬≥ ‚Üê üü† –ì–õ–ê–í–ù–û–ï –ü–û–õ–ï! EDITABLE!
           ‚Üì –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è ‚Üì
    Table beton row:
      - "Mno≈æstv√≠": 255 m¬≥ ‚Üê —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–æ –∏–∑ PartHeader

    –î–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω—è—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è:
    - –ú–µ–Ω—è–µ—à—å –≤ PartHeader ‚Üí –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü–µ ‚úì
    - –ú–µ–Ω—è–µ—à—å –≤ —Ç–∞–±–ª–∏—Ü–µ ‚Üí –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –≤ PartHeader ‚úì
    ```
  - üìä **–ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö**: PartHeader [255] ‚Üî PositionRow (beton) ‚Üî –§–æ—Ä–º—É–ª—ã
  - ‚úÖ **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è**: –î–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω—è—è —á–µ—Ä–µ–∑ React Query
  - **–ß—Ç–æ —ç—Ç–æ –∑–Ω–∞—á–∏—Ç**:
    - üü† –í–≤–æ–¥ –æ–±—ä–µ–º–∞: –¢–û–õ–¨–ö–û –≤ PartHeader (—É–¥–æ–±–Ω–æ, –≤–∏–¥–Ω–æ —Å—Ä–∞–∑—É)
    - üìã –¢–∞–±–ª–∏—Ü–∞: –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —ç—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ + –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (–ª–∏–ª–∏, –∑–ø, —á–∞—Å—ã, –¥–Ω–∏)
    - üìê –§–æ—Ä–º—É–ª—ã: –∏—Å–ø–æ–ª—å–∑—É—é—Ç qty –∏–∑ beton = concrete_m3 (–≤—Å–µ —Ä–∞—Å—á–µ—Ç—ã –ø—Ä–∞–≤–∏–ª—å–Ω—ã!)
  - **Files changed**: PartHeader.tsx (restored volume input), PositionsTable.tsx (restored sync function)
  - **Result**: –õ–æ–≥–∏—á–Ω–∞—è, –∏–Ω—Ç—É–∏—Ç–∏–≤–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ - –æ–±—ä–µ–º –≤–≤–æ–¥–∏—à—å —Ä—è–¥–æ–º —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º!

- **v4.3.1** (2025-11-08) - **BROKEN: Incomplete Refactor**
  - ‚ùå –û—à–∏–±–∫–∞: –ü—ã—Ç–∞–ª—Å—è —É–±—Ä–∞—Ç—å input –∏–∑ PartHeader
  - ‚ùå –†–µ–∑—É–ª—å—Ç–∞—Ç: –§–æ—Ä–º—É–ª—ã –Ω–µ —Ä–∞–±–æ—Ç–∞–ª–∏, –Ω–µ—Ç —É–¥–æ–±–Ω–æ–≥–æ –º–µ—Å—Ç–∞ –≤–≤–æ–¥–∞
  - ‚úì –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ v4.3.2

- **v4.3** (2025-11-08) - **MAJOR UI/UX Improvements** (BROKEN - Fixed in v4.3.2):

  ### Part A: Concrete Volume Input Refactor (‚ùå BROKEN - Fixed in v4.3.1)
  - ‚ùå BROKEN: Attempted to move input to PartHeader
  - ‚úì FIXED in v4.3.1: Input moved to correct location - table beton row

  ### Part B: Collapsible Sidebar with Smart Features (‚úÖ WORKING)
  - ‚ú® **localStorage persistence**: Sidebar state remembered between sessions
  - ‚å®Ô∏è **Keyboard shortcut**: `Ctrl+B` (Windows/Linux) / `Cmd+B` (Mac) to toggle
  - üì± **Smart defaults**: Auto-collapsed on screens < 1280px
  - üèóÔ∏è **Collapsed state indicator**: Icon + badge showing bridge count
  - üí° **Improved tooltips**: Show keyboard hints and bridge count
  - üìè **Table expansion**: Gains +180-200px width when sidebar collapsed (less horizontal scrolling)
  - üé® **Smooth transitions**: Already implemented in previous versions
  - üéØ **UX improvement**: Users control their workspace layout (modern pattern from VS Code, Gmail, Notion)
  - üìÇ **Files modified**:
    - `App.tsx`: localStorage, keyboard shortcuts, smart defaults
    - `Sidebar.tsx`: collapsed indicator with badge
    - `components.css`: collapsed-indicator styles

- **v4.2** (2025-11-08) - Hierarchical Table Structure (CRITICAL FIX):
  - üèóÔ∏è **MAJOR REFACTOR**: Fixed "N√°zev polo≈æky" duplication problem
  - ‚ú® **Created PartHeader component**: Shows construction part name ONCE instead of in every row
  - üóëÔ∏è **Removed "N√°zev polo≈æky" column from table**: Eliminated redundant name inputs
  - üìä **New hierarchical structure**:
    ```
    ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
    ‚ïë N√ÅZEV: [Editable Input - one time]  ‚ïë ‚Üê PartHeader
    ‚ïë MJ: M3 | Mno≈æstv√≠: 43.8 m¬≥          ‚ïë
    ‚ï†‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï£
    ‚ïë Podtyp ‚îÇ MJ ‚îÇ Mno≈æstv√≠ ‚îÇ ...        ‚ïë
    ‚ïë‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ         ‚ïë
    ‚ïë beton  ‚îÇ M3 ‚îÇ  43.8    ‚îÇ ...        ‚ïë ‚Üê PositionRow
    ‚ïë bednƒõn√≠‚îÇ m2 ‚îÇ  63.6    ‚îÇ ...        ‚ïë
    ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
    ```
  - üé® **PartHeader styles**: Orange editable input (#FFA726), concrete-params display
  - üìÅ **New component**: `frontend/src/components/PartHeader.tsx` (59 lines)
  - üî¢ **Updated colSpan**: 17 ‚Üí 16 columns after removing name column
  - üóÑÔ∏è **Database**: item_name field now stored at position level, displayed once per part
  - ‚úÖ **Result**: Cleaner UX - users fill name once, not for every subtype (beton/bednƒõn√≠/v√Ωztu≈æ)

- **v4.1** (2025-11-07) - KPI Optimization & Template Update:
  - üé® **Optimized KPI Panel layout** (4 columns √ó 2 rows instead of dynamic grid)
  - üóëÔ∏è **Removed Kƒç/t (œÅ=2.4) metric** as per detailed audit requirements
  - üìè **Reduced KPI card sizes**: padding 12px ‚Üí 8px 10px, fonts: label 11px ‚Üí 10px, value 18px ‚Üí 16px
  - üî¢ **Fixed z-index hierarchy**: KPI panel (z-index: 100), table headers (z-index: 90, top: 140px)
  - ‚ú® **Updated bridge templates**: from 15 ‚Üí 24 positions (11 construction parts from detailed spec)
  - üèóÔ∏è **New templates**: ≈ò√çMSY (B37), P≈òECHODOV√â DESKY, MOSTN√ç NOSN√â KONSTRUKCE, SCHODI≈†≈§, PODKLADN√ç VRSTVY, PATKY
  - üìã **KPI Layout**: Row 1 (Celkov√° cena, Kƒç/m¬≥, Mƒõs√≠ce, T√Ωdny), Row 2 (Averages: lidi, Kƒç/hod, hod/den, Re≈æim pr√°ce)
  - üéØ **Fixed sticky behavior**: KPI stays on top, table headers scroll under KPI

- **v4.0** (2025-11-07) - Comprehensive UI/UX Audit Implementation:
  - ‚úÖ **Czech translation complete**: CreateBridgeForm translated from Russian to Czech
  - üé® **True concrete colors**: #F5F5F5 (primary bg), #E8E8E8 (cards/modals), #D0D0D0 (borders)
  - üìù **Added "N√°zev polo≈æky" column**: first editable column with min-width: 250px, orange background
  - ‚ú® **Pre-filled template positions**: 15 positions with Z√ÅKLADY, ≈ò√çMSY, MOSTN√ç OPƒöRY, PIL√ç≈òE, K≈ò√çDLA, MOSTOVKA, V√ùZTU≈Ω
  - üìå **Sticky header**: table and KPI card always visible while scrolling
  - üü† **Orange inputs (#FFA726)** for all editable fields maintained
  - üåÄ **Concrete gradient**: linear-gradient(170deg, #F5F5F5 80%, #E8E8E8 100%)
  - üîí **Database migration**: added item_name column to positions table
  - üìä **Table always visible**: removed "≈Ω√°dn√© pozice" blocking state from previous sessions

- **1.0.5** (2025-11-07):
  - ‚ú® –î–æ–±–∞–≤–ª–µ–Ω—ã ensure-shared-build.js —Å–∫—Ä–∏–ø—Ç—ã (—Ä–µ—à–µ–Ω–∏–µ –æ—Ç Codex)
  - ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–±–æ—Ä–∫–∞ shared –ø–∞–∫–µ—Ç–∞ —á–µ—Ä–µ–∑ prestart/prebuild —Ö—É–∫–∏
  - ‚úÖ –£–ø—Ä–æ—â–µ–Ω—ã buildCommand –≤ render.yaml (npm install ‚Üí –∞–≤—Ç–æ–º–∞—Ç–∏–∫–∞)
  - ‚úÖ –ê–≤—Ç–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ: —Å–æ–±–∏—Ä–∞–µ—Ç —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ dist/ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç
  - ‚ö†Ô∏è –í–ê–ñ–ù–û: CORS_ORIGIN="*" –∏ VITE_API_URL=sync:false - –ù–ï –∫–æ—Å—Ç—ã–ª–∏!
  - üìù –≠—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è fromService deadlock –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –¥–µ–ø–ª–æ–µ

- **1.0.4** (2025-11-07):
  - üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ —Ü–∏–∫–ª–∏—á–µ—Å–∫–∞—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –≤ render.yaml
  - ‚úÖ –£–±—Ä–∞–Ω–∞ fromService –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –º–µ–∂–¥—É backend ‚Üî frontend
  - ‚úÖ CORS_ORIGIN –≤—Ä–µ–º–µ–Ω–Ω–æ = "*" (–ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è –º–æ–∂–Ω–æ –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å)
  - ‚úÖ VITE_API_URL = sync:false (—É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –≤—Ä—É—á–Ω—É—é –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è backend)
  - ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å buildCommand: shared build –ü–ï–†–í–´–ú
  - ‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ù–û: fromService —Å–æ–∑–¥–∞—ë—Ç deadlock –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –¥–µ–ø–ª–æ–µ!
  - üìù –ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è: —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å VITE_API_URL –≤ Render dashboard –≤—Ä—É—á–Ω—É—é

- **1.0.3** (2025-11-07):
  - üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ ESM –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è shared –ø–∞–∫–µ—Ç–∞
  - ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ "type": "module" –≤ shared/package.json
  - ‚úÖ TypeScript –∫–æ–º–ø–∏–ª—è—Ü–∏—è: CommonJS ‚Üí ES2020
  - ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã .js —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –≤ –∏–º–ø–æ—Ä—Ç—ã (—Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ ESM)
  - ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã TypeScript –æ—à–∏–±–∫–∏ –≤–æ frontend (unused imports, type assertions)
  - ‚ö†Ô∏è –í–ê–ñ–ù–û: shared –ø–∞–∫–µ—Ç –î–û–õ–ñ–ï–ù —Å–æ–±–∏—Ä–∞—Ç—å—Å—è –ø–µ—Ä–µ–¥ backend/frontend

- **1.0.2** (2025-11-07):
  - üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –≤–µ—Ä—Å–∏—è Node.js –¥–ª—è better-sqlite3
  - ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω .nvmrc ‚Üí Node.js 18.20.4 (–∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–æ)
  - ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω engines –≤ backend/package.json ‚Üí Node 18.x only
  - ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω NODE_VERSION=18.20.4 –≤ render.yaml
  - ‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ù–û: better-sqlite3 –ù–ï —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ Node.js 25.x!

- **1.0.1** (2025-11-07):
  - üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω render.yaml –¥–ª—è Blueprint deployment
  - ‚úÖ Frontend: –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `type: web` —Å `env: static` (–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å)
  - ‚úÖ –£–¥–∞–ª—ë–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä 'region' (–Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è free tier)
  - ‚ö†Ô∏è –í–ê–ñ–ù–û: Render Blueprint —Ç—Ä–µ–±—É–µ—Ç `type: web` + `env: static`, –ù–ï `type: static`!

- **1.0.0** (2025-11-07):
  - ‚úÖ –ü–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è core-—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
  - ‚úÖ –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è –º–µ—Ç—Ä–∏–∫–∞ CZK/–º¬≥
  - ‚úÖ KROS-–æ–∫—Ä—É–≥–ª–µ–Ω–∏–µ
  - ‚úÖ –†–∞—Å—á—ë—Ç –º–µ—Å—è—Ü–µ–≤/–Ω–µ–¥–µ–ª—å ‚≠ê NEW
  - ‚úÖ –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å 30/22 –¥–Ω—è ‚≠ê NEW
  - ‚úÖ –ê–ø–µ–ª—å—Å–∏–Ω–æ–≤—ã–µ input-–ø–æ–ª—è
  - ‚úÖ –î–µ–ø–ª–æ–π –Ω–∞ Render
  - ‚úÖ CLAUDE.MD —Å–æ–∑–¥–∞–Ω

---

## üìä –ê–ù–ê–õ–ò–ó –ö–û–î–ê v4.8.0 (2025-11-09)

### ‚úÖ –ü–û–õ–ù–û–°–¢–¨–Æ –†–ï–ê–õ–ò–ó–û–í–ê–ù–û –ò –†–ê–ë–û–¢–ê–ï–¢:

#### 1. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –±–µ—Ç–æ–Ω–∞ ‚úÖ
- **PartHeader.tsx** (lines 16-98): INPUT –ø–æ–ª–µ "Objem betonu celkem" —Å –¥–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω–µ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–µ–π
- **PositionsTable.tsx** (lines 37-67): handleBetonQuantityUpdate() –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –¢–û–õ–¨–ö–û {id, qty}
- **PositionRow.tsx** (line 100): beton row –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞ `disabled={isLocked || position.subtype === 'beton'}`
- **Backend**: –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç derived fields —á–µ—Ä–µ–∑ calculator.js

#### 2. KPI –ü–∞–Ω–µ–ª—å - –∫–æ–º–ø–∞–∫—Ç–Ω—ã–π –æ–¥–Ω–æ—Å—Ç—Ä–æ—á–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç ‚úÖ
- **KPIPanel.tsx** (lines 24-131): 8 –º–µ—Ç—Ä–∏–∫ –≤ –æ–¥–Ω—É —Å—Ç—Ä–æ–∫—É (4+4)
- **CSS grid**: `repeat(4, 1fr)` (lines 1089-1094)
- **–†–∞–∑–º–µ—Ä—ã**: Label 10px, Value 14px bold, Unit 9px
- **–§–æ—Ä–º—É–ª–∞ –≤–Ω–∏–∑—É**: –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è —Å —Ä–∞—Å—á–µ—Ç–æ–º –º–µ—Å—è—Ü–µ–≤

#### 3. –¢–∏–ø–æ–≥—Ä–∞—Ñ–∏—è - CSS –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ ‚úÖ
- **global.css** (lines 80-102): 11 —Ä–∞–∑–º–µ—Ä–æ–≤ + 4 –≤–µ—Å–∞ + 3 –≤—ã—Å–æ—Ç—ã —Å—Ç—Ä–æ–∫
- **–í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ**: Header.tsx, DaysPerMonthToggle.tsx, KPIPanel.tsx
- **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è**: 15px‚Üí14px, 10px‚Üí11px, 12px‚Üí11px

#### 4. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Å—Ç—Ä–æ–∫ ‚úÖ
- **PositionsTable.tsx** (lines 100-136): handleAddRow() —Å API call
- **–ö–Ω–æ–ø–∫–∞**: "‚ûï –î–æ–±–∞–≤–∏—Ç—å —Å—Ç—Ä–æ–∫—É" (lines 258-265)
- **Default values**: subtype='jin√©', qty=1, crew_size=4, wage_czk_ph=398

#### 5. RFI Warning —Å–∏—Å—Ç–µ–º–∞ ‚úÖ
- **Backend** (shared/src/formulas.ts lines 133-151): has_rfi=true –µ—Å–ª–∏ concrete_m3=0
- **Frontend** (PositionRow.tsx lines 218-223): RFI badge "‚ö†Ô∏è" —Å tooltip
- **Orange highlight**: –ù–∞ key metric cell (line 189) –∫–æ–≥–¥–∞ has_rfi=true

#### 6. –í–∞–ª–∏–¥–∞—Ü–∏—è –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π ‚úÖ
- **–í—Å–µ input –ø–æ–ª—è**: min="0" (PositionRow.tsx lines 91, 113, 128, 143, 158)
- **PartHeader**: min="0" –Ω–∞ concrete input (line 89)
- **JavaScript**: Math.max(0, value) –≤ onChange –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞—Ö

#### 7. Build —Å—Ç–∞—Ç—É—Å ‚úÖ
- ‚úÖ –£—Å–ø–µ—à–Ω–æ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è (170 modules transformed)
- ‚úÖ 29KB CSS, 258KB JS
- ‚úÖ Commit `79c2fb7` pushed –≤ feature branch

### ‚ö†Ô∏è –¢–†–ï–ë–£–ï–¢ –í–ù–ò–ú–ê–ù–ò–Ø (Priority 1-3):

#### Priority 1 - –ö–†–ò–¢–ò–ß–ù–´–ï:
1. **–ó–∞–ø—Ä–µ—Ç–∏—Ç—å —É–¥–∞–ª–µ–Ω–∏–µ beton row** - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç —É–¥–∞–ª–∏—Ç—å, –Ω–∞—Ä—É—à–∏–≤ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É
2. **Validation "Objem betonu" –ø–µ—Ä–µ–¥ snapshot** - –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å snapshot –±–µ–∑ –±–µ—Ç–æ–Ω–∞
3. **–ó–∞–º–µ–Ω–∏—Ç—å hardcoded font-sizes –Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ KPI** - line 1169, 1180, 1084

#### Priority 2 - –í–´–°–û–ö–ò–ï:
1. **Responsive KPI –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö** - –Ω–µ—Ç media query –¥–ª—è < 768px
2. **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ RFI items** - –Ω–µ—Ç —Å–ø–æ—Å–æ–±–∞ –ø–æ–∫–∞–∑–∞—Ç—å —Ç–æ–ª—å–∫–æ RFI
3. **–≠–∫—Å–ø–æ—Ä—Ç RFI summary** - –Ω–µ—Ç "Export RFI report" –æ–ø—Ü–∏–∏

#### Priority 3 - –£–õ–£–ß–®–ï–ù–ò–Ø:
1. **–¢–µ–º–Ω—ã–π —Ä–µ–∂–∏–º** - toggle –µ—Å—Ç—å, –Ω–æ –Ω–µ—Ç –ª–æ–≥–∏–∫–∏
2. **–ò—Å—Ç–æ—Ä–∏—è snapshots** - –Ω–µ—Ç UI –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
3. **Audit log** - –Ω–µ—Ç –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

#### –ò–ó–í–ï–°–¢–ù–´–ï –ü–†–û–ë–õ–ï–ú–´:
1. ‚ùå item_name –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –¥–ª—è –í–°–ï–• –ø–æ–∑–∏—Ü–∏–π —á–∞—Å—Ç–∏ (–Ω—É–∂–Ω–∞ –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∞)
2. ‚ùå –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —á–∏—Å–µ–ª –≤ PartHeader - –Ω–µ—Ç step="0.01"
3. ‚ùå –ò–Ω–¥–∏–∫–∞—Ü–∏—è locked state –≤ KPI - –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤–∏–∑—É–∞–ª—å–Ω–æ

### üìà –ò–¢–û–ì–û–í–ê–Ø –°–¢–ê–¢–ò–°–¢–ò–ö–ê:

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –°—Ç–∞—Ç—É—Å | %Ready |
|-----------|--------|--------|
| –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –±–µ—Ç–æ–Ω–∞ | ‚úÖ | 100% |
| KPI –ø–∞–Ω–µ–ª—å | ‚úÖ | 95% |
| –¢–∏–ø–æ–≥—Ä–∞—Ñ–∏—è | ‚úÖ | 100% |
| –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫ | ‚úÖ | 100% |
| RFI warnings | ‚úÖ | 90% |
| –í–∞–ª–∏–¥–∞—Ü–∏—è | ‚úÖ | 80% |
| –¢–µ–º–Ω—ã–π —Ä–µ–∂–∏–º | ‚ö†Ô∏è | 30% |
| Snapshots/History | ‚ùå | 20% |

**–û–ë–©–ê–Ø –ì–û–¢–û–í–ù–û–°–¢–¨: 85% –æ—Ç –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞**

---

## üõ†Ô∏è –†–ï–ê–õ–ò–ó–£–ï–ú–´–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø (v4.9.0+)

### Priority 1 - –ö–†–ò–¢–ò–ß–ù–´–ï:

#### 1Ô∏è‚É£ ‚úÖ –ì–û–¢–û–í–û: –ó–∞–ø—Ä–µ—Ç–∏—Ç—å —É–¥–∞–ª–µ–Ω–∏–µ beton row
**–ü—Ä–æ–±–ª–µ–º–∞**: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç —É–¥–∞–ª–∏—Ç—å beton row, –Ω–∞—Ä—É—à–∏–≤ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –∏ —Ä–∞—Å—á–µ—Ç—ã
**–†–µ—à–µ–Ω–∏–µ –†–ï–ê–õ–ò–ó–û–í–ê–ù–û (commit `aaa1e90`)**:
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ `if (position.subtype === 'beton')` –≤ handleDelete()
- ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–æ–¥—Ä–æ–±–Ω—ã–π alert —Å –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ–º –ø–æ—á–µ–º—É beton row –∫—Ä–∏—Ç–∏—á–Ω–∞
- ‚úÖ Delete –∫–Ω–æ–ø–∫–∞ disabled –¥–ª—è beton rows: `disabled={isLocked || position.subtype === 'beton'}`
- ‚úÖ Tooltip –æ–±—ä—è—Å–Ω—è–µ—Ç –∫–∞–∫ –∏–∑–º–µ–Ω–∏—Ç—å –æ–±—ä–µ–º –±–µ—Ç–æ–Ω–∞ (—á–µ—Ä–µ–∑ PartHeader)

**–§–∞–π–ª**: `frontend/src/components/PositionRow.tsx` (lines 44-59, 234-247)
**Build**: ‚úÖ –£—Å–ø–µ—à–Ω–æ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è (259KB JS, 29KB CSS)

#### 2Ô∏è‚É£ ‚úÖ –ì–û–¢–û–í–û: Validation "Objem betonu" –ø–µ—Ä–µ–¥ snapshot
**–ü—Ä–æ–±–ª–µ–º–∞**: –ú–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å snapshot –±–µ–∑ –≤–≤–µ–¥–µ–Ω–Ω–æ–≥–æ –æ–±—ä–µ–º–∞ –±–µ—Ç–æ–Ω–∞
**–†–µ—à–µ–Ω–∏–µ –†–ï–ê–õ–ò–ó–û–í–ê–ù–û (commit `5823c9c`)**:
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤ handleCreateSnapshot()
- ‚úÖ –î–µ—Ç–µ–∫—Ç–∏—Ä—É–µ—Ç missing concrete volume (sum_concrete_m3 === 0)
- ‚úÖ –î–µ—Ç–µ–∫—Ç–∏—Ä—É–µ—Ç RFI warnings (–ø–æ–∑–∏—Ü–∏–∏ —Å –ø—Ä–æ–±–ª–µ–º–∞–º–∏)
- ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥–µ—Ç–∞–ª—å–Ω–æ–µ warning –¥–∏–∞–ª–æ–≥ —Å:
  * –ü–µ—Ä–µ—á–Ω–µ–º RFI –ø—Ä–æ–±–ª–µ–º (–¥–æ 3 –ø–æ–∫–∞–∑–∞–Ω—ã –ø–æ–ª–Ω–æ—Å—Ç—å—é)
  * –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é override (user –º–æ–∂–µ—Ç –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
  * Guidance –∫–∞–∫ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –∏ —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π snapshot

**–§–∞–π–ª**: `frontend/src/components/Header.tsx` (lines 112-139)
**Build**: ‚úÖ –£—Å–ø–µ—à–Ω–æ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è (260KB JS, 29KB CSS)

#### 3Ô∏è‚É£ ‚úÖ –ì–û–¢–û–í–û: –ó–∞–º–µ–Ω–∏—Ç—å hardcoded font-sizes –Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ KPI
**–ü—Ä–æ–±–ª–µ–º–∞**: KPI –∏—Å–ø–æ–ª—å–∑—É–µ—Ç hardcoded sizes –≤–º–µ—Å—Ç–æ CSS –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
**–†–µ—à–µ–Ω–∏–µ –†–ï–ê–õ–ò–ó–û–í–ê–ù–û (commit `ed69cbc`)**:
- ‚úÖ Line 1084: `.kpi-metadata` 11px ‚Üí `var(--font-size-meta)`
- ‚úÖ Line 1169: `.kpi-card-label` 10px ‚Üí `var(--font-size-sm)`
- ‚úÖ Line 1180: `.kpi-card-value` 14px ‚Üí `var(--font-size-base)`
- ‚úÖ Line 1188: `.kpi-card-unit` 9px ‚Üí `var(--font-size-xs)` (bonus)

**–§–∞–π–ª**: `frontend/src/styles/components.css`
**Build**: ‚úÖ –£—Å–ø–µ—à–Ω–æ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è (260KB JS, 29KB CSS)

#### 4Ô∏è‚É£ ‚úÖ –ì–û–¢–û–í–û: –ò—Å–ø—Ä–∞–≤–∏—Ç—å sticky positioning —Ç–∞–±–ª–∏—Ü—ã (thead –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç —Å—Ç—Ä–æ–∫–∏)
**–ü—Ä–æ–±–ª–µ–º–∞**: Table header (thead) –±–ª–æ–∫–∏—Ä–æ–≤–∞–ª —Ç–∞–±–ª–∏—Ü—É –ø—Ä–∏ —Å–∫—Ä–æ–ª–ª–∏–Ω–≥–µ
**–ü—Ä–∏—á–∏–Ω–∞**: `position: sticky` –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ —Å `overflow-x: auto`
**–†–µ—à–µ–Ω–∏–µ –†–ï–ê–õ–ò–ó–û–í–ê–ù–û (commit `9599e52`)**:
- ‚úÖ –ü–µ—Ä–µ–º–µ—â–µ–Ω–∞ `<thead>` –∏–∑ `.table-wrapper` (overflow –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä)
- ‚úÖ –°–æ–∑–¥–∞–Ω–∞ –æ—Ç–¥–µ–ª—å–Ω–∞—è header table `.positions-table-header` (sticky —Ä–∞–±–æ—Ç–∞–µ—Ç)
- ‚úÖ Body —Ç–∞–±–ª–∏—Ü–∞ –æ—Å—Ç–∞—ë—Ç—Å—è –≤ `.table-wrapper` –¥–ª—è –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–≥–æ —Å–∫—Ä–æ–ª–ª–∞
- ‚úÖ Header –∏ body —Ç–∞–±–ª–∏—Ü—ã –≤—ã—Ä–∞–≤–Ω–µ–Ω—ã –ø–æ —à–∏—Ä–∏–Ω–µ –∫–æ–ª–æ–Ω–æ–∫

**–§–∞–π–ª**: `frontend/src/components/PositionsTable.tsx`, `frontend/src/styles/components.css`
**Build**: ‚úÖ –£—Å–ø–µ—à–Ω–æ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è (261KB JS, 29KB CSS)

#### 5Ô∏è‚É£ ‚úÖ –ì–û–¢–û–í–û: –ò—Å–ø—Ä–∞–≤–∏—Ç—å responsive table header offset
**–ü—Ä–æ–±–ª–µ–º–∞**: –ù–∞ –º–æ–±–∏–ª—è—Ö KPI panel –≤—ã—à–µ 180px, header —Å–∫—Ä—ã–≤–∞–µ—Ç—Å—è –∑–∞ –Ω–µ–π (z-index: 100 vs 50)
**–ü—Ä–∏—á–∏–Ω–∞**: –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π `top: 180px` –Ω–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç –º–µ–Ω—è—é—â—É—é—Å—è –≤—ã—Å–æ—Ç—É KPI –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —ç–∫—Ä–∞–Ω–∞—Ö:
  - Desktop (4 col): ~140px
  - Tablet (2 col @ 768px): ~180-200px
  - Phone (1 col @ 480px): ~240-250px
**–†–µ—à–µ–Ω–∏–µ –†–ï–ê–õ–ò–ó–û–í–ê–ù–û (commit `b6e83ed`)**:
- ‚úÖ Tablet (‚â§768px): `top: 220px` –¥–ª—è 2-column KPI layout
- ‚úÖ Phone (‚â§480px): `top: 290px` –¥–ª—è 1-column KPI layout
- ‚úÖ Header —Ç–µ–ø–µ—Ä—å –≤–∏–¥–Ω–∞ –Ω–∞ –≤—Å–µ—Ö —ç–∫—Ä–∞–Ω–∞—Ö

**–§–∞–π–ª**: `frontend/src/styles/components.css` (media query overrides)
**Build**: ‚úÖ –£—Å–ø–µ—à–Ω–æ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è (261KB JS, 29KB CSS)

#### 6Ô∏è‚É£ ‚úÖ –ì–û–¢–û–í–û: –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–π —Å–∫—Ä–æ–ª–ª header –∏ body
**–ü—Ä–æ–±–ª–µ–º–∞**: Header –±—ã–ª sticky, –Ω–æ –Ω–µ –¥–≤–∏–≥–∞–ª—Å—è –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ —Å table body
- –ü—Ä–∏ —Å–∫—Ä–æ–ª–ª–∏–Ω–≥–µ —Ç–∞–±–ª–∏—Ü—ã –≤–ª–µ–≤–æ/–≤–ø—Ä–∞–≤–æ, header –æ—Å—Ç–∞–≤–∞–ª—Å—è –Ω–∞ –º–µ—Å—Ç–µ
- –ö–æ–ª–æ–Ω–∫–∏ header –Ω–µ —Å–æ–≤–ø–∞–¥–∞–ª–∏ —Å –∫–æ–ª–æ–Ω–∫–∞–º–∏ body
**–†–µ—à–µ–Ω–∏–µ –†–ï–ê–õ–ò–ó–û–í–ê–ù–û (commit `5a9fa83`)**:
- ‚úÖ –û–±—ë—Ä–Ω—É—Ç–∞ header —Ç–∞–±–ª–∏—Ü–∞ –≤ `.table-header-wrapper` —Å `overflow-x: auto`
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ JavaScript —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è scroll —Å–æ–±—ã—Ç–∏–π
- ‚úÖ –ö–æ–≥–¥–∞ body scroll–∏—Ç, header wrapper —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç —Å–≤–æ–π scrollLeft
- ‚úÖ Scrollbar header-wrapper —Å–∫—Ä—ã—Ç (–≤–∏–¥–Ω–∞ —Ç–æ–ª—å–∫–æ scrollbar body)
- ‚úÖ –£–º–µ–Ω—å—à–µ–Ω–∞ —à–∏—Ä–∏–Ω–∞ –∫–æ–ª–æ–Ω–∫–∏ "Hod celkem" –¥–æ 70px (—Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –º–µ—Å—Ç–æ)

**–§–∞–π–ª**: `frontend/src/components/PositionsTable.tsx`, `frontend/src/styles/components.css`
**Build**: ‚úÖ –£—Å–ø–µ—à–Ω–æ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è (262KB JS, 30KB CSS)

### ‚úÖ PRIORITY 1 - –í–°–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø –ó–ê–í–ï–†–®–ï–ù–´!

**Commit history:**
- `aaa1e90` - üîí Prevent deletion of beton row
- `5823c9c` - üîç Add validation before snapshot creation
- `ed69cbc` - üé® Replace hardcoded fonts with CSS variables
- `1b52fde` - üìù Document Priority 1 completion
- `9599e52` - üîß Fix table header sticky positioning (move thead outside overflow)
- `b6e83ed` - üîß Fix table header sticky offset for responsive breakpoints
- `5a9fa83` - üîß Synchronize table header and body horizontal scrolling

**Status:** –í—Å–µ —à–µ—Å—Ç—å –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π —É—Å–ø–µ—à–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã ‚úÖ

---

## üö® –ö–†–ò–¢–ò–ß–ù–´–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø (v4.10.0 - –¢–ï–ö–£–©–ò–ï)

### ‚úÖ –≠–ö–°–¢–†–ï–ù–ù–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –¢–∞–±–ª–∏—Ü–∞ + React Query

#### 1Ô∏è‚É£ ‚úÖ –ì–û–¢–û–í–û: –ë–µ—Å–∫–æ–Ω–µ—á–Ω—ã–π —Ü–∏–∫–ª –∑–∞–≥—Ä—É–∑–∫–∏ (React Query)
**–ü—Ä–æ–±–ª–µ–º–∞**: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ React Query + setState –≤ queryFn –≤—ã–∑—ã–≤–∞–ª–æ –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã–π loop
**–ü—Ä–∏–∑–Ω–∞–∫**: "Naƒç√≠t√°m..." –∑–∞—Ü–∏–∫–ª–∏–≤–∞–µ—Ç—Å—è, —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –Ω–µ–≤–∏–¥–∏–º–∞
**–†–µ—à–µ–Ω–∏–µ –†–ï–ê–õ–ò–ó–û–í–ê–ù–û (commits `d487466`, `7508965`)**:

**–≠—Ç–∞–ø 1 (d487466):**
- ‚úÖ **usePositions.ts**:
  - –î–æ–±–∞–≤–ª–µ–Ω `showOnlyRFI` –≤ `queryKey: ['positions', bridgeId, showOnlyRFI]`
  - –û—Ç–∫–ª—é—á–µ–Ω–æ `refetchOnMount: true` ‚Üí `refetchOnMount: false`
  - –î–æ–±–∞–≤–ª–µ–Ω–æ `staleTime: 30 * 1000` (–∫—ç—à –Ω–∞ 30 —Å–µ–∫—É–Ω–¥)
  - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ `invalidateQueries` —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º queryKey
- ‚úÖ **useBridges.ts**: –û—Ç–∫–ª—é—á–µ–Ω–æ `refetchOnMount`, –¥–æ–±–∞–≤–ª–µ–Ω `staleTime`
- ‚úÖ **useSnapshots.ts**: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –≤ useEffect

**–≠—Ç–∞–ø 2 - –ü–æ–ª–Ω–∞—è –ø–µ—Ä–µ–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è React Query (7508965):**
- ‚úÖ **main.tsx** - QueryClient defaultOptions:
  - `refetchOnMount: false` (CRITICAL - –≥–ª–∞–≤–Ω—ã–π –≤–∏–Ω–æ–≤–Ω–∏–∫ —Ü–∏–∫–ª–∞!)
  - `refetchOnWindowFocus: false`
  - `staleTime: 5 * 60 * 1000` (5 –º–∏–Ω—É—Ç –±–µ–∑ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ refetch)
  - `gcTime: 10 * 60 * 1000` (10 –º–∏–Ω—É—Ç –¥–æ garbage collection)
- ‚úÖ **useConfig.ts**: –£–±—Ä–∞–Ω setState –∏–∑ queryFn (anti-pattern), –ø–µ—Ä–µ–ø–∏—Å–∞–Ω –∫–∞–∫ context update
- ‚úÖ **–í—Å–µ useQuery hooks** (usePositions, useBridges, useConfig):
  - –î–æ–±–∞–≤–ª–µ–Ω—ã `refetchOnWindowFocus: false`, `gcTime` –¥–ª—è –≤—Å–µ—Ö
  - –£–≤–µ–ª–∏—á–µ–Ω `staleTime` —Å 30—Å–µ–∫ –¥–æ 5 –º–∏–Ω—É—Ç (–º–µ–Ω—å—à–µ refetch)

**–ü–æ—á–µ–º—É —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
- `staleTime: 5min` = –¥–∞–Ω–Ω—ã–µ —Å—á–∏—Ç–∞—é—Ç—Å—è "—Å–≤–µ–∂–∏–º–∏" 5 –º–∏–Ω—É—Ç, –ë–ï–ó refetch
- `refetchOnMount: false` = –ø—Ä–∏ —Ä–µ-—Ä–µ–Ω–¥–µ—Ä–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ –ù–ï –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è API –∑–∞–ø—Ä–æ—Å
- `refetchOnWindowFocus: false` = –ø—Ä–∏ –≤–æ–∑–≤—Ä–∞—Ç–µ –≤ –æ–∫–Ω–æ –ù–ï —Ä–µ—Ñ–µ—Ç—á–∏—Ç—å
- **–ò—Ç–æ–≥:** –î–∞–Ω–Ω—ã–µ –∫—ç—à–∏—Ä—É—é—Ç—Å—è, API –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

**Impact**: –ü–æ–ª–Ω–æ—Å—Ç—å—é —É—Å—Ç—Ä–∞–Ω—ë–Ω –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã–π "Naƒç√≠t√°m..." —Ü–∏–∫–ª ‚úÖ

#### 2Ô∏è‚É£ ‚úÖ –ì–û–¢–û–í–û: –ü–µ—Ä–µ–≤—ë—Ä–Ω—É—Ç–∞—è –ª–æ–≥–∏–∫–∞ RFI —Ñ–∏–ª—å—Ç—Ä–∞
**–ü—Ä–æ–±–ª–µ–º–∞**: Codex Review –ø–µ—Ä–µ—Ö–≤–∞—Ç–∏–ª –∏–Ω–≤–µ—Ä—Å–∏—é –ª–æ–≥–∏–∫–∏ showOnlyRFI
**–û—à–∏–±–∫–∞**: –ë—ã–ª–æ `positionsAPI.getForBridge(bridgeId, showOnlyRFI)` (–±–µ–∑ `!`)
**–†–µ—à–µ–Ω–∏–µ –†–ï–ê–õ–ò–ó–û–í–ê–ù–û (commit `5e7b3e9`)**:
- ‚úÖ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ `!showOnlyRFI` ‚Üí –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞
  - `showOnlyRFI=false` ‚Üí `include_rfi=true` ‚Üí –ø–æ–∫–∞–∑–∞—Ç—å –í–°–ï ‚úÖ
  - `showOnlyRFI=true` ‚Üí `include_rfi=false` ‚Üí —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å RFI ‚úÖ
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω queryKey

**–°–ø–∞—Å–∏–±–æ Codex –∑–∞ –ø–µ—Ä–µ—Ö–≤–∞—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–π –æ—à–∏–±–∫–∏!**

#### 3Ô∏è‚É£ ‚úÖ –ì–û–¢–û–í–û: –ù–µ—Å—Ç–∞–±–∏–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ —Å —Å–º–µ—â–µ–Ω–∏–µ–º –∫–æ–ª–æ–Ω–æ–∫
**–ü—Ä–æ–±–ª–µ–º–∞**: –î–≤–µ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã (header + body) –Ω–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–ª–∏—Å—å –∏–¥–µ–∞–ª—å–Ω–æ
**–ü—Ä–∏–∑–Ω–∞–∫–∏**:
- –ö–æ–ª–æ–Ω–∫–∏ –¥—Ä–æ–∂–∞—Ç –ø—Ä–∏ —Å–∫—Ä–æ–ª–ª–µ
- Header –Ω–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å body
- –ó–Ω–∞—á–µ–Ω–∏—è —Å–º–µ—â–µ–Ω—ã –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
**–†–µ—à–µ–Ω–∏–µ –†–ï–ê–õ–ò–ó–û–í–ê–ù–û (commit `545814f`)**:
- ‚úÖ **–û–¥–Ω–∞ —Ç–∞–±–ª–∏—Ü–∞ –≤–º–µ—Å—Ç–æ –¥–≤—É—Ö** (—É–±—Ä–∞–Ω–∞ –¥–≤–æ–π–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)
- ‚úÖ `<thead>` —Å `position: sticky; top: 0; z-index: 100` –≤–Ω—É—Ç—Ä–∏ overflow –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
- ‚úÖ **–§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —à–∏—Ä–∏–Ω—ã –≤—Å–µ—Ö 14 –∫–æ–ª–æ–Ω–æ–∫:**
  - `.col-podtyp`: 140px, `.col-mj`: 50px, `.col-mnozstvi`: 80px
  - `.col-lidi`: 70px, `.col-cena-hod`: 80px, `.col-hod-den`: 80px
  - `.col-den`: 70px, `.col-hod-celkem`: 80px, `.col-kc-celkem`: 110px
  - `.col-kc-m3`: 100px, `.col-kros-jc`: 90px, `.col-kros-celkem`: 110px
  - `.col-rfi`: 50px, `.col-akce`: 90px
- ‚úÖ –£–±—Ä–∞–Ω JavaScript sync (native CSS `position: sticky` —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã CSS –∫–ª–∞—Å—Å—ã –∫–æ –≤—Å–µ–º td –≤ PositionRow

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –¢–∞–±–ª–∏—Ü–∞ —Å—Ç–∞–±–∏–ª—å–Ω–∞, –∫–æ–ª–æ–Ω–∫–∏ –Ω–µ —Å–º–µ—â–∞—é—Ç—Å—è ‚úÖ

**Files changed:**
- `frontend/src/components/PositionsTable.tsx` (—É–±—Ä–∞–Ω–∞ .table-header-wrapper)
- `frontend/src/components/PositionRow.tsx` (–¥–æ–±–∞–≤–ª–µ–Ω—ã col-* –∫–ª–∞—Å—Å—ã)
- `frontend/src/styles/components.css` (–Ω–æ–≤—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è fixed widths)

**Build**: ‚úÖ –£—Å–ø–µ—à–Ω–æ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è (260.3KB JS, 30.76KB CSS)

---

### Priority 2 - –í–´–°–û–ö–ò–ï:

#### 1Ô∏è‚É£ ‚úÖ –ì–û–¢–û–í–û: Responsive KPI –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö
**–ü—Ä–æ–±–ª–µ–º–∞**: KPI –Ω–µ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —ç–∫—Ä–∞–Ω–æ–≤ (–∂–µ—Å—Ç–∫–æ 4 –∫–æ–ª–æ–Ω–∫–∏)
**–†–µ—à–µ–Ω–∏–µ –†–ï–ê–õ–ò–ó–û–í–ê–ù–û (commit `5ba91a2`)**:
- ‚úÖ Tablet (‚â§768px): 4 –∫–æ–ª–æ–Ω–∫–∏ ‚Üí 2 –∫–æ–ª–æ–Ω–∫–∏ layout
- ‚úÖ Phone (‚â§480px): 2 –∫–æ–ª–æ–Ω–∫–∏ ‚Üí 1 –∫–æ–ª–æ–Ω–∫–∞ layout
- ‚úÖ –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã —Ä–∞–∑–º–µ—Ä—ã —à—Ä–∏—Ñ—Ç–æ–≤ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö
- ‚úÖ –ö–æ–º–ø–∞–∫—Ç–Ω—ã–µ padding –∏ gap –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ –º–µ—Å—Ç–∞
- ‚úÖ Hide non-essential —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –Ω–∞ –æ—á–µ–Ω—å –º–∞–ª–µ–Ω—å–∫–∏—Ö —ç–∫—Ä–∞–Ω–∞—Ö
- ‚úÖ –£–ª—É—á—à–µ–Ω–∞ accessibility - larger touch targets

**–§–∞–π–ª**: `frontend/src/styles/components.css` (lines 1689-1815, +128 lines)
**Breakpoints**: 768px (tablet), 480px (phone)
**Build**: ‚úÖ –£—Å–ø–µ—à–Ω–æ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è (30KB CSS, 260KB JS)

#### 2Ô∏è‚É£ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ RFI items (–í –û–ß–ï–†–ï–î–ò)
**–ü—Ä–æ–±–ª–µ–º–∞**: –ù–µ—Ç —Å–ø–æ—Å–æ–±–∞ –ø–æ–∫–∞–∑–∞—Ç—å —Ç–æ–ª—å–∫–æ –ø–æ–∑–∏—Ü–∏–∏ —Å RFI warnings
**–†–µ—à–µ–Ω–∏–µ –ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è**:
- –î–æ–±–∞–≤–∏—Ç—å toggle button "Show only RFI" –≤ PositionsTable
- Filter positions array –ø–æ has_rfi flag
- Highlight RFI rows –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ –∞–∫—Ü–µ–Ω—Ç–∞

**–§–∞–π–ª**: `frontend/src/components/PositionsTable.tsx`

#### 3Ô∏è‚É£ ‚úÖ –ì–û–¢–û–í–û: Excel —ç–∫—Å–ø–æ—Ä—Ç –Ω–∞ —á–µ—à—Å–∫–æ–º —è–∑—ã–∫–µ —Å–æ –ø–æ–ª–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π
**–ü—Ä–æ–±–ª–µ–º–∞**: –≠–∫—Å–ø–æ—Ä—Ç –±—ã–ª –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º/—Ä—É—Å—Å–∫–æ–º, –±–µ–∑ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
**–†–µ—à–µ–Ω–∏–µ –†–ï–ê–õ–ò–ó–û–í–ê–ù–û (commit `8650698`)**:
- ‚úÖ **Sheet 1 "KPI"**: –ü–æ–ª–Ω–∞—è KPI —à–∞–ø–∫–∞ –Ω–∞ —á–µ—à—Å–∫–æ–º
  - –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –æ–±—ä–µ–∫—Ç–∞ (d√©lka, ≈°√≠≈ôka, PD)
  - –ö–ª—é‚Äã—á–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏ (beton m¬≥, cena KROS, Kƒç/m¬≥, Kƒç/t)
  - –†–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã (30/22 –¥–Ω—ñ, odhadovan√° doba)
  - –°—Ä–µ–¥–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è (pr≈Ømƒõrn√° party, sazba, hodin/den, hustota)
- ‚úÖ **Sheet 2 "Detaily"**: –î–µ—Ç–∞–ª—å–Ω—ã–π –ø–µ—Ä–µ—á–µ–Ω—å –ø–æ–∑–∏—Ü–∏–π
  - –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ part_name (Z√ÅKLADY, OPƒöRY, ≈ò√çMS–´...)
  - –í–°–ï 13 –∫–æ–ª–æ–Ω–æ–∫ –∏–∑ UI: Podtyp, MJ, Mno≈æstv√≠, Lidi, Kƒç/hod, Hod/den, Den, Hod celkem, Kƒç celkem, Kƒç/m¬≥ ‚≠ê, KROS JC, KROS celkem, RFI
  - –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ: —á–µ—à—Å–∫–∞—è –ª–æ–∫–∞–ª—å (–∑–∞–ø—è—Ç–∞—è –∫–∞–∫ decimal, –ø—Ä–æ–±–µ–ª –∫–∞–∫ thousands separator)
- ‚úÖ **–ö–Ω–æ–ø–∫–∞ –≤ Header**: –£–∂–µ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–∞, —Ä–∞–±–æ—Ç–∞–µ—Ç –∏–∑ –∫–æ—Ä–æ–±–∫–∏
  - –ö–Ω–æ–ø–∫–∞ "üì• Export XLSX" –≤ toolbar
  - –ö–Ω–æ–ø–∫–∞ "üìÑ Export CSV" –¥–ª—è –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞

**–§–∞–π–ª**: `backend/src/services/exporter.js` (–ø–æ–ª–Ω–∞—è –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∞)
**Build**: ‚úÖ –£—Å–ø–µ—à–Ω–æ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è

---

## üìû –ö–û–ù–¢–ê–ö–¢–´

- **Repository:** https://github.com/alpro1000/Monolit-Planner
- **Issues:** https://github.com/alpro1000/Monolit-Planner/issues
- **Branch:** `claude/read-claude-md-011CUw1eiUHrRXroQEJpfwk6`

---

## üîß –¢–ï–ö–£–©–ê–Ø –°–ï–°–°–ò–Ø: –ü–æ–ª–Ω–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü (FIX-TABLE-ALIGNMENT-001)

**–î–∞—Ç–∞:** 09.11.2025
**–í–µ—Ä—Å–∏—è:** v4.11.0
**Branch:** `claude/priority-2-rfi-features-011CUxE24vqoxfGC4Y3Lq53t`

### üìã –ü–†–û–ë–õ–ï–ú–ê

–í –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ —Å–º–µ—â–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü:
- –ó–∞–≥–æ–ª–æ–≤–∫–∏ –∫–æ–ª–æ–Ω–æ–∫ (PODTYP, MJ, MNO≈ΩSTV√ç, LIDI...) –Ω–µ —Å–æ–≤–ø–∞–¥–∞–ª–∏ —Å —Å–æ–¥–µ—Ä–∂–∏–º—ã–º —è—á–µ–µ–∫
- **–ü–µ—Ä–≤—ã–µ –¥–≤–µ –∫–æ–ª–æ–Ω–∫–∏ (Podtyp –∏ MJ) —Å–ª–∏–ø–∞–ª–∏—Å—å –≤–º–µ—Å—Ç–µ** –∏–∑-–∑–∞ —Å–∂–∞—Ç–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
- –°–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ç–∞–±–ª–∏—Ü—ã —Ç—Ä–µ–±–æ–≤–∞–ª–æ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–π –ø—Ä–æ–∫—Ä—É—Ç–∫–∏ –ø—Ä–∏ —É–∑–∫–æ–º —ç–∫—Ä–∞–Ω–µ
- Header –Ω–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–ª—Å—è —Å body –ø—Ä–∏ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–º —Å–∫—Ä–æ–ª–ª–µ

### üõ†Ô∏è –†–ï–®–ï–ù–ò–ï (3 –ò–¢–ï–†–ê–¶–ò–ò)

#### –ò—Ç–µ—Ä–∞—Ü–∏—è 1: Scrollbar-Gutter Workaround (commit `174fe69`)
**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–∞ Windows (non-overlay scrollbars) –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–∞—è –ø–æ–ª–æ—Å–∞ –ø—Ä–æ–∫—Ä—É—Ç–∫–∏ —Å–∂–∏–º–∞–µ—Ç body —Ç–∞–±–ª–∏—Ü—É –Ω–∞ ~15-17px, –Ω–æ header –æ—Å—Ç–∞—ë—Ç—Å—è –Ω–∞ –ø–æ–ª–Ω—É—é —à–∏—Ä–∏–Ω—É ‚Üí –∫–æ–ª–æ–Ω–Ω—ã —Å–º–µ—â–∞—é—Ç—Å—è.

**–†–µ—à–µ–Ω–∏–µ:**
- –î–æ–±–∞–≤–ª–µ–Ω–æ `scrollbar-gutter: stable` –Ω–∞ `.table-container`
- –†–µ–∑–µ—Ä–≤–∏—Ä—É–µ—Ç –º–µ—Å—Ç–æ –¥–ª—è scrollbar –¥–∞–∂–µ –∫–æ–≥–¥–∞ –µ–≥–æ –Ω–µ—Ç
- **–ù–µ–¥–æ—Å—Ç–∞—Ç–æ–∫:** –ë—ã–ª–∞ —Ç–æ–ª—å–∫–æ –ø–æ–ª–æ–≤–∏–Ω–∞ —Ä–µ—à–µ–Ω–∏—è

#### –ò—Ç–µ—Ä–∞—Ü–∏—è 2: Unified Table Wrapper (commit `e2187da`)
**–ü—Ä–æ–±–ª–µ–º–∞:** Header –∏ body –æ—Å—Ç–∞—é—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω—ã–º–∏ —Ç–∞–±–ª–∏—Ü–∞–º–∏. –û–Ω–∏ –Ω–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É—é—Ç —à–∏—Ä–∏–Ω—É –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

**–†–µ—à–µ–Ω–∏–µ:**
- –°–æ–∑–¥–∞–Ω flexbox –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä `.table-wrapper-unified` (lines 799-832 –≤ components.css)
- Header —Ç–∞–±–ª–∏—Ü–∞ –≤ –≤–µ—Ä—Ö–Ω–µ–π —á–∞—Å—Ç–∏ —Å `flex-shrink: 0` (–Ω–µ —Å–∂–∏–º–∞–µ—Ç—Å—è)
- Body –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Ä–∞—Å—Ç—è–≥–∏–≤–∞–µ—Ç—Å—è —Å `flex: 1, min-height: 0`
- –û–±–µ —Ç–∞–±–ª–∏—Ü—ã —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É—é—Ç —à–∏—Ä–∏–Ω—É –±–ª–∞–≥–æ–¥–∞—Ä—è parent –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—É
- –û–±–∞ –∏—Å–ø–æ–ª—å–∑—É—é—Ç `table-layout: fixed` –¥–ª—è –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —à–∏—Ä–∏–Ω—ã

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:**
‚úÖ Perfect header/body column alignment
‚úÖ Works with overlay and non-overlay scrollbars

**–ù–æ:** –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∞—è –ø—Ä–æ–∫—Ä—É—Ç–∫–∞ –±—ã–ª–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞ –∏–∑-–∑–∞ `overflow: hidden`

#### –ò—Ç–µ—Ä–∞—Ü–∏—è 3: Horizontal Scrolling Fix (commit `bbdc231`)
**–ü—Ä–æ–±–ª–µ–º–∞:** Wrapper –∏–º–µ–ª `overflow: hidden`, –æ–±—Ä–µ–∑–∞–≤—à–∏–π —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –±–µ–∑ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –ø—Ä–æ–∫—Ä—É—Ç–∫–∏.
- –¢–∞–±–ª–∏—Ü–∞ –≤—Å–µ–≥–æ ~1240px —à–∏—Ä–∏–Ω–æ–π
- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å–∂–∏–º–∞–ª –µ—ë –≤ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫—É—é —à–∏—Ä–∏–Ω—É
- –í—Å–µ –∫–æ–ª–æ–Ω–∫–∏ —Å–∂–∏–º–∞–ª–∏—Å—å –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
- **Podtyp** (–¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å 140px) —Å—Ç–∞–ª–∞ —Å–ª–∏—à–∫–æ–º —É–∑–∫–æ–π ‚Üí **—Å–ª–∏–ø–∞–Ω–∏–µ —Å MJ**

**–†–µ—à–µ–Ω–∏–µ:**
```css
.table-wrapper-unified {
  overflow-x: auto;        /* –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∞—è –ø—Ä–æ–∫—Ä—É—Ç–∫–∞ */
  overflow-y: visible;     /* –í–µ—Ä—Ç–∏–∫–∞–ª—å - —á–µ—Ä–µ–∑ body */
  scrollbar-gutter: stable;
}

.positions-table {
  min-width: 1240px;       /* –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç —Å–∂–∞—Ç–∏–µ –∫–æ–ª–æ–Ω–æ–∫ */
}
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:**
‚úÖ Columns maintain proper width (Podtyp: 140px, MJ: 50px, etc.)
‚úÖ Wide tables scroll horizontally smoothly
‚úÖ Header stays sticky and aligned during horizontal scroll
‚úÖ No column compression or overlapping

### üìä –§–ò–ù–ê–õ–¨–ù–ê–Ø –°–¢–†–£–ö–¢–£–†–ê –¢–ê–ë–õ–ò–¶–´

**PositionsTable.tsx (lines 209-259):**
```jsx
<div className="table-wrapper-unified">
  {/* Header Table - sticky, full width */}
  <table className="positions-table positions-table-header">
    <thead>
      <tr>
        {/* 15 columns: lock, podtyp, mj, mnozstvi, lidi, ... */}
      </tr>
    </thead>
  </table>

  {/* Body Container - vertical scrollable */}
  <div className="table-container">
    <table className="positions-table positions-table-body">
      <tbody>
        {/* PositionRow components mapped */}
      </tbody>
    </table>
  </div>
</div>
```

**CSS Rules (components.css):**
- `.table-wrapper-unified` (lines 800-810): Flexbox parent, `overflow-x: auto`, `scrollbar-gutter: stable`
- `.table-wrapper-unified .positions-table-header` (lines 813-820): `flex-shrink: 0`, sticky header
- `.table-wrapper-unified .table-container` (lines 823-832): `flex: 1`, body container
- `.positions-table` (lines 867-875): `table-layout: fixed`, `min-width: 1240px`
- `.positions-table-header` (lines 878-886): Display table, sticky positioning `top: 0`, `z-index: 150`
- `.positions-table-body` (lines 889-898): Display table, no thead shown

### ‚úÖ –†–ï–ó–£–õ–¨–¢–ê–¢–´ –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø

| –ü—Ä–æ–±–ª–µ–º–∞ | –†–µ—à–µ–Ω–∏–µ | –°—Ç–∞—Ç—É—Å |
|----------|---------|--------|
| –ö–æ–ª–æ–Ω–Ω—ã —Å–ª–∏–ø–∞—é—Ç—Å—è (Podtyp + MJ) | `min-width: 1240px` + horizontal scroll | ‚úÖ |
| Header –Ω–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å body | Unified flexbox wrapper | ‚úÖ |
| Scrollbar –≤—ã–∑—ã–≤–∞–µ—Ç —Å–º–µ—â–µ–Ω–∏–µ | `scrollbar-gutter: stable` | ‚úÖ |
| –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∞—è –ø—Ä–æ–∫—Ä—É—Ç–∫–∞ | `overflow-x: auto` –Ω–∞ wrapper | ‚úÖ |
| Header –Ω–µ –ª–∏–ø–∫–∏–π –ø—Ä–∏ –ø—Ä–æ–∫—Ä—É—Ç–∫–µ | `position: sticky; top: 0; z-index: 150` | ‚úÖ |

### üìù –ö–û–ú–ú–ò–¢–´ –°–ï–°–°–ò–ò

```
bbdc231 üîß Fix: Enable horizontal scrolling and prevent column compression
e2187da üîß Fix: Implement unified table wrapper for perfect header/body alignment
174fe69 üîß Fix: Prevent header/body column misalignment with scrollbar-gutter
```

### üß™ BUILD STATUS

‚úÖ All builds successful:
- **TypeScript**: 0 errors
- **Vite bundle**: 264.77 kB JS (gzip: 84.91 kB)
- **CSS**: 35.54 kB (gzip: 6.32 kB)

### üìÅ –ò–ó–ú–ï–ù–Å–ù–ù–´–ï –§–ê–ô–õ–´

1. **frontend/src/components/PositionsTable.tsx** (lines 209-259)
   - –û–±—ë—Ä–Ω—É—Ç–∞ header –∏ body —Ç–∞–±–ª–∏—Ü—ã –≤ `.table-wrapper-unified` div
   - –î–æ–±–∞–≤–ª–µ–Ω—ã –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –æ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ

2. **frontend/src/styles/components.css** (lines 799-898)
   - –î–æ–±–∞–≤–ª–µ–Ω—ã –Ω–æ–≤—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è `.table-wrapper-unified` (33 lines)
   - –û–±–Ω–æ–≤–ª–µ–Ω—ã —Å—Ç–∏–ª–∏ –¥–ª—è header –∏ body —Ç–∞–±–ª–∏—Ü
   - –î–æ–±–∞–≤–ª–µ–Ω–æ `min-width: 1240px` –Ω–∞ `.positions-table`
   - –û—á–∏—â–µ–Ω—ã –¥—É–±–ª–∏—Ä—É—é—â–∏–µ—Å—è –ø—Ä–∞–≤–∏–ª–∞

### üéØ –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò

1. **–í–∏–∑—É–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** –Ω–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è—Ö:
   - –ú–æ–±–∏–ª—å–Ω—ã–µ (320-480px)
   - –ü–ª–∞–Ω—à–µ—Ç—ã (768px)
   - –î–µ—Å–∫—Ç–æ–ø—ã (1920px+)

2. **Cross-browser —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**:
   - Chrome/Edge (overlay scrollbars)
   - Firefox (overlay scrollbars)
   - Safari (overlay scrollbars)
   - Windows browsers: –ø—Ä–æ–≤–µ—Ä–∏—Ç—å non-overlay scrollbars

3. **Performance –ø—Ä–æ–≤–µ—Ä–∫–∞**: –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ flexbox layout –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç excessive reflow'–æ–≤ –ø—Ä–∏ —Å–∫—Ä–æ–ª–ª–µ

4. **Accessibility –ø—Ä–æ–≤–µ—Ä–∫–∞**: –ù–∞–≤–∏–≥–∞—Ü–∏—è —Å –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã —á–µ—Ä–µ–∑ —Ç–∞–±–ª–∏—Ü—É –¥–æ–ª–∂–Ω–∞ —Ä–∞–±–æ—Ç–∞—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

---

## üîß –¢–ï–ö–£–©–ê–Ø –°–ï–°–°–ò–Ø: Excel Upload - –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (EXCEL-REAL-DATA-001)

**–î–∞—Ç–∞:** 10.11.2025
**–í–µ—Ä—Å–∏—è:** v4.12.0
**Branch:** `claude/read-claude-md-011CUyyKhZE8qTCLoruuUdNa`

### üìã –ü–†–û–ë–õ–ï–ú–ê

–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –≤ Excel upload —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–µ:
- ‚úÖ **–ü–∞—Ä—Å–µ—Ä —Ä–∞–±–æ—Ç–∞–ª –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ** - —É—Å–ø–µ—à–Ω–æ –∏–∑–≤–ª–µ–∫–∞–ª –¥–∞–Ω–Ω—ã–µ –∏–∑ Excel —Ñ–∞–π–ª–æ–≤
- ‚úÖ `parseResult.raw_rows` —Å–æ–¥–µ—Ä–∂–∞–ª –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ Excel (–Ω–∞–∑–≤–∞–Ω–∏—è, OTSKP –∫–æ–¥—ã, –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞)
- ‚ùå **–î–∞–Ω–Ω—ã–µ –ù–ï –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å** - –≤–º–µ—Å—Ç–æ –Ω–∏—Ö –≤—Å—Ç–∞–≤–ª—è–ª–∏—Å—å —Ö–∞—Ä–¥–∫–æ–∂–µ–Ω–Ω—ã–µ —à–∞–±–ª–æ–Ω—ã
- ‚ùå OTSKP –∫–æ–¥—ã –∏–∑ Excel –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–ª–∏—Å—å (`otskp_code = null`)
- ‚ùå –ö–æ–ª–∏—á–µ—Å—Ç–≤–∞ –≤—Å–µ–≥–¥–∞ –±—ã–ª–∏ –Ω—É–ª–µ–≤—ã–º–∏ (`qty = 0`)
- ‚ùå –ù–∞–∑–≤–∞–Ω–∏—è —á–∞—Å—Ç–µ–π –±—ã–ª–∏ —à–∞–±–ª–æ–Ω–Ω—ã–º–∏, –Ω–µ –∏–∑ Excel

**–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–æ–±—â–∏–ª:**
> –ù–ï –ò–©–ï–¢ –ö–û–î –û–¢–°–ö–ü –ò –°–û–û–¢–í–ï–¢–°–¢–í–ï–ù–ù–û –ù–ï –ó–ê–ü–û–õ–ù–Ø–ï–¢ –ù–ê–ó–í–ê–ù–ò–ï
> –ü–†–û–í–ï–†–¨ –ü–û–õ–ù–û–°–¢–¨–Æ –ö–û–î –ò –õ–û–ì–ò–ö–£, –ü–û –ú–û–ï–ú–£ –ü–ê–†–°–ò–õ –•–û–†–û–®–û –ò –ö–û–î –ò –ù–ê–ó–í–ê–ù–ò–Ø –ü–†–û–°–¢–û –ù–ï –ó–ê–î–ê–ù–ò–Ø –í –ö–û–î–ï –î–õ–Ø –ù–ê–ü–û–õ–ù–ï–ù–ò–Ø –¢–ê–ë–õ–ò–¶–´

### üõ†Ô∏è –†–ï–®–ï–ù–ò–ï

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `convertRawRowsToPositions()` –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏–∑ Excel –≤–º–µ—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —à–∞–±–ª–æ–Ω–æ–≤.

#### 1Ô∏è‚É£ –§—É–Ω–∫—Ü–∏—è `convertRawRowsToPositions()` (backend/src/routes/upload.js:48-190)

**–†–∞–±–æ—Ç–∞ –≤ –¥–≤–∞ —ç—Ç–∞–ø–∞:**

**–≠—Ç–∞–ø 1: –ü–æ–∏—Å–∫ —Å—Ç—Ä–æ–∫ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –º–æ—Å—Ç–∞ (lines 54-87)**
```javascript
// –ù–∞—Ö–æ–¥–∏—Ç –≤—Å–µ —Å—Ç—Ä–æ–∫–∏, –æ—Ç–Ω–æ—Å—è—â–∏–µ—Å—è –∫ bridge_id
// - –ò—â–µ—Ç SO –∫–æ–¥ –≤ –ª—é–±–æ–π –∫–æ–ª–æ–Ω–∫–µ
// - –°–æ–±–∏—Ä–∞–µ—Ç —Å—Ç—Ä–æ–∫–∏ –¥–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ SO –∫–æ–¥–∞
// - –ü—Ä–æ–ø—É—Å–∫–∞–µ—Ç –ø—É—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏
```

**–≠—Ç–∞–ø 2: –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–π –∏–∑ —Å–æ–±—Ä–∞–Ω–Ω—ã—Ö —Å—Ç—Ä–æ–∫ (lines 92-187)**
```javascript
// –î–ª—è –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–∏:
// 1. –ò–∑–≤–ª–µ–∫–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ –∫–æ–ª–æ–Ω–æ–∫ (smart column matching)
// 2. –§–∏–ª—å—Ç—Ä—É–µ—Ç —Ç–æ–ª—å–∫–æ –±–µ—Ç–æ–Ω–Ω—ã–µ —Ä–∞–±–æ—Ç—ã
// 3. –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç subtype (beton/bednƒõn√≠/v√Ωztu≈æ)
// 4. –ò–∑–≤–ª–µ–∫–∞–µ—Ç OTSKP –∫–æ–¥ (5-6 —Ü–∏—Ñ—Ä)
// 5. –ü–∞—Ä—Å–∏—Ç —á–∏—Å–ª–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è (qty, crew_size, wage, hours, days)
// 6. –°–æ–∑–¥–∞—ë—Ç position object
```

#### 2Ô∏è‚É£ –£–º–Ω–æ–µ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –∫–æ–ª–æ–Ω–æ–∫ - `findColumnValue()` (lines 195-211)

–ü—Ä–æ–±—É–µ—Ç –Ω–∞–π—Ç–∏ –¥–∞–Ω–Ω—ã–µ –ø–æ **–º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–º –≤–æ–∑–º–æ–∂–Ω—ã–º –Ω–∞–∑–≤–∞–Ω–∏—è–º –∫–æ–ª–æ–Ω–æ–∫**:

| –ü–æ–ª–µ | –í–æ–∑–º–æ–∂–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è –∫–æ–ª–æ–Ω–æ–∫ |
|------|---------------------------|
| part_name | "N√°zev ƒç√°sti konstrukce", "Part", "ƒå√°st", "Element" |
| item_name | "N√°zev polo≈æky", "Nazev polozky", "Item", "Polo≈æka", "Popis" |
| subtype | "Podtyp", "Typ pr√°ce", "Subtype", "Type" |
| unit | "MJ", "Jednotka", "Unit" |
| qty | "Mno≈æstv√≠", "Mnozstvi", "Quantity", "Qty" |
| otskp_code | "OTSKP", "K√≥d", "Code" |
| crew_size | "lidi", "Lidi", "Crew", "Poƒçet lid√≠" |
| wage_czk_ph | "Kƒç/hod", "Kc/hod", "Wage" |
| shift_hours | "Hod/den", "Hours", "Shift" |
| days | "den (koef 1)", "den", "Days", "Dny" |

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- Case-insensitive –ø–æ–∏—Å–∫ –ø–æ –ø–æ–¥—Å—Ç—Ä–æ–∫–µ –≤ –Ω–∞–∑–≤–∞–Ω–∏–∏ –∫–æ–ª–æ–Ω–∫–∏
- –ü—Ä–æ–±—É–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—è
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç `null` –µ—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ

#### 3Ô∏è‚É£ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ç–æ–ª—å–∫–æ –±–µ—Ç–æ–Ω–Ω—ã—Ö —Ä–∞–±–æ—Ç (lines 112-127)

```javascript
const isConcrete = fullText.includes('beton') ||
                  fullText.includes('bet√≥n') ||
                  fullText.includes('bednƒõn√≠') ||
                  fullText.includes('v√Ωztu≈æ') ||
                  fullText.includes('z√°klady') ||
                  fullText.includes('≈ô√≠msy') ||
                  fullText.includes('opƒõr') ||
                  fullText.includes('pil√≠≈ô') ||
                  fullText.includes('nosn') ||
                  fullText.includes('most') ||
                  fullText.includes('desk');
```

**–ü—Ä–æ–ø—É—Å–∫–∞—é—Ç—Å—è:**
- –ó–µ–º–ª—è–Ω—ã–µ —Ä–∞–±–æ—Ç—ã
- –î–æ—Ä–æ–∂–Ω—ã–µ —Ä–∞–±–æ—Ç—ã
- –ò–∑–æ–ª—è—Ü–∏—è
- –ì–∏–¥—Ä–æ–∏–∑–æ–ª—è—Ü–∏—è (–µ—Å–ª–∏ –Ω–µ –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ –±–µ—Ç–æ–Ω—É)

#### 4Ô∏è‚É£ –£–º–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ–¥—Ç–∏–ø–∞ (lines 129-150)

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1:** –ò–∑ –∫–æ–ª–æ–Ω–∫–∏ "Podtyp"
```javascript
if (subtypeLower.includes('bedn')) ‚Üí subtype = 'bednƒõn√≠'
if (subtypeLower.includes('v√Ωztu≈æ') || includes('ocel')) ‚Üí subtype = 'v√Ωztu≈æ'
if (subtypeLower.includes('oboustran')) ‚Üí subtype = 'oboustrann√©'
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2:** –ò–∑ –µ–¥–∏–Ω–∏—Ü—ã –∏–∑–º–µ—Ä–µ–Ω–∏—è
```javascript
if (unit === 'M3' || unit === 'm3') ‚Üí subtype = 'beton'
if (unit === 'm2' || unit === 'm¬≤') ‚Üí subtype = 'bednƒõn√≠'
if (unit === 't' || unit === 'kg') ‚Üí subtype = 'v√Ωztu≈æ'
```

**Default:** `'beton'`

#### 5Ô∏è‚É£ –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ OTSKP –∫–æ–¥–æ–≤ (lines 152-159)

```javascript
// –ò—â–µ—Ç 5-6 —Ü–∏—Ñ—Ä –≤ –∫–æ–ª–æ–Ω–∫–µ "OTSKP" –∏–ª–∏ "K√≥d"
const otskpMatch = String(otskpRaw).match(/\d{5,6}/);
if (otskpMatch) {
  otskpCode = otskpMatch[0]; // –¢–æ–ª—å–∫–æ —Ü–∏—Ñ—Ä—ã, –±–µ–∑ –±—É–∫–≤
}
```

**–ü—Ä–∏–º–µ—Ä—ã —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è:**
- `"63421"` ‚Üí `"63421"` ‚úÖ
- `"OTSKP 634215"` ‚Üí `"634215"` ‚úÖ
- `"63.42.1"` ‚Üí `"63421"` (–µ—Å–ª–∏ regex —Ä–∞—Å—à–∏—Ä–∏—Ç—å)

#### 6Ô∏è‚É£ Fallback –Ω–∞ —à–∞–±–ª–æ–Ω—ã (lines 145-148 –≤ upload handler)

```javascript
// –ï—Å–ª–∏ –∏–∑ Excel –Ω–∏—á–µ–≥–æ –Ω–µ –∏–∑–≤–ª–µ—á–µ–Ω–æ
if (extractedPositions.length === 0) {
  logger.warn(`No positions extracted from Excel for ${bridge.bridge_id}, using templates`);
  positionsToInsert = templatePositions; // 22 —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏–∏
}
```

**–ü—Ä–∏—á–∏–Ω—ã fallback:**
- SO –∫–æ–¥ –Ω–∞–π–¥–µ–Ω, –Ω–æ —Å—Ç—Ä–æ–∫–∏ –ø–æ—Å–ª–µ –Ω–µ–≥–æ –ø—É—Å—Ç—ã–µ
- –ù–µ—Ç –∫–æ–ª–æ–Ω–æ–∫ —Å –Ω–∞–∑–≤–∞–Ω–∏—è–º–∏ —á–∞—Å—Ç–µ–π
- –§–∏–ª—å—Ç—Ä –æ—Ç—Å–µ–∫ –≤—Å–µ —Å—Ç—Ä–æ–∫–∏ (–Ω–µ—Ç –±–µ—Ç–æ–Ω–Ω—ã—Ö —Ä–∞–±–æ—Ç)

#### 7Ô∏è‚É£ –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

**–£—Ä–æ–≤–µ–Ω—å 1: –ü–æ–∏—Å–∫ —Å—Ç—Ä–æ–∫**
```
[INFO] Found 45 rows for bridge SO 204
```

**–£—Ä–æ–≤–µ–Ω—å 2: –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–π**
```
[INFO] Extracted position: Z√ÅKLADY - beton (12.5 M3, OTSKP: 63421)
[INFO] Extracted position: Z√ÅKLADY - bednƒõn√≠ (85.3 m2, OTSKP: 63422)
```

**–£—Ä–æ–≤–µ–Ω—å 3: –ò—Ç–æ–≥–æ–≤–æ–µ —Ä–µ–∑—é–º–µ**
```
[INFO] Created 18 positions for bridge SO 204 (18 from Excel, 0 from templates)
```

### üìä API RESPONSE - –ù–û–í–ê–Ø –°–¢–†–£–ö–¢–£–†–ê

**–î–æ:**
```json
{
  "message": "Created 3 bridges with 66 template positions from Excel file",
  "bridges": [
    {
      "bridge_id": "SO 204",
      "positions_created": 22
    }
  ]
}
```

**–ü–æ—Å–ª–µ:**
```json
{
  "message": "Created 3 bridges with 54 positions (48 from Excel, 6 from templates)",
  "bridges": [
    {
      "bridge_id": "SO 204",
      "positions_created": 18,
      "positions_from_excel": 18  // ‚úÖ –ù–û–í–û–ï –ü–û–õ–ï!
    },
    {
      "bridge_id": "SO 205",
      "positions_created": 30,
      "positions_from_excel": 30
    },
    {
      "bridge_id": "SO 206",
      "positions_created": 6,
      "positions_from_excel": 0,  // Fallback –Ω–∞ templates
      "note": "Used templates - no concrete data in Excel"
    }
  ]
}
```

### ‚úÖ –†–ï–ó–£–õ–¨–¢–ê–¢–´ –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø

| –ü—Ä–æ–±–ª–µ–º–∞ | –†–µ—à–µ–Ω–∏–µ | –°—Ç–∞—Ç—É—Å |
|----------|---------|--------|
| OTSKP –∫–æ–¥—ã –Ω–µ –∏–∑–≤–ª–µ–∫–∞–ª–∏—Å—å | Regex match `/\d{5,6}/` + smart column finding | ‚úÖ |
| –ù–∞–∑–≤–∞–Ω–∏—è —á–∞—Å—Ç–µ–π –±—ã–ª–∏ —à–∞–±–ª–æ–Ω–Ω—ã–º–∏ | –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∏–∑ –∫–æ–ª–æ–Ω–æ–∫ "N√°zev ƒç√°sti konstrukce" | ‚úÖ |
| –ö–æ–ª–∏—á–µ—Å—Ç–≤–∞ –≤—Å–µ–≥–¥–∞ –Ω—É–ª–µ–≤—ã–µ | `parseNumber()` –∏–∑ –∫–æ–ª–æ–Ω–∫–∏ "Mno≈æstv√≠" | ‚úÖ |
| Crew size / wage / hours –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é | –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∏–∑ Excel —Å fallback –Ω–∞ defaults | ‚úÖ |
| –ù–µ —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–ª–∏—Å—å –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ | –§–∏–ª—å—Ç—Ä –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º (beton, bednƒõn√≠...) | ‚úÖ |
| raw_rows –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å | `convertRawRowsToPositions(raw_rows, bridge_id)` | ‚úÖ |
| –ù–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∏—Å—Ç–æ—á–Ω–∏–∫–µ –¥–∞–Ω–Ω—ã—Ö | –ù–æ–≤–æ–µ –ø–æ–ª–µ `positions_from_excel` –≤ response | ‚úÖ |

### üìù –ö–û–ú–ú–ò–¢–´ –°–ï–°–°–ò–ò

```
936ff68 üêõ P1 Fix: Prevent SO code prefix collision in Excel import
f668354 üìù Update CLAUDE.MD with Excel real data extraction session
f1bdf2c ‚ú® Use real Excel data instead of templates for positions
```

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- **f1bdf2c**: +198 —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞ (2 –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–∏ convertRawRowsToPositions + findColumnValue), -16 —Å—Ç—Ä–æ–∫ (—É–¥–∞–ª—ë–Ω template loop), –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω parseNumber
- **f668354**: +302 —Å—Ç—Ä–æ–∫–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –≤ CLAUDE.MD
- **936ff68**: +18 —Å—Ç—Ä–æ–∫, -5 —Å—Ç—Ä–æ–∫ (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω P1 –±–∞–≥ —Å prefix collision), –¥–æ–±–∞–≤–ª–µ–Ω–∞ normalizeBridgeCode()

### üß™ BUILD STATUS

‚úÖ All builds successful:
- **Node module check**: 0 errors
- **Import test**: Module loaded successfully
- **Backend startup**: OK

### üìÅ –ò–ó–ú–ï–ù–Å–ù–ù–´–ï –§–ê–ô–õ–´

**backend/src/routes/upload.js** (lines 10, 48-211, 307-337)

**–î–æ–±–∞–≤–ª–µ–Ω–æ:**
1. **Import parseNumber** (line 10)
   ```javascript
   import { parseXLSX, parseNumber } from '../services/parser.js';
   ```

2. **–§—É–Ω–∫—Ü–∏—è convertRawRowsToPositions()** (lines 48-190, +143 lines)
   - –ü–æ–∏—Å–∫ —Å—Ç—Ä–æ–∫ –¥–ª—è –º–æ—Å—Ç–∞ –ø–æ SO –∫–æ–¥—É
   - –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ –∫–æ–ª–æ–Ω–æ–∫
   - –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –±–µ—Ç–æ–Ω–Ω—ã—Ö —Ä–∞–±–æ—Ç
   - –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ subtype
   - –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ OTSKP –∫–æ–¥–æ–≤
   - –ü–∞—Ä—Å–∏–Ω–≥ —á–∏—Å–ª–æ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π

3. **–§—É–Ω–∫—Ü–∏—è findColumnValue()** (lines 195-211, +17 lines)
   - Case-insensitive –ø–æ–∏—Å–∫ –∫–æ–ª–æ–Ω–æ–∫
   - –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –Ω–∞–∑–≤–∞–Ω–∏–π

4. **–û–±–Ω–æ–≤–ª—ë–Ω upload handler** (lines 307-337, modified 31 lines)
   - –í—ã–∑–æ–≤ `convertRawRowsToPositions()`
   - Fallback –Ω–∞ templates
   - –ù–æ–≤–æ–µ –ø–æ–ª–µ `positions_from_excel`
   - –£–ª—É—á—à–µ–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

**–£–¥–∞–ª–µ–Ω–æ:**
- Hardcoded loop —á–µ—Ä–µ–∑ `templatePositions.forEach()` (16 lines)

### üéØ –ü–†–ï–ò–ú–£–©–ï–°–¢–í–ê –†–ï–®–ï–ù–ò–Ø

**–î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:**
‚úÖ –†–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ Excel –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–º–ø–æ—Ä—Ç–∏—Ä—É—é—Ç—Å—è
‚úÖ OTSKP –∫–æ–¥—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –∏ –¥–æ—Å—Ç—É–ø–Ω—ã –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
‚úÖ –ö–æ–ª–∏—á–µ—Å—Ç–≤–∞, —Å—Ç–∞–≤–∫–∏, —á–∞—Å—ã –±–µ—Ä—É—Ç—Å—è –∏–∑ Excel
‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ç–æ–ª—å–∫–æ –±–µ—Ç–æ–Ω–Ω—ã—Ö —Ä–∞–±–æ—Ç
‚úÖ –ü–æ–Ω—è—Ç–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ —Ç–æ–º, —Å–∫–æ–ª—å–∫–æ –¥–∞–Ω–Ω—ã—Ö –∏–∑ Excel vs templates

**–î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞:**
‚úÖ –ì–∏–±–∫–æ–µ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –∫–æ–ª–æ–Ω–æ–∫ (–Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ç–æ—á–Ω—ã—Ö –Ω–∞–∑–≤–∞–Ω–∏–π)
‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞–∂–¥–æ–≥–æ —à–∞–≥–∞ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
‚úÖ Graceful fallback –Ω–∞ —à–∞–±–ª–æ–Ω—ã
‚úÖ –õ–µ–≥–∫–æ —Ä–∞—Å—à–∏—Ä–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤ –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏

**–î–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å concrete-agent AI:**
‚úÖ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –≥–æ—Ç–æ–≤–∞ –¥–ª—è AI-–ø–∞—Ä—Å–∏–Ω–≥–∞ (GPT-4 Vision, Claude)
‚úÖ –§—É–Ω–∫—Ü–∏—è –ª–µ–≥–∫–æ –∑–∞–º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ AI-extraction –≤ –±—É–¥—É—â–µ–º
‚úÖ –í—Å–µ –¥–∞–Ω–Ω—ã–µ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –¥–ª—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ –º–æ–¥–µ–ª–µ–π

### üêõ P1 –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –ë–ê–ì - –ò–°–ü–†–ê–í–õ–ï–ù–û (commit `936ff68`)

**–ü—Ä–æ–±–ª–µ–º–∞ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞:** chatgpt-codex-connector bot

**–û–ø–∏—Å–∞–Ω–∏–µ:**
- SO –∫–æ–¥ —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º (–Ω–∞–ø—Ä–∏–º–µ—Ä SO 20) –∑–∞—Ö–≤–∞—Ç—ã–≤–∞–ª —Å—Ç—Ä–æ–∫–∏ –¥—Ä—É–≥–∏—Ö –º–æ—Å—Ç–æ–≤ (SO 200, SO 201, SO 202...)
- –ü—Ä–∏—á–∏–Ω–∞: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è `.includes()` –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –∫–æ–¥–æ–≤ (substring match)
- –ü—Ä–∏–º–µ—Ä: `"SO 200".includes("SO 20")` = `true` ‚ùå
- –†–µ–∑—É–ª—å—Ç–∞—Ç: –ü–æ–∑–∏—Ü–∏–∏ –æ—Ç SO 200+ –æ—à–∏–±–æ—á–Ω–æ –¥–æ–±–∞–≤–ª—è–ª–∏—Å—å –≤ SO 20

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (backend/src/routes/upload.js:47-87):**

1. **–î–æ–±–∞–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ –∫–æ–¥–æ–≤ (line 47):**
```javascript
function normalizeBridgeCode(code) {
  return code.trim().replace(/\s+/g, ' ').toUpperCase();
}
```

2. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞—á–∞–ª–∞ –º–æ—Å—Ç–∞ (line 68):**
```javascript
// –ë–´–õ–û:
if (rowText.includes(bridgeId.toUpperCase())) {

// –°–¢–ê–õ–û:
const soMatch = rowText.match(/SO\s*\d+/i);
if (soMatch && normalizeBridgeCode(soMatch[0]) === normalizedBridgeId) {
```

3. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–ª–µ–¥—É—é—â–µ–≥–æ –º–æ—Å—Ç–∞ (line 83):**
```javascript
// –ë–´–õ–û:
return match && !match[0].toUpperCase().includes(bridgeId.toUpperCase());

// –°–¢–ê–õ–û:
const foundSO = normalizeBridgeCode(match[0]);
return foundSO !== normalizedBridgeId; // –¢–æ—á–Ω–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ!
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:**
- ‚úÖ SO 20 —Ç–µ–ø–µ—Ä—å —Å–æ–±–∏—Ä–∞–µ—Ç –¢–û–õ–¨–ö–û —Å—Ç—Ä–æ–∫–∏ –¥–ª—è SO 20
- ‚úÖ SO 200 —Ç–µ–ø–µ—Ä—å —Å–æ–±–∏—Ä–∞–µ—Ç –¢–û–õ–¨–ö–û —Å—Ç—Ä–æ–∫–∏ –¥–ª—è SO 200
- ‚úÖ –ù–µ—Ç —Å–º–µ—à–∏–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É –º–æ—Å—Ç–∞–º–∏ —Å –ø—Ä–µ—Ñ–∏–∫—Å–Ω—ã–º–∏ ID
- ‚úÖ –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ä–∞–∑–ª–∏—á–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –ø—Ä–æ–±–µ–ª–æ–≤: "SO200", "SO 200", "SO  200"

**–§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã:**
- backend/src/routes/upload.js (+18 lines, -5 lines)

**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
- ‚úÖ –°–∏–Ω—Ç–∞–∫—Å–∏—Å: OK
- ‚úÖ –ò–º–ø–æ—Ä—Ç –º–æ–¥—É–ª—è: OK
- ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç—Å—è: –¢–µ—Å—Ç –Ω–∞ —Ä–µ–∞–ª—å–Ω–æ–º Excel —Å SO 20 –∏ SO 200

---

### üîÆ –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò

#### 1Ô∏è‚É£ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ Excel —Ñ–∞–π–ª–∞–º–∏
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ —Ç–∏–ø–∏—á–Ω—ã—Ö —á–µ—à—Å–∫–∏—Ö Excel —Ñ–∞–π–ª–∞—Ö —Å –≤–µ–¥–æ–º–æ—Å—Ç—è–º–∏ —Ä–∞–±–æ—Ç
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤ OTSKP –∫–æ–¥–æ–≤
- [ ] –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –Ω–µ –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç –≤–∞–∂–Ω—ã–µ –ø–æ–∑–∏—Ü–∏–∏

#### 2Ô∏è‚É£ –£–ª—É—á—à–µ–Ω–∏–µ –ø–∞—Ä—Å–∏–Ω–≥–∞ OTSKP –∫–æ–¥–æ–≤
- [ ] –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–¥–æ–≤ —Å —Ç–æ—á–∫–∞–º–∏: `"63.42.1"` ‚Üí `"634210"`
- [ ] –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–¥–æ–≤ —Å –ø—Ä–µ—Ñ–∏–∫—Å–∞–º–∏: `"JKSO 63421"` ‚Üí `"63421"`
- [ ] –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–¥–æ–≤ –ø—Ä–æ—Ç–∏–≤ –±–∞–∑—ã OTSKP (17,904 –∑–∞–ø–∏—Å–µ–π)

#### 3Ô∏è‚É£ Sidebar —Å –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–æ–π –ø–æ –ø—Ä–æ–µ–∫—Ç–∞–º
- [ ] –î–æ–±–∞–≤–∏—Ç—å –¥—Ä–µ–≤–æ–≤–∏–¥–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É: Project ‚Üí Bridges
- [ ] –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–æ—Å—Ç–æ–≤ –≤ –∫–∞–∂–¥–æ–º –ø—Ä–æ–µ–∫—Ç–µ
- [ ] –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å–≤–µ—Ä–Ω—É—Ç—å/—Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å –ø—Ä–æ–µ–∫—Ç—ã

#### 4Ô∏è‚É£ AI Integration (concrete-agent)
- [ ] –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å GPT-4 Vision –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ —Å–∫–∞–Ω–æ–≤
- [ ] –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –Ω–∞ —á–µ—à—Å–∫–æ–π —Å—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω–æ–π —Ç–µ—Ä–º–∏–Ω–æ–ª–æ–≥–∏–∏
- [ ] API endpoint –¥–ª—è AI-parsed data

---

**üèóÔ∏è Made for bridge builders in Czech Republic**

**‚ö° –í–ê–ñ–ù–û: –ü—Ä–∏ –ª—é–±—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö –ø—Ä–æ–µ–∫—Ç–∞ ‚Äî –û–ë–ù–û–í–õ–Ø–ô –≠–¢–û–¢ –§–ê–ô–õ!**

---

## üìä –ú–ï–¢–ê–î–ê–ù–ù–´–ï –§–ê–ô–õ–ê

**–†–∞–∑–º–µ—Ä:** 115+ KB
**–°—Ç—Ä–æ–∫:** 2460+
**–°–ª–æ–≤:** 7400+

‚ö†Ô∏è **–í–ù–ò–ú–ê–ù–ò–ï:** –§–∞–π–ª —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –±–æ–ª—å—à–∏–º (>2400 —Å—Ç—Ä–æ–∫). –í –±—É–¥—É—â–µ–º —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:

1. **–°–æ–∑–¥–∞—Ç—å SESSIONS_HISTORY.md** - –ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å —Ç—É–¥–∞ –≤—Å–µ –ø—Ä–æ—à–ª—ã–µ —Å–µ—Å—Å–∏–∏ (—Å—Ç—Ä–æ–∫–∏ 1002-2100)
2. **–°–æ–∑–¥–∞—Ç—å ARCHITECTURE.md** - –ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –¥–µ—Ç–∞–ª–∏, —Ñ–æ—Ä–º—É–ª—ã, —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö
3. **–û—Å—Ç–∞–≤–∏—Ç—å –≤ CLAUDE.MD** —Ç–æ–ª—å–∫–æ:
   - –¢–µ–∫—É—â–∞—è —Å–µ—Å—Å–∏—è (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 300-500 —Å—Ç—Ä–æ–∫)
   - –û—Å–Ω–æ–≤–Ω–æ–π –æ–±–∑–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞ (100-200 —Å—Ç—Ä–æ–∫)
   - Roadmap –∏ —Å–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ (50-100 —Å—Ç—Ä–æ–∫)

**–¶–µ–ª—å:** –î–µ—Ä–∂–∞—Ç—å CLAUDE.MD –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö 500-800 —Å—Ç—Ä–æ–∫ –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –Ω–∞–≤–∏–≥–∞—Ü–∏–∏.

–¢–µ–∫—É—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ –ø—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–π –±–æ–ª—å—à–æ–π —Å–µ—Å—Å–∏–∏ —Å—Ç–æ–∏—Ç –ø—Ä–æ–≤–µ—Å—Ç–∏ —Ä–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–∏–∑–∞—Ü–∏—é.

---

## üîê –°–ï–°–°–ò–Ø 2025-11-13: PostgreSQL + Multi-user Authentication

### üìã –ß–¢–û –°–î–ï–õ–ê–ù–û

#### 1. PostgreSQL –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –¥–ª—è –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–∞ Render
**–ü—Ä–æ–±–ª–µ–º–∞:** SQLite —Ç–µ—Ä—è–ª –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏ –∫–∞–∂–¥–æ–º —Ä–µ—Å—Ç–∞—Ä—Ç–µ –Ω–∞ Render (—ç—Ñ–µ–º–µ—Ä–Ω–∞—è FS)

**–†–µ—à–µ–Ω–∏–µ:**
- –î–æ–±–∞–≤–ª–µ–Ω PostgreSQL –≤ `render.yaml` (–±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –ø–ª–∞–Ω 500MB)
- –°–æ–∑–¥–∞–Ω —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –∞–¥–∞–ø—Ç–µ—Ä: SQLite (dev) / PostgreSQL (prod)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä –ë–î –ø–æ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è `DATABASE_URL`

**–§–∞–π–ª—ã:**
- `backend/src/db/postgres.js` - PostgreSQL adapter —Å prepare/exec/transaction
- `backend/src/db/index.js` - Unified database interface
- `backend/src/db/migrations.js` - –ú–∏–≥—Ä–∞—Ü–∏–∏ –¥–ª—è –æ–±–µ–∏—Ö –ë–î
- `backend/src/db/schema-postgres.sql` - PostgreSQL schema (users, bridges, positions, snapshots)
- `render.yaml` - –î–æ–±–∞–≤–ª–µ–Ω database service

#### 2. Multi-user Authentication —Å–∏—Å—Ç–µ–º–∞
**–ü—Ä–æ–±–ª–µ–º–∞:** –í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Ä–∞–±–æ—Ç–∞–ª–∏ —Å –æ–±—â–µ–π –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö

**–†–µ—à–µ–Ω–∏–µ:**
- –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω `bcrypt` –¥–ª—è —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è –ø–∞—Ä–æ–ª–µ–π
- –¢–∞–±–ª–∏—Ü–∞ `users` (id, email, password_hash, name, role)
- JWT —Ç–æ–∫–µ–Ω—ã (24 —á–∞—Å–∞) —á–µ—Ä–µ–∑ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π middleware
- –†–æ—É—Ç—ã `/api/auth`: register, login, me, logout
- –ü–æ–ª–µ `owner_id` –≤ —Ç–∞–±–ª–∏—Ü–µ `bridges` –¥–ª—è –∏–∑–æ–ª—è—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö

**–§–∞–π–ª—ã:**
- `backend/src/routes/auth.js` - –†–æ—É—Ç—ã —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∏ –≤—Ö–æ–¥–∞
- `backend/src/routes/bridges.js` - –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ owner_id
- `backend/package.json` - –î–æ–±–∞–≤–ª–µ–Ω bcrypt

#### 3. Frontend - Login/Register UI + Protected Routes
**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ –±—ã–ª–æ UI –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

**–†–µ—à–µ–Ω–∏–µ:**
- –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω `react-router-dom` –¥–ª—è —Ä–æ—É—Ç–∏–Ω–≥–∞
- –ö—Ä–∞—Å–∏–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ Login/Register —Å –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–º —Ñ–æ–Ω–æ–º
- AuthContext –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- ProtectedRoute –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è –∑–∞—â–∏—Ç—ã –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- JWT token –≤ axios interceptors
- 401 ‚Üí redirect –Ω–∞ /login
- –ö–Ω–æ–ø–∫–∞ "Odhl√°sit" –≤ Header —Å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**–ù–æ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**
```
frontend/src/
‚îú‚îÄ‚îÄ context/
‚îÇ   ‚îî‚îÄ‚îÄ AuthContext.tsx                 ‚Üê JWT token, login/register/logout
‚îú‚îÄ‚îÄ pages/
‚îÇ   ‚îî‚îÄ‚îÄ LoginPage.tsx                   ‚Üê –§–æ—Ä–º–∞ –ª–æ–≥–∏–Ω–∞/—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îú‚îÄ‚îÄ MainApp.tsx                     ‚Üê –û—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (moved from App.tsx)
‚îÇ   ‚îú‚îÄ‚îÄ ProtectedRoute.tsx              ‚Üê HOC –¥–ª—è –∑–∞—â–∏—Ç—ã –º–∞—Ä—à—Ä—É—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ Header.tsx                      ‚Üê –î–æ–±–∞–≤–ª–µ–Ω–∞ –∫–Ω–æ–ø–∫–∞ "Odhl√°sit" + –∏–º—è —é–∑–µ—Ä–∞
‚îÇ   ‚îú‚îÄ‚îÄ PartHeader.tsx
‚îÇ   ‚îú‚îÄ‚îÄ PositionsTable.tsx
‚îÇ   ‚îú‚îÄ‚îÄ PositionRow.tsx
‚îÇ   ‚îú‚îÄ‚îÄ KPIPanel.tsx
‚îÇ   ‚îú‚îÄ‚îÄ Sidebar.tsx
‚îÇ   ‚îú‚îÄ‚îÄ CreateBridgeForm.tsx
‚îÇ   ‚îú‚îÄ‚îÄ EditBridgeForm.tsx
‚îÇ   ‚îú‚îÄ‚îÄ HistoryModal.tsx
‚îÇ   ‚îú‚îÄ‚îÄ DeleteBridgeModal.tsx
‚îÇ   ‚îî‚îÄ‚îÄ ExportHistory.tsx
```

**–û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ App:**
```typescript
// frontend/src/App.tsx
<QueryClientProvider>
  <AuthProvider>
    <BrowserRouter>
      <Routes>
        <Route path="/login" element={<LoginPage />} />
        <Route path="/" element={
          <ProtectedRoute>
            <AppProvider>
              <MainApp />
            </AppProvider>
          </ProtectedRoute>
        } />
      </Routes>
    </BrowserRouter>
  </AuthProvider>
</QueryClientProvider>
```

**–§–∞–π–ª—ã:**
- `frontend/src/App.tsx` - Routing setup
- `frontend/src/context/AuthContext.tsx` - Auth state management
- `frontend/src/pages/LoginPage.tsx` - Login/Register form
- `frontend/src/components/MainApp.tsx` - Main app content
- `frontend/src/components/ProtectedRoute.tsx` - Route protection
- `frontend/src/services/api.ts` - JWT –≤ headers + 401 redirect
- `frontend/package.json` - –î–æ–±–∞–≤–ª–µ–Ω react-router-dom

#### 4. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è P1 –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –±–∞–≥–æ–≤ (Codex Review)
**–ü—Ä–æ–±–ª–µ–º–∞ 1:** `initDatabase()` –≤—ã–∑—ã–≤–∞–ª—Å—è –±–µ–∑ `await`
- –°–µ—Ä–≤–µ—Ä –º–æ–≥ –∑–∞–ø—É—Å—Ç–∏—Ç—å—Å—è –¥–æ —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü PostgreSQL
- **–†–µ—à–µ–Ω–∏–µ:** –û–±–µ—Ä–Ω—É–ª–∏ –≤ `async function bootstrap()`

**–ü—Ä–æ–±–ª–µ–º–∞ 2:** Positions routes –±—ã–ª–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–º–∏
- `db.prepare().all()` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç Promise –¥–ª—è PostgreSQL
- **–†–µ—à–µ–Ω–∏–µ:** –°–¥–µ–ª–∞–ª–∏ –≤—Å–µ routes async/await (GET/POST/PUT/DELETE)

**–ü—Ä–æ–±–ª–µ–º–∞ 3:** Transaction helper –Ω–µ —Ä–∞–±–æ—Ç–∞–ª –¥–ª—è PostgreSQL
- BEGIN/COMMIT –Ω–µ –æ–±–æ—Ä–∞—á–∏–≤–∞–ª–∏ –∑–∞–ø—Ä–æ—Å—ã (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å —Ä–∞–∑–Ω—ã–µ pool connections)
- **–†–µ—à–µ–Ω–∏–µ:** –£–ø—Ä–æ—Å—Ç–∏–ª–∏ –¥–ª—è PostgreSQL (auto-commit), —Å–æ—Ö—Ä–∞–Ω–∏–ª–∏ transactions –¥–ª—è SQLite

**–§–∞–π–ª—ã:**
- `backend/server.js` - Bootstrap function —Å await
- `backend/src/routes/positions.js` - –í—Å–µ routes async/await
- `backend/src/db/index.js` - Simplified transaction –¥–ª—è PostgreSQL

### üì¶ –ù–û–í–´–ï –ó–ê–í–ò–°–ò–ú–û–°–¢–ò

**Backend:**
- `bcrypt` - –•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π (10 salt rounds)
- `pg` - PostgreSQL driver (—É–∂–µ –±—ã–ª —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω —Ä–∞–Ω–µ–µ)

**Frontend:**
- `react-router-dom` - Routing –¥–ª—è /login –∏ /

### üóÑÔ∏è –û–ë–ù–û–í–õ–ï–ù–ù–ê–Ø –°–¢–†–£–ö–¢–£–†–ê –ë–î

```sql
-- –¢–∞–±–ª–∏—Ü–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (NEW)
CREATE TABLE users (
  id SERIAL PRIMARY KEY,
  email VARCHAR(255) UNIQUE NOT NULL,
  password_hash VARCHAR(255) NOT NULL,
  name VARCHAR(255) NOT NULL,
  role VARCHAR(50) DEFAULT 'user',
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ bridges
CREATE TABLE bridges (
  bridge_id VARCHAR(255) PRIMARY KEY,
  project_name VARCHAR(255),
  object_name VARCHAR(255) NOT NULL DEFAULT '',
  status VARCHAR(50) DEFAULT 'active',
  owner_id INTEGER REFERENCES users(id) ON DELETE CASCADE,  -- NEW!
  -- ... other fields
);

-- –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ snapshots
CREATE TABLE snapshots (
  id VARCHAR(255) PRIMARY KEY,
  bridge_id VARCHAR(255) NOT NULL REFERENCES bridges(bridge_id),
  is_final INTEGER DEFAULT 0,  -- NEW! (added in previous session)
  is_locked INTEGER DEFAULT 1,
  -- ... other fields
);
```

### üîí –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- ‚úÖ –ü–∞—Ä–æ–ª–∏ —Ö–µ—à–∏—Ä—É—é—Ç—Å—è —á–µ—Ä–µ–∑ bcrypt (10 rounds)
- ‚úÖ JWT —Ç–æ–∫–µ–Ω—ã —Å 24h expiry
- ‚úÖ requireAuth middleware –Ω–∞ –≤—Å–µ—Ö –∑–∞—â–∏—â–µ–Ω–Ω—ã—Ö —Ä–æ—É—Ç–∞—Ö
- ‚úÖ Owner-based access control (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤–∏–¥—è—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –ø—Ä–æ–µ–∫—Ç—ã)
- ‚úÖ 401 errors –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–µ–¥–∏—Ä–µ–∫—Ç—è—Ç –Ω–∞ /login
- ‚úÖ Token —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ localStorage
- ‚úÖ Auto-generated JWT_SECRET –Ω–∞ Render

**–ß—Ç–æ –ù–ï —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ (–¥–ª—è –±—É–¥—É—â–µ–≥–æ):**
- ‚è≥ Password recovery
- ‚è≥ Email verification
- ‚è≥ Rate limiting –Ω–∞ auth endpoints (—á–∞—Å—Ç–∏—á–Ω–æ –µ—Å—Ç—å —á–µ—Ä–µ–∑ authLimiter)
- ‚è≥ Refresh tokens
- ‚è≥ Roles/permissions (role field –µ—Å—Ç—å, –Ω–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)
- ‚è≥ Shared projects (–∫–æ–º–∞–Ω–¥—ã)

### üìä –ö–û–ú–ú–ò–¢–´ –í –≠–¢–û–ô –°–ï–°–°–ò–ò

```bash
99b06db - ‚ú® Implement final snapshot logic for completed projects (Variant B)
7c8df57 - üîê Add PostgreSQL + Multi-user Authentication System
d8635ec - üêõ Fix P1 issues from Codex review
```

**Branch:** `claude/css-table-layout-fix-011CV3qzXMyv5VjnKTrJSbYq`

---

## üöÄ –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò

### –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç
1. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ multi-user —Å–∏—Å—Ç–µ–º—ã**
   - [ ] –°–æ–∑–¥–∞—Ç—å 2-3 —Ç–µ—Å—Ç–æ–≤—ã—Ö –∞–∫–∫–∞—É–Ω—Ç–∞
   - [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–∑–æ–ª—è—Ü–∏—é –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
   - [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É –Ω–∞ production (Render PostgreSQL)
   - [ ] –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –º–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–∏–º–µ–Ω–∏–ª–∏—Å—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

2. **–£–ª—É—á—à–∏—Ç—å transaction support –¥–ª—è PostgreSQL**
   - [ ] –¢–µ–∫—É—â–µ–µ —Ä–µ—à–µ–Ω–∏–µ: auto-commit (–±–µ–∑–æ–ø–∞—Å–Ω–æ, –Ω–æ –Ω–µ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ)
   - [ ] –ë—É–¥—É—â–µ–µ —Ä–µ—à–µ–Ω–∏–µ: –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å client –≤ callback
   - [ ] –ö—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è –º–∞—Å—Å–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π (bulk inserts/updates)

3. **UI/UX —É–ª—É—á—à–µ–Ω–∏—è**
   - [ ] –î–æ–±–∞–≤–∏—Ç—å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–∏ login
   - [ ] –£–ª—É—á—à–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö (validation feedback)
   - [ ] –î–æ–±–∞–≤–∏—Ç—å "Remember me" –æ–ø—Ü–∏—é
   - [ ] Profile page –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏–º–µ–Ω–∏/email

### –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç
4. **–ú–∏–≥—Ä–∞—Ü–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö**
   - [ ] –ï—Å–ª–∏ –µ—Å—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ SQLite –Ω–∞ dev ‚Üí –º–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ PostgreSQL
   - [ ] –°–æ–∑–¥–∞—Ç—å —Å–∫—Ä–∏–ø—Ç –º–∏–≥—Ä–∞—Ü–∏–∏ –¥–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö bridges
   - [ ] –ù–∞–∑–Ω–∞—á–∏—Ç—å owner_id –¥–ª—è legacy bridges

5. **–†–æ–ª–∏ –∏ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞**
   - [ ] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–æ–ª–µ `role` (admin/user)
   - [ ] Admin –º–æ–∂–µ—Ç –≤–∏–¥–µ—Ç—å –≤—Å–µ –ø—Ä–æ–µ–∫—Ç—ã
   - [ ] Admin –º–æ–∂–µ—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏

6. **Shared projects**
   - [ ] –¢–∞–±–ª–∏—Ü–∞ project_members (project_id, user_id, role)
   - [ ] –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø—Ä–∏–≥–ª–∞—Å–∏—Ç—å –∫–æ–ª–ª–µ–≥ –≤ –ø—Ä–æ–µ–∫—Ç
   - [ ] –ü—Ä–∞–≤–∞: viewer / editor / admin

### –ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç
7. **Email notifications**
   - [ ] Welcome email –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
   - [ ] Password recovery —á–µ—Ä–µ–∑ email
   - [ ] –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö –≤ shared projects

8. **Audit log**
   - [ ] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π (–∫—Ç–æ, –∫–æ–≥–¥–∞, —á—Ç–æ)
   - [ ] History timeline –≤ UI
   - [ ] Export audit log

---

## üìù –ó–ê–ú–ï–¢–ö–ò –î–õ–Ø –°–õ–ï–î–£–Æ–©–ï–ô –°–ï–°–°–ò–ò

### ‚ö†Ô∏è –í–ê–ñ–ù–û: –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

1. **PostgreSQL transactions —É–ø—Ä–æ—â–µ–Ω—ã**
   - –°–µ–π—á–∞—Å: –∫–∞–∂–¥—ã–π statement auto-commits
   - –ü—Ä–∏—á–∏–Ω–∞: —Å–ª–æ–∂–Ω–æ—Å—Ç—å –ø–µ—Ä–µ–¥–∞—á–∏ client –≤ callback
   - –†–∏—Å–∫: —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏ –≤–æ–∑–º–æ–∂–Ω—ã race conditions –ø—Ä–∏ concurrent updates
   - –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è: P2 (—Å—Ä–µ–¥–Ω–∏–π)

2. **Password recovery –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç**
   - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –º–æ–∂–µ—Ç –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–∞—Ä–æ–ª—å
   - –í—Ä–µ–º–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ: admin –º–µ–Ω—è–µ—Ç –ø–∞—Ä–æ–ª—å –≤—Ä—É—á–Ω—É—é –≤ –ë–î
   - –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: P3 (–Ω–∏–∑–∫–∏–π –¥–ª—è MVP)

3. **Shared projects –ø–æ–∫–∞ –Ω–µ—Ç**
   - –ö–∞–∂–¥—ã–π –ø—Ä–æ–µ–∫—Ç –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç –æ–¥–Ω–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
   - –î–ª—è –∫–æ–º–∞–Ω–¥ –Ω—É–∂–Ω–∞ –æ—Ç–¥–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ project_members
   - –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: P3 (–ø–æ—Å–ª–µ MVP)

### üéØ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

**SQLite vs PostgreSQL:**
- Development: SQLite (–±—ã—Å—Ç—Ä–æ, –ª–æ–∫–∞–ª—å–Ω–æ, –±–µ–∑ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π)
- Production: PostgreSQL (persistent storage, multi-user safe)
- Unified interface: `backend/src/db/index.js` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–±–∏—Ä–∞–µ—Ç –ë–î

**Frontend routing:**
- `/` - Main app (protected)
- `/login` - Login/Register page (public)
- Redirect: 401 errors ‚Üí `/login`

**Authentication flow:**
1. User fills login form
2. POST /api/auth/login ‚Üí returns JWT token
3. Token stored in localStorage
4. All API requests include `Authorization: Bearer <token>` header
5. Backend validates token via requireAuth middleware
6. Expired/invalid token ‚Üí 401 ‚Üí redirect to /login

---

## üîß –°–ï–°–°–ò–Ø 2025-11-13 (–¢–ï–ö–£–©–ê–Ø): PostgreSQL Production Deployment Fixes

### üìã –ü–†–û–ë–õ–ï–ú–ê
–ü–æ—Å–ª–µ —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—è –Ω–∞ Render PostgreSQL –≤—ã–¥–∞–≤–∞–ª –æ—à–∏–±–∫—É:
```
[PostgreSQL] Error executing statement: CREATE INDEX IF NOT EXISTS idx_bridges_status ON bridges(status)
[ERROR] ‚ùå Database initialization failed: error: relation "bridges" does not exist
```

–ò–Ω–¥–µ–∫—Å—ã –ø—ã—Ç–∞–ª–∏—Å—å —Å–æ–∑–¥–∞–≤–∞—Ç—å—Å—è –Ω–∞ —Ç–∞–±–ª–∏—Ü–∞—Ö, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–ª–∏.

### ‚úÖ –†–ï–®–ï–ù–ò–ï

#### 1. –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –ø—Ä–∏ –º–∏–≥—Ä–∞—Ü–∏—è—Ö (backend/src/db/migrations.js)
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ PostgreSQL –∫–æ–¥–∞ –æ—à–∏–±–∫–∏ `42P01` (relation does not exist)
- –¢–µ–ø–µ—Ä—å –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è –∫–∞–∫ `"already exists"`, —Ç–∞–∫ –∏ `"does not exist"` –æ—à–∏–±–∫–∏
- –î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–≥–Ω–æ—Ä–∏—Ä—É–µ–º—ã—Ö –æ—à–∏–±–æ–∫ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

#### 2. –†–∞–∑–¥–µ–ª–µ–Ω–∞ –æ—á–µ—Ä–µ–¥–Ω–æ—Å—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è SQL statements
**–ü—Ä–æ–±–ª–µ–º–∞:** CREATE TABLE –∏ CREATE INDEX –≤—ã–ø–æ–ª–Ω—è–ª–∏—Å—å –≤ —Å–ª—É—á–∞–π–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ
**–†–µ—à–µ–Ω–∏–µ:**
- –í—Å–µ `CREATE TABLE` statements –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è **–ø–µ—Ä–≤—ã–º–∏**
- –í—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ statements (CREATE INDEX, INSERT) –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è **–ø–æ—Å–ª–µ**
- –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ —Ç–∞–±–ª–∏—Ü—ã —Å—É—â–µ—Å—Ç–≤—É—é—Ç –ø–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º –∏–Ω–¥–µ–∫—Å–æ–≤

#### 3. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –ø–∞—Ä—Å–∏—Ä–æ–≤–∞–Ω–∏–µ SQL —Ñ–∞–π–ª–∞ (–æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤)
**–ü—Ä–æ–±–ª–µ–º–∞:** –í schema-postgres.sql –µ—Å—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –ø–µ—Ä–µ–¥ CREATE TABLE:
```sql
-- Users table
CREATE TABLE IF NOT EXISTS users (...)
```
–ö–æ–≥–¥–∞ split –ø–æ `;`, –∫–∞–∂–¥—ã–π statement —Å–æ–¥–µ—Ä–∂–∞–ª –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏. –§–∏–ª—å—Ç—Ä –Ω–µ –Ω–∞—Ö–æ–¥–∏–ª —Ç–∞–±–ª–∏—Ü—ã, –ø–æ—Ç–æ–º—É —á—Ç–æ —Å—Ç—Ä–æ–∫–∞ –Ω–∞—á–∏–Ω–∞–ª–∞—Å—å —Å `--`.

**–†–µ—à–µ–Ω–∏–µ:**
- –£–±–∏—Ä–∞–µ–º –≤—Å–µ —Å—Ç—Ä–æ–∫–∏ —Å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏ (`--`) –∏–∑ –∫–∞–∂–¥–æ–≥–æ statement
- –ü—Ä–æ–≤–µ—Ä—è–µ–º `startsWith('CREATE TABLE')` –±–µ–∑ —É—á–µ—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞
- –¢–µ–ø–µ—Ä—å –≤—Å–µ 8 CREATE TABLE statements –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞—é—Ç—Å—è –∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –ø–µ—Ä–≤—ã–º–∏

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```
[PostgreSQL] Running 8 CREATE TABLE statements...
[PostgreSQL] ‚úì Created table
[PostgreSQL] ‚úì Created table
...
[PostgreSQL] Running 14 other statements (indexes, inserts)...
[PostgreSQL] ‚úì Created index
[Database] Schema initialized successfully
```

### üìä –ö–û–ú–ú–ò–¢–´ –í –≠–¢–û–ô –°–ï–°–°–ò–ò

```bash
e78f30b - üîß Fix PostgreSQL schema parsing - handle comments in SQL statements
e2ab4be - üîß Separate CREATE TABLE and CREATE INDEX execution for PostgreSQL migrations
b8327d9 - üîß Improve PostgreSQL error handling with better logging
7e8d544 - üîß Fix PostgreSQL migration error handling for relation not existing
```

**Branch:** `claude/review-previous-session-011CV5UjfnsrTsbV42b46UrS`

#### 4. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –≤—Å–µ async/await –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤ route handlers
**–ü—Ä–æ–±–ª–µ–º–∞:** –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–π –æ–±–Ω–∞—Ä—É–∂–∏–ª–æ—Å—å —á—Ç–æ –º–Ω–æ–≥–∏–µ route handlers –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –≤—ã–∑–æ–≤—ã –ë–î:
- `config.js`: GET/POST config routes
- `upload.js`: POST upload route (–∫—Ä–∏—Ç–∏—á–Ω–∞—è –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞ –¥–∞–Ω–Ω—ã—Ö)
- `export.js`: GET export routes
- `mapping.js`: GET/POST mapping routes
- `otskp.js`: GET search, stats, –∏ –¥—Ä—É–≥–∏–µ routes

–î–ª—è PostgreSQL –í–°–ï –æ–ø–µ—Ä–∞—Ü–∏–∏ –ë–î –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å async/await!

**–†–µ—à–µ–Ω–∏–µ:**
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω `await` –ø–µ—Ä–µ–¥ –≤—Å–µ–º–∏ `db.prepare().get()`, `.all()`, `.run()` –≤—ã–∑–æ–≤–∞–º–∏
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω `async` –∫–æ –≤—Å–µ–º route handler —Ñ—É–Ω–∫—Ü–∏—è–º
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –ø—Ä–∏ –ø–∞—Ä—Å–∏–Ω–≥–µ JSON (–µ—Å–ª–∏ –ø—Ä–∏—Ö–æ–¥–∏—Ç undefined)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –≤ upload route (requireAuth middleware)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω owner_id –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ bridges —á–µ—Ä–µ–∑ –∏–º–ø–æ—Ä—Ç

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- –ò–º–ø–æ—Ä—Ç XLSX —Ñ–∞–π–ª–æ–≤ —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ (–¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ë–î)
- UI –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ø–æ—Å–ª–µ –∏–º–ø–æ—Ä—Ç–∞ (—á–µ—Ä–µ–∑ React Query invalidation)
- –ö–æ–Ω—Ñ–∏–≥ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫ JSON –ø–∞—Ä—Å–∏–Ω–≥–∞
- –í—Å–µ —ç–∫—Å–ø–æ—Ä—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

### üìä –ò–¢–û–ì–û–í–´–ï –ö–û–ú–ú–ò–¢–´ –í –°–ï–°–°–ò–ò

```bash
543fe5d - üîß Fix async/await for PostgreSQL in export, mapping, and otskp routes
38ee9d3 - üêõ Fix async/await for PostgreSQL in config and upload routes
e8e1ad2 - üìù Update documentation with SQL parsing fix details
e78f30b - üîß Fix PostgreSQL schema parsing - handle comments in SQL statements
3682774 - üìù Document PostgreSQL migration fixes in session summary
e2ab4be - üîß Separate CREATE TABLE and CREATE INDEX execution for PostgreSQL migrations
b8327d9 - üîß Improve PostgreSQL error handling with better logging
7e8d544 - üîß Fix PostgreSQL migration error handling for relation not existing
```

**Branch:** `claude/review-previous-session-011CV5UjfnsrTsbV42b46UrS`
**–í—Å–µ–≥–æ –∫–æ–º–º–∏—Ç–æ–≤:** 8
**–í—Å–µ–≥–æ —Ñ–∞–π–ª–æ–≤ –∏–∑–º–µ–Ω–µ–Ω–æ:** 8 route —Ñ–∞–π–ª–æ–≤ + –º–∏–≥—Ä–∞—Ü–∏–∏ + –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### üöÄ –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò

1. **–°–æ–∑–¥–∞—Ç—å Pull Request** –∏ –º–µ—Ä–¥–∂–∏—Ç—å –≤ main
2. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ Production (Render)**
   - [ ] Render –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ—Å–æ–±–µ—Ä–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
   - [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏: `[PostgreSQL] Running 8 CREATE TABLE statements...`
   - [ ] –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –±–∞–∑–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
   - [ ] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–º–ø–æ—Ä—Ç XLSX (–¥–æ–ª–∂–Ω—ã –ø–æ—è–≤–ª—è—Ç—å—Å—è –¥–∞–Ω–Ω—ã–µ –≤ —Ç–∞–±–ª–∏—Ü–µ)
   - [ ] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é –∏ –ª–æ–≥–∏–Ω —Å 2-3 –∞–∫–∫–∞—É–Ω—Ç–∞–º–∏
   - [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–∑–æ–ª—è—Ü–∏—é –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏

3. **–ï—Å–ª–∏ –æ—Å—Ç–∞—é—Ç—Å—è –ø—Ä–æ–±–ª–µ–º—ã:**
   - [ ] –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø–æ–ª–Ω—ã–µ –ª–æ–≥–∏ Render: https://dashboard.render.com
   - [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (–æ—Å–æ–±–µ–Ω–Ω–æ DATABASE_URL)
   - [ ] –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ PostgreSQL –∏–Ω—Å—Ç–∞–Ω—Å –ø–æ–ª—É—á–∏–ª —Å—Ç–∞—Ç—É—Å "available"

---

**‚ö° –í–ù–ò–ú–ê–ù–ò–ï:** –§–∞–π–ª —Ä–∞–∑—Ä–æ—Å—Å—è –¥–æ 2900+ —Å—Ç—Ä–æ–∫. –°–ª–µ–¥—É—é—â–∞—è —Å–µ—Å—Å–∏—è –¥–æ–ª–∂–Ω–∞ –Ω–∞—á–∞—Ç—å—Å—è —Å —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ CLAUDE.MD!

