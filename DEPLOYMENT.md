# Deployment Guide - Render.com

–†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –¥–µ–ø–ª–æ—é Concrete Agent –Ω–∞ Render.com

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π](#–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π-–¥–µ–ø–ª–æ–π)
2. [MinerU –∏ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏](#mineru-–∏-—Å–∏—Å—Ç–µ–º–Ω—ã–µ-–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏)
3. [Environment Variables](#environment-variables)
4. [Troubleshooting](#troubleshooting)

---

## üöÄ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π

### –®–∞–≥ 1: –ü–æ–¥–∫–ª—é—á–∏—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∫ Render

1. –ó–∞–π—Ç–∏ –Ω–∞ https://dashboard.render.com/
2. –ù–∞–∂–∞—Ç—å **"New" ‚Üí "Blueprint"**
3. –ü–æ–¥–∫–ª—é—á–∏—Ç—å GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π: `alpro1000/concrete-agent`
4. Render –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–∞—Ä—É–∂–∏—Ç `render.yaml`

### –®–∞–≥ 2: Render –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç

Render –ø—Ä–æ—á–∏—Ç–∞–µ—Ç `render.yaml` –∏ —Å–æ–∑–¥–∞—Å—Ç **2 —Å–µ—Ä–≤–∏—Å–∞**:
- **concrete-agent** (Backend API - Python)
- **stav-agent** (Frontend - Node.js)

### –®–∞–≥ 3: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–µ—Ä—à–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

Render –≤—ã–ø–æ–ª–Ω–∏—Ç:
```bash
# 1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç —Å–∏—Å—Ç–µ–º–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏–∑ Aptfile
apt-get install -y poppler-utils tesseract-ocr tesseract-ocr-ces

# 2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pip install -r requirements.txt

# 3. –ó–∞–ø—É—Å—Ç–∏—Ç —Å–µ—Ä–≤–µ—Ä
uvicorn app.main:app --host 0.0.0.0 --port $PORT
```

---

## üì¶ MinerU –∏ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

### –ß—Ç–æ —Ç–∞–∫–æ–µ Aptfile?

`Aptfile` - —ç—Ç–æ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π —Ñ–∞–π–ª –¥–ª—è Render.com, –∫–æ—Ç–æ—Ä—ã–π —É–∫–∞–∑—ã–≤–∞–µ—Ç –∫–∞–∫–∏–µ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –ø–∞–∫–µ—Ç—ã –Ω—É–∂–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —á–µ—Ä–µ–∑ `apt-get`.

### –ù–∞—à Aptfile:

```
# Aptfile
poppler-utils           # –î–ª—è PDF rendering
tesseract-ocr          # OCR –¥–≤–∏–∂–æ–∫
tesseract-ocr-ces      # –ß–µ—à—Å–∫–∏–π —è–∑—ã–∫
tesseract-ocr-eng      # –ê–Ω–≥–ª–∏–π—Å–∫–∏–π —è–∑—ã–∫
libgl1-mesa-glx        # OpenGL
libglib2.0-0           # GLib –±–∏–±–ª–∏–æ—Ç–µ–∫–∞
```

### –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:

1. **Render –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç Aptfile** –ø—Ä–∏ –¥–µ–ø–ª–æ–µ
2. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç**:
   ```bash
   apt-get update
   apt-get install -y $(cat Aptfile)
   ```
3. **–ó–∞—Ç–µ–º —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç Python –ø–∞–∫–µ—Ç—ã** –≤–∫–ª—é—á–∞—è `magic-pdf`

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ MinerU:

–ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:
```
‚úÖ MinerU (magic-pdf) is available
```

–ï—Å–ª–∏ –≤–∏–¥–∏—Ç–µ:
```
‚ö†Ô∏è  MinerU (magic-pdf) not installed
```

–ó–Ω–∞—á–∏—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–µ —É–¥–∞–ª–∞—Å—å, –Ω–æ —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—Å—è –Ω–∞ **Claude Vision fallback**.

---

## üîß Environment Variables

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤ Render Dashboard):

```bash
ANTHROPIC_API_KEY=sk-ant-xxx...  # –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û
OPENAI_API_KEY=sk-xxx...         # –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ (–¥–ª—è GPT-4 Vision)
```

### Feature Flags (—É–∂–µ –≤ render.yaml):

```yaml
USE_MINERU: true              # –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å MinerU (FREE)
USE_CLAUDE_VISION: true       # Fallback –Ω–∞ Claude Vision
ENABLE_WORKFLOW_B: true       # –í–∫–ª—é—á–∏—Ç—å Workflow B
```

### –ö–∞–∫ –∏–∑–º–µ–Ω–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è:

1. –ó–∞–π—Ç–∏ –≤ **Render Dashboard**
2. –í—ã–±—Ä–∞—Ç—å —Å–µ—Ä–≤–∏—Å **concrete-agent**
3. –ü–µ—Ä–µ–π—Ç–∏ –≤ **Environment**
4. –ò–∑–º–µ–Ω–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ, –Ω–∞–ø—Ä–∏–º–µ—Ä:
   ```
   USE_MINERU = false  # –û—Ç–∫–ª—é—á–∏—Ç—å MinerU
   ```
5. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å ‚Üí Render –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–¥–µ–ø–ª–æ–∏—Ç

---

## üõ†Ô∏è Troubleshooting

### –ü—Ä–æ–±–ª–µ–º–∞: MinerU –Ω–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è

**–°–∏–º–ø—Ç–æ–º—ã**:
```
‚ö†Ô∏è  MinerU (magic-pdf) not installed
```

**–†–µ—à–µ–Ω–∏–µ 1**: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Aptfile
```bash
# –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ Aptfile —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞
cat Aptfile
```

**–†–µ—à–µ–Ω–∏–µ 2**: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ Build
1. Render Dashboard ‚Üí concrete-agent ‚Üí Logs
2. –ù–∞–π—Ç–∏ —Å–µ–∫—Ü–∏—é "Installing system dependencies"
3. –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –æ—à–∏–±–∫–∏ apt-get

**–†–µ—à–µ–Ω–∏–µ 3**: Fallback –Ω–∞ Claude Vision
```bash
# –í Render Dashboard —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å:
USE_MINERU=false
USE_CLAUDE_VISION=true
```

---

### –ü—Ä–æ–±–ª–µ–º–∞: "poppler not found"

**–°–∏–º–ø—Ç–æ–º—ã**:
```
ImportError: poppler not found
```

**–†–µ—à–µ–Ω–∏–µ**: –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –≤ Aptfile –µ—Å—Ç—å:
```
poppler-utils
```

–ò –ø–µ—Ä–µ–¥–µ–ø–ª–æ–∏—Ç—å:
```bash
# Render Dashboard ‚Üí Manual Deploy ‚Üí Deploy latest commit
```

---

### –ü—Ä–æ–±–ª–µ–º–∞: –í—ã—Å–æ–∫–∏–µ –∑–∞—Ç—Ä–∞—Ç—ã –Ω–∞ Claude API

**–°–∏–º–ø—Ç–æ–º—ã**: –¢–æ–∫–µ–Ω—ã –∑–∞–∫–∞–Ω—á–∏–≤–∞—é—Ç—Å—è –±—ã—Å—Ç—Ä–æ

**–†–µ—à–µ–Ω–∏–µ**: –í–∫–ª—é—á–∏—Ç—å MinerU
```bash
USE_MINERU=true  # –í Render Dashboard
```

MinerU –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç PDF **–±–µ—Å–ø–ª–∞—Ç–Ω–æ**, Claude –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è —Ñ–∏–Ω–∞–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏.

**–°—Ä–∞–≤–Ω–µ–Ω–∏–µ**:
- **–ë–µ–∑ MinerU**: 100 PDF √ó $0.05 = $5.00
- **–° MinerU**: 100 PDF √ó $0.001 = $0.10 (—ç–∫–æ–Ω–æ–º–∏—è 98%)

---

## üìä –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏ PDF

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–±–∏—Ä–∞–µ—Ç –º–µ—Ç–æ–¥:

```
1. MinerU (FREE) ‚úÖ
   ‚Üì –ï—Å–ª–∏ –Ω–µ —É–¥–∞–ª–æ—Å—å
2. Claude Vision ($0.003/page)
   ‚Üì –ï—Å–ª–∏ –Ω–µ —É–¥–∞–ª–æ—Å—å
3. GPT-4 Vision ($0.01/page)
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤:

```bash
# –¢–æ–ª—å–∫–æ MinerU (—Å–∞–º—ã–π –¥–µ—à–µ–≤—ã–π)
USE_MINERU=true
USE_CLAUDE_VISION=false

# MinerU + Claude fallback (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
USE_MINERU=true
USE_CLAUDE_VISION=true

# –¢–æ–ª—å–∫–æ Claude Vision
USE_MINERU=false
USE_CLAUDE_VISION=true

# –¢–æ–ª—å–∫–æ GPT-4 Vision (—Å–∞–º—ã–π –¥–æ—Ä–æ–≥–æ–π)
USE_MINERU=false
USE_CLAUDE_VISION=false
```

---

## üéØ –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–î–ª—è **production** (–±–∞–ª–∞–Ω—Å —Ü–µ–Ω—ã –∏ –∫–∞—á–µ—Å—Ç–≤–∞):

```yaml
USE_MINERU: true              # FREE –æ–±—Ä–∞–±–æ—Ç–∫–∞ PDF
USE_CLAUDE_VISION: true       # Fallback –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤
ENABLE_WORKFLOW_B: true       # –ü–æ–ª–Ω—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª
```

–î–ª—è **development** (–º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ):

```yaml
USE_MINERU: false
USE_CLAUDE_VISION: true
ENABLE_WORKFLOW_B: true
```

---

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã:
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –≤ Render Dashboard
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤—Å–µ environment variables —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
3. –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ API –∫–ª—é—á–∏ –≤–∞–ª–∏–¥–Ω—ã
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ Aptfile —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ –∫–æ—Ä–Ω–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

---

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –¥–µ–ø–ª–æ—è

- [ ] Aptfile —Å–æ–∑–¥–∞–Ω –∏ –∑–∞–∫–æ–º–º–∏—á–µ–Ω
- [ ] render.yaml –æ–±–Ω–æ–≤–ª–µ–Ω —Å –Ω–æ–≤—ã–º–∏ env vars
- [ ] ANTHROPIC_API_KEY —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ Render Dashboard
- [ ] –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –ø–æ–¥–∫–ª—é—á–µ–Ω –∫ Render
- [ ] –î–µ–ø–ª–æ–π –∑–∞–ø—É—â–µ–Ω
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω—ã –ª–æ–≥–∏ - MinerU —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω upload PDF —Ñ–∞–π–ª–∞
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–∞ —Å—Ç–æ–∏–º–æ—Å—Ç—å API calls

---

**–ì–æ—Ç–æ–≤–æ!** üéâ –¢–µ–ø–µ—Ä—å —É –≤–∞—Å –∑–∞–ø—É—â–µ–Ω Concrete Agent —Å MinerU –Ω–∞ Render.com.
