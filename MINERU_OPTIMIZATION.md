# MinerU Deployment Optimization

**–ü—Ä–æ–±–ª–µ–º–∞:** MinerU (`magic-pdf`) —Ç—è–∂—ë–ª–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ ‚Üí deployment –Ω–∞ Render –∑–∞–Ω–∏–º–∞–µ—Ç 10-15 –º–∏–Ω—É—Ç

**–†–µ—à–µ–Ω–∏–µ:** –£ —Ç–µ–±—è –£–ñ–ï –ï–°–¢–¨ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ - pdfplumber! üéâ

---

## ‚úÖ –ë–´–°–¢–†–û–ï –†–ï–®–ï–ù–ò–ï (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

### –í–∞—Ä–∏–∞–Ω—Ç 1: –û—Ç–∫–ª—é—á–∏—Ç—å MinerU —á–µ—Ä–µ–∑ Environment Variable

**–ù–∞ Render:**
1. –ó–∞–π–¥–∏ –≤ Dashboard ‚Üí —Ç–≤–æ–π backend service
2. Environment ‚Üí Add environment variable
3. –î–æ–±–∞–≤—å:
   ```
   USE_MINERU=false
   ```
4. Redeploy

**–ß—Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥—ë—Ç:**
- ‚úÖ MinerU –Ω–µ –±—É–¥–µ—Ç —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å—Å—è
- ‚úÖ Deployment —É—Å–∫–æ—Ä–∏—Ç—Å—è —Å 15 –º–∏–Ω—É—Ç ‚Üí 2-3 –º–∏–Ω—É—Ç—ã
- ‚úÖ –ö–æ–¥ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `pdfplumber` (—É–∂–µ –µ—Å—Ç—å –≤ –∫–æ–¥–µ!)
- ‚úÖ –í—Å—ë –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –∫–∞–∫ —Ä–∞–Ω—å—à–µ

**–ì–¥–µ —ç—Ç–æ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è:**
- `app/core/config.py:64` - `USE_MINERU: bool = Field(default=True, ...)`
- –ï—Å–ª–∏ `USE_MINERU=false`, –∫–æ–¥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `pdfplumber`

---

### –í–∞—Ä–∏–∞–Ω—Ç 2: –£–¥–∞–ª–∏—Ç—å MinerU –∏–∑ requirements.txt

**–ï—â—ë –±—ã—Å—Ç—Ä–µ–µ:**

1. –û—Ç–∫—Ä–æ–π `requirements.txt`
2. –ó–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π —Å—Ç—Ä–æ–∫—É 29:
   ```python
   # magic-pdf==1.3.12  # Disabled - using pdfplumber instead
   ```
3. Commit –∏ push
4. Render redeploy –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

**–ü–ª—é—Å—ã:**
- ‚úÖ Deployment –±—É–¥–µ—Ç –û–ß–ï–ù–¨ –±—ã—Å—Ç—Ä—ã–π (2-3 –º–∏–Ω—É—Ç—ã)
- ‚úÖ –ú–µ–Ω—å—à–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π = –º–µ–Ω—å—à–µ –ø—Ä–æ–±–ª–µ–º
- ‚úÖ pdfplumber —É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤–æ –≤—Å–µ—Ö –ø–∞—Ä—Å–µ—Ä–∞—Ö

**–ú–∏–Ω—É—Å—ã:**
- ‚ö†Ô∏è –ï—Å–ª–∏ –∑–∞—Ö–æ—á–µ—à—å MinerU –≤ –±—É–¥—É—â–µ–º, –Ω—É–∂–Ω–æ —Ä–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å

---

## üìä –°–†–ê–í–ù–ï–ù–ò–ï

| –ú–µ—Ç–æ–¥                  | Deployment Time | PDF Quality | API Costs | –°–ª–æ–∂–Ω–æ—Å—Ç—å |
|------------------------|-----------------|-------------|-----------|-----------|
| **MinerU (—Ç–µ–∫—É—â–µ–µ)**   | 15 –º–∏–Ω—É—Ç ‚è≥     | –û—Ç–ª–∏—á–Ω–æ     | $0        | –í—ã—Å–æ–∫–∞—è   |
| **pdfplumber**         | 2-3 –º–∏–Ω—É—Ç—ã ‚úÖ   | –•–æ—Ä–æ—à–æ      | $0        | –ù–∏–∑–∫–∞—è    |
| **Claude Vision**      | 2-3 –º–∏–Ω—É—Ç—ã ‚úÖ   | –û—Ç–ª–∏—á–Ω–æ     | ~$0.01/—Å—Ç—Ä| –ù–∏–∑–∫–∞—è    |

---

## üîç –ì–î–ï –ò–°–ü–û–õ–¨–ó–£–ï–¢–°–Ø PDF PARSING

### 6 —Ñ–∞–π–ª–æ–≤ –∏—Å–ø–æ–ª—å–∑—É—é—Ç PDF –ø–∞—Ä—Å–∏–Ω–≥:

1. **`app/core/kb_loader.py`**
   - Knowledge Base –∑–∞–≥—Ä—É–∑–∫–∞
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç: pdfplumber ‚úÖ

2. **`app/parsers/memory_efficient.py`**
   - –û—Å–Ω–æ–≤–Ω–æ–π –ø–∞—Ä—Å–µ—Ä –¥–ª—è –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç: pdfplumber ‚úÖ

3. **`app/parsers/drawing_specs_parser.py`**
   - –ü–∞—Ä—Å–∏–Ω–≥ —á–µ—Ä—Ç–µ–∂–µ–π
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç: pdfplumber ‚úÖ

4. **`app/parsers/pdf_parser.py`**
   - –û–±—â–∏–π PDF –ø–∞—Ä—Å–µ—Ä
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç: pdfplumber ‚úÖ

5. **`app/parsers/smart_parser.py`**
   - –£–º–Ω—ã–π –ø–∞—Ä—Å–µ—Ä —Å fallback
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç: pdfplumber ‚úÖ

6. **`app/core/mineru_client.py`**
   - MinerU –∫–ª–∏–µ–Ω—Ç (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π!)
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç: magic-pdf (–µ—Å–ª–∏ `USE_MINERU=true`)

**–í—ã–≤–æ–¥:** –í–µ—Å—å –∫–æ–¥ –£–ñ–ï –†–ê–ë–û–¢–ê–ï–¢ —Å pdfplumber! MinerU –º–æ–∂–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç—å.

---

## üéØ –ú–û–Ø –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–Ø

### –°–¥–µ–ª–∞–π –¢–ê–ö:

**–®–ê–ì 1:** –î–æ–±–∞–≤—å –Ω–∞ Render environment variable
```
USE_MINERU=false
```

**–®–ê–ì 2:** –ó–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π –≤ `requirements.txt`:
```python
# magic-pdf==1.3.12  # Disabled for faster deployment - using pdfplumber
```

**–®–ê–ì 3:** Commit + Push
```bash
git add requirements.txt
git commit -m "perf: disable MinerU for faster deployment (use pdfplumber)"
git push
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ Deployment —Å 15 –º–∏–Ω—É—Ç ‚Üí 2-3 –º–∏–Ω—É—Ç—ã
- ‚úÖ PDF parsing –≤—Å—ë —Ä–∞–≤–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç (—á–µ—Ä–µ–∑ pdfplumber)
- ‚úÖ –ù–∏–∫–∞–∫–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ –Ω–µ –ø–æ—Ç–µ—Ä—è–µ—à—å
- ‚úÖ –ú–æ–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å MinerU –≤ –±—É–¥—É—â–µ–º –µ—Å–ª–∏ –Ω—É–∂–Ω–æ

---

## üîÑ –ï–°–õ–ò –ó–ê–•–û–ß–ï–®–¨ –í–ï–†–ù–£–¢–¨ MinerU

**–ö–æ–≥–¥–∞ –Ω—É–∂–µ–Ω:**
- –û—á–µ–Ω—å —Å–ª–æ–∂–Ω—ã–µ PDF —Å –ø–ª–æ—Ö–∏–º –∫–∞—á–µ—Å—Ç–≤–æ–º
- OCR –¥–ª—è –æ—Ç—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å (–Ω–æ –º–µ–¥–ª–µ–Ω–Ω–µ–µ deployment)

**–ö–∞–∫ –≤–µ—Ä–Ω—É—Ç—å:**
1. –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π –≤ `requirements.txt`:
   ```python
   magic-pdf==1.3.12
   ```
2. –ù–∞ Render —É–±–µ—Ä–∏ –∏–ª–∏ –∏–∑–º–µ–Ω–∏:
   ```
   USE_MINERU=true
   ```
3. Deployment –±—É–¥–µ—Ç —Å–Ω–æ–≤–∞ 15 –º–∏–Ω—É—Ç

---

## üí° –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–ê–Ø –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø (Advanced)

### –ï—Å–ª–∏ —Ö–æ—á–µ—à—å –ï–©–Å –ë–´–°–¢–†–ï–ï:

**1. Docker Image Caching (Render Premium)**
- Render Pro plan –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç Docker cache
- Deployment —É—Å–∫–æ—Ä—è–µ—Ç—Å—è –¥–æ 30 —Å–µ–∫—É–Ω–¥
- –°—Ç–æ–∏—Ç ~$20/–º–µ—Å—è—Ü

**2. Pre-built Docker Image**
- –°–æ–∑–¥–∞–π Docker image —Å pre-installed dependencies
- Push –Ω–∞ Docker Hub
- Render –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≥–æ—Ç–æ–≤—ã–π image
- Deployment 10-20 —Å–µ–∫—É–Ω–¥

**3. Split Services (Micro-services)**
- Backend API: –±—ã—Å—Ç—Ä—ã–π deployment (–±–µ–∑ MinerU)
- PDF Service: –æ—Ç–¥–µ–ª—å–Ω—ã–π —Å–µ—Ä–≤–∏—Å —Å MinerU
- –û–±—â–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ API
- –ú–æ–∂–Ω–æ deploy –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ

---

## üìù SUMMARY

**–ü–†–û–ë–õ–ï–ú–ê:**
- MinerU —Ç—è–∂—ë–ª–∞—è ‚Üí deployment 15 –º–∏–Ω—É—Ç

**–†–ï–®–ï–ù–ò–ï:**
- –û—Ç–∫–ª—é—á–∏—Ç—å MinerU (`USE_MINERU=false`)
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å pdfplumber (—É–∂–µ –µ—Å—Ç—å!)
- Deployment ‚Üí 2-3 –º–∏–Ω—É—Ç—ã

**–î–ï–ô–°–¢–í–ò–Ø:**
1. –î–æ–±–∞–≤—å env var –Ω–∞ Render: `USE_MINERU=false`
2. –ó–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π `magic-pdf==1.3.12` –≤ requirements.txt
3. Commit + push
4. –ù–∞—Å–ª–∞–∂–¥–∞–π—Å—è –±—ã—Å—Ç—Ä—ã–º deployment! üöÄ

---

*Created: 2025-11-01*
*Status: Ready to implement*
