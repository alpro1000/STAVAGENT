# –ê–Ω–∞–ª–∏–∑ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–∞: stavebnistandardy.cz + RozpoƒçetPRO

**–î–∞—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞:** 2025-11-06
**–ò—Å—Ç–æ—á–Ω–∏–∫–∏:**
- https://www.stavebnistandardy.cz/ (JKSO –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è)
- –î–µ—Ç–∞–ª—å–Ω—ã–π —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ RozpoƒçetPRO –ø–∞—Ä—Å–∏–Ω–≥–∞ –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏

---

## 1. –û–ë–ó–û–†: –ß—Ç–æ –¥–µ–ª–∞–µ—Ç –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç

### JKSO (Jednotn√° klasifikace stavebn√≠ch objekt≈Ø)

**–ß—Ç–æ —ç—Ç–æ:**
- –ï–¥–∏–Ω–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —Å—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –¥–ª—è –ß–µ—Ö–∏–∏/–°–ª–æ–≤–∞–∫–∏–∏
- –ò–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∞—è —Å–∏—Å—Ç–µ–º–∞ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è (M11 ‚Üí M11.01 ‚Üí M11.01.001)
- –°—Ç–∞–Ω–¥–∞—Ä—Ç –¥–ª—è –≤—Å–µ—Ö —Å—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω—ã—Ö —Å–º–µ—Ç –≤ —Ä–µ–≥–∏–æ–Ω–µ

**–ö–∞—Ç–µ–≥–æ—Ä–∏–∏:**
```
M11 - P≈ô√≠pravn√© pr√°ce (–ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–∞–±–æ—Ç—ã)
R11 - Zemn√≠ pr√°ce (–ó–µ–º–ª—è–Ω—ã–µ —Ä–∞–±–æ—Ç—ã)
R12 - Z√°klady (–§—É–Ω–¥–∞–º–µ–Ω—Ç—ã)
R13 - Svisl√© konstrukce (–í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏)
R14 - Vodorovn√© konstrukce (–ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏)
...
```

**–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –Ω–∞—à–∏–º–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º–∏:**

| –°—Ç–∞–Ω–¥–∞—Ä—Ç | –†–µ–≥–∏–æ–Ω | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ Concrete Agent |
|----------|--------|-------------------------------|
| **JKSO** | CZ/SK | ‚ùå –ü–æ–∫–∞ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è |
| **KROS** | SK | ‚úÖ –û—Å–Ω–æ–≤–Ω–æ–π –¥–ª—è SK |
| **RTS** | SK | ‚úÖ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π |
| **OTSKP** | CZ | ‚úÖ –û—Å–Ω–æ–≤–Ω–æ–π –¥–ª—è CZ |

---

## 2. –ü–û–õ–ï–ó–ù–´–ï –ú–ï–•–ê–ù–ò–ö–ò: –ü–∞—Ä—Å–∏–Ω–≥ —Ñ–∞–π–ª–æ–≤

### 2.1. –£–º–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ header row

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç Excel —Å —Ä–∞–∑–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π
- Header –º–æ–∂–µ—Ç –±—ã—Ç—å –≤ —Å—Ç—Ä–æ–∫–µ 1, 3, 5 –∏–ª–∏ –¥–∞–∂–µ 10

**–†–µ—à–µ–Ω–∏–µ RozpoƒçetPRO:**
```python
def detect_header_row(sheet):
    """Scoring algorithm –¥–ª—è –ø–æ–∏—Å–∫–∞ header"""
    scores = []
    for row_idx in range(1, min(20, sheet.max_row)):
        row = sheet[row_idx]
        score = sum(
            1 for cell in row
            if cell.value and is_header_keyword(str(cell.value))
        )
        scores.append((row_idx, score))
    return max(scores, key=lambda x: x[1])[0]
```

**‚úÖ –ü–†–ò–ú–ï–ù–ò–¢–¨ –≤ Concrete Agent:**
- –î–æ–±–∞–≤–∏—Ç—å –≤ `app/parsers/excel_parser.py`
- –£–ª—É—á—à–∏—Ç—å —Ä–æ–±–∞—Å—Ç–Ω–æ—Å—Ç—å –ø–∞—Ä—Å–∏–Ω–≥–∞ Excel —Å–º–µ—Ç
- –¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –∏—â–µ—Ç header —Ç–æ–ª—å–∫–æ –≤ –ø–µ—Ä–≤—ã—Ö 5 —Å—Ç—Ä–æ–∫–∞—Ö

---

### 2.2. –ì–∏–±–∫–∏–π mapping –∫–æ–ª–æ–Ω–æ–∫

**–ú–µ—Ö–∞–Ω–∏–∑–º:**
```python
column_patterns = {
    'code': r'k√≥?d|ƒç√≠slo|code|poz[i√≠]c[ei]',
    'name': r'n√°z[ev]+|name|polo≈æ?ka|popis',
    'quantity': r'mno≈æstv√≠|kol[i√≠]ƒçstvo|qty',
    'unit': r'mj|jednotka|unit',
    'unit_price': r'cena.*jednotk|unit.*price',
    'total': r'celkem|total|suma'
}
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –†–∞–±–æ—Ç–∞–µ—Ç —Å —Ä–∞–∑–Ω—ã–º–∏ —è–∑—ã–∫–∞–º–∏ (Czech, Slovak, English)
- –£—Å—Ç–æ–π—á–∏–≤ –∫ –æ–ø–µ—á–∞—Ç–∫–∞–º (regex —Å optional —Å–∏–º–≤–æ–ª–∞–º–∏)
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Å–∏–Ω–æ–Ω–∏–º—ã

**‚úÖ –ü–†–ò–ú–ï–ù–ò–¢–¨ –≤ Concrete Agent:**
- –î–æ–±–∞–≤–∏—Ç—å –≤ `KROSParser` –∏ `ExcelParser`
- –†–∞—Å—à–∏—Ä–∏—Ç—å regex patterns –¥–ª—è Slovak —Ç–µ—Ä–º–∏–Ω–æ–≤
- –¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è –∫–æ–ª–æ–Ω–æ–∫

---

### 2.3. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏–µ—Ä–∞—Ä—Ö–∏–∏ (–∫–∞—Ç–µ–≥–æ—Ä–∏—è vs –ø–æ–∑–∏—Ü–∏—è)

**–õ–æ–≥–∏–∫–∞ RozpoƒçetPRO:**
```python
def is_category(item):
    """–ü–æ–∑–∏—Ü–∏—è - –∫–∞—Ç–µ–≥–æ—Ä–∏—è, –µ—Å–ª–∏:
    1. –ö–æ–¥ –±–µ–∑ —Ç–æ—á–∫–∏ (M11, R11) –∏–ª–∏ —Å –æ–¥–Ω–æ–π —Ç–æ—á–∫–æ–π
    2. –ù–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ (quantity = 0 –∏–ª–∏ None)
    3. –í—ã–¥–µ–ª–µ–Ω–∞ –∂–∏—Ä–Ω—ã–º —à—Ä–∏—Ñ—Ç–æ–º
    4. –ò–º–µ–µ—Ç –æ—Ç—Å—Ç—É–ø/—Å—Ç–∏–ª—å
    """
    code_parts = item['code'].split('.')

    if len(code_parts) == 1 and re.match(r'^[MR]\d{2}$', item['code']):
        return True

    if not item.get('quantity') or item['quantity'] == 0:
        return True

    return False
```

**‚úÖ –ü–†–ò–ú–ï–ù–ò–¢–¨ –≤ Concrete Agent:**
- –î–æ–±–∞–≤–∏—Ç—å `hierarchy_detector.py` –≤ `app/parsers/`
- –£–ª—É—á—à–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–π –≤ –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
- –°–µ–π—á–∞—Å –≤—Å–µ –ø–æ–∑–∏—Ü–∏–∏ –ø–ª–æ—Å–∫–∏–µ, –±–µ–∑ parent-child relationships

---

## 3. –ü–û–õ–ï–ó–ù–´–ï –ú–ï–•–ê–ù–ò–ö–ò: AI-–æ–±–æ–≥–∞—â–µ–Ω–∏–µ

### 3.1. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏—Ö –ø–æ–∑–∏—Ü–∏–π

**–ú–µ—Ö–∞–Ω–∏–∑–º:**
```python
def detect_missing_items(items):
    """LLM –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Å–º–µ—Ç—É –∏ –Ω–∞—Ö–æ–¥–∏—Ç —Ç–∏–ø–∏—á–Ω–æ –∑–∞–±—ã—Ç—ã–µ –ø–æ–∑–∏—Ü–∏–∏"""
    prompt = f"""
    –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π —Å–º–µ—Ç—É:
    {summarize_items(items)}

    –¢–∏–ø–∏—á–Ω—ã–µ –∑–∞–±—ã—Ç—ã–µ –ø–æ–∑–∏—Ü–∏–∏:
    - –ì–µ–æ–¥–µ–∑–∏—á–µ—Å–∫–∏–µ —Ä–∞–±–æ—Ç—ã
    - –í—ã–≤–æ–∑ –º—É—Å–æ—Ä–∞
    - –°—Ç—Ä–∞—Ö–æ–≤–∫–∞
    - –ü—Ä–æ–µ–∫—Ç–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
    - –°–æ–ø—É—Ç—Å—Ç–≤—É—é—â–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã (–∫—Ä–µ–ø–µ–∂, –≥–µ—Ä–º–µ—Ç–∏–∫–∏)

    –°–ø–∏—Å–æ–∫ –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏—Ö –ø–æ–∑–∏—Ü–∏–π:
    """
    return llm.complete(prompt)
```

**‚úÖ –ü–†–ò–ú–ï–ù–ò–¢–¨ –≤ Concrete Agent:**
- –î–æ–±–∞–≤–∏—Ç—å –≤ `app/services/enricher.py`
- –ù–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è: `detect_missing_positions()`
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Claude –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ completeness —Å–º–µ—Ç—ã
- **Killer feature:** "AI –Ω–∞—à–µ–ª 5 –∑–∞–±—ã—Ç—ã—Ö –ø–æ–∑–∏—Ü–∏–π –Ω–∞ —Å—É–º–º—É 150 000 Kƒç"

---

### 3.2. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑—É–º–Ω–æ—Å—Ç–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤

**–ú–µ—Ö–∞–Ω–∏–∑–º:**
```python
def check_quantity_reasonableness(item):
    """–ü—Ä–æ–≤–µ—Ä–∫–∞, –Ω–µ —Å–ª–∏—à–∫–æ–º –ª–∏ quantity –±–æ–ª—å—à–æ–µ/–º–∞–ª–µ–Ω—å–∫–æ–µ"""
    reasonable_range = get_reasonable_quantity_range(item['code'])

    if not (reasonable_range[0] <= item['quantity'] <= reasonable_range[1]):
        item['quantity_warning'] = f"–ù–µ–æ–±—ã—á–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ: {item['quantity']}"
```

**–ü—Ä–∏–º–µ—Ä—ã —Ä–∞–∑—É–º–Ω—ã—Ö –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤:**
```python
REASONABLE_RANGES = {
    'R11.111.01': (10, 500),   # Skr√Ωvka ornice: 10-500 m¬≥
    'R12.101.01': (5, 100),    # Beton z√°klad≈Ø: 5-100 m¬≥
    'M11.01': (1, 1),          # Z≈ô√≠zen√≠ staveni≈°tƒõ: –≤—Å–µ–≥–¥–∞ 1 soubor
}
```

**‚úÖ –ü–†–ò–ú–ï–ù–ò–¢–¨ –≤ Concrete Agent:**
- –î–æ–±–∞–≤–∏—Ç—å validation layer –≤ audit pipeline
- –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö typical ranges –¥–ª—è –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö KROS/RTS –∫–æ–¥–æ–≤
- Warning –≤ UI: "‚ö†Ô∏è –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–µ—Ç–æ–Ω–∞ (250 m¬≥) –≤—ã—à–µ –æ–±—ã—á–Ω–æ–≥–æ –¥–ª—è –¥–∞–Ω–Ω–æ–≥–æ —Ç–∏–ø–∞ –∑–¥–∞–Ω–∏—è"

---

### 3.3. –ê–∫—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è —Ü–µ–Ω

**–ú–µ—Ö–∞–Ω–∏–∑–º:**
```python
def update_outdated_prices(item):
    """–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –∞–∫—Ç—É–∞–ª—å–Ω—ã–º–∏ —Ä—ã–Ω–æ—á–Ω—ã–º–∏ —Ü–µ–Ω–∞–º–∏"""
    current_price = get_current_market_price(item['code'])

    if price_outdated(item['unit_price'], current_price):
        item['original_price'] = item['unit_price']
        item['updated_price'] = current_price
        item['price_updated_by_ai'] = True
        item['price_difference'] = current_price - item['unit_price']
```

**‚úÖ –ü–†–ò–ú–ï–ù–ò–¢–¨ –≤ Concrete Agent:**
- –£ –Ω–∞—Å —É–∂–µ –µ—Å—Ç—å `B3_current_prices/` –≤ knowledge base
- –î–æ–±–∞–≤–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä–∏ enrichment
- UI –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä: "üí∞ –¶–µ–Ω–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∞ (+12% –∫ —Ä—ã–Ω–æ—á–Ω–æ–π)"

---

## 4. –ü–û–õ–ï–ó–ù–´–ï –ú–ï–•–ê–ù–ò–ö–ò: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–æ –æ–ø–∏—Å–∞–Ω–∏—é

### 4.1. Multi-step clarification (3 –≤–æ–ø—Ä–æ—Å–∞)

**–ü—Ä–æ—Ü–µ—Å—Å:**
```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–∞–µ—Ç –æ–±—â–µ–µ –æ–ø–∏—Å–∞–Ω–∏–µ
   ‚Üì
2. LLM –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –Ω–µ–¥–æ—Å—Ç–∞—é—â—É—é –∫—Ä–∏—Ç–∏—á–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
   ‚Üì
3. –°–∏—Å—Ç–µ–º–∞ –∑–∞–¥–∞–µ—Ç 3 —É—Ç–æ—á–Ω—è—é—â–∏—Ö –≤–æ–ø—Ä–æ—Å–∞:
   - –í–æ–ø—Ä–æ—Å 1: –ú–∞—Ç–µ—Ä–∏–∞–ª—ã –∏ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏
   - –í–æ–ø—Ä–æ—Å 2: –ö—Ä–æ–≤–ª—è –∏ —Ñ–∞—Å–∞–¥
   - –í–æ–ø—Ä–æ—Å 3: –ò–Ω–∂–µ–Ω–µ—Ä–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã
   ‚Üì
4. –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –ø–æ–ª–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
   ‚Üì
5. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–µ—Ç–∞–ª—å–Ω–æ–π —Å–º–µ—Ç—ã
```

**–ü—Ä–∏–º–µ—Ä –≤–æ–ø—Ä–æ—Å–æ–≤ RozpoƒçetPRO:**
```
Q1: "Jak√© specifick√© materi√°ly pl√°nujete pou≈æ√≠t pro z√°kladov√© konstrukce?"
Q2: "Jak√Ω typ st≈ôe≈°n√≠ krytiny a izolace preferujete?"
Q3: "Jak√© syst√©my zvol√≠te pro elekt≈ôinu, vodovod a topen√≠?"
```

**‚úÖ –ü–†–ò–ú–ï–ù–ò–¢–¨ –≤ Concrete Agent:**
- **Workflow B (Drawing Analysis)** —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Claude
- –î–æ–±–∞–≤–∏—Ç—å clarification step –ü–û–°–õ–ï –∞–Ω–∞–ª–∏–∑–∞ —á–µ—Ä—Ç–µ–∂–µ–π, –ü–ï–†–ï–î –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π –ø–æ–∑–∏—Ü–∏–π
- –ü—Ä–∏–º–µ—Ä: "–ù–∞ —á–µ—Ä—Ç–µ–∂–µ –Ω–µ —É–∫–∞–∑–∞–Ω —Ç–∏–ø —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞. –ö–∞–∫–æ–π –ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è?"
- –°–æ—Ö—Ä–∞–Ω–∏—Ç—å answers –≤ project context

---

### 4.2. Structured output –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏

**JSON Schema –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è –∫–∞—á–µ—Å—Ç–≤–∞ –≤—ã–≤–æ–¥–∞:**
```python
BudgetSchema = {
    "type": "object",
    "properties": {
        "sections": {
            "type": "array",
            "items": {
                "code": {"type": "string", "pattern": "^[MR][0-9]{2}$"},
                "items": {
                    "type": "array",
                    "items": {
                        "code": {"type": "string"},
                        "quantity": {"type": "number", "minimum": 0},
                        "unit_price": {"type": "number", "minimum": 0}
                    }
                }
            }
        }
    },
    "required": ["sections"]
}
```

**‚úÖ –ü–†–ò–ú–ï–ù–ò–¢–¨ –≤ Concrete Agent:**
- Claude API –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç JSON schema validation
- –î–æ–±–∞–≤–∏—Ç—å schemas –≤ `app/models/` –¥–ª—è –≤—Å–µ—Ö AI –æ–ø–µ—Ä–∞—Ü–∏–π:
  - `PositionSchema` (–ø–∞—Ä—Å–∏–Ω–≥)
  - `EnrichmentSchema` (–æ–±–æ–≥–∞—â–µ–Ω–∏–µ)
  - `AuditSchema` (–∞—É–¥–∏—Ç)
  - `GenerationSchema` (–≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–∑ —á–µ—Ä—Ç–µ–∂–µ–π)
- –ì–∞—Ä–∞–Ω—Ç–∏—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –≤—ã–≤–æ–¥–∞

---

### 4.3. –£–º–Ω–æ–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ–ø–∏—Å—ã–≤–∞–µ—Ç –ø—Ä–æ–µ–∫—Ç –±–µ–∑ —Ç–æ—á–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (–Ω–µ—Ç –ø–ª–æ—â–∞–¥–∏, –Ω–µ—Ç –≤—ã—Å–æ—Ç—ã)

**–†–µ—à–µ–Ω–∏–µ:**
```python
def estimate_quantities(context):
    """–†–∞–∑—É–º–Ω—ã–µ –¥–æ–ø—É—â–µ–Ω–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–∏–ø–æ–≤—ã—Ö –Ω–æ—Ä–º–∞—Ç–∏–≤–æ–≤"""

    # –ï—Å–ª–∏ –ø–ª–æ—â–∞–¥—å –Ω–µ —É–∫–∞–∑–∞–Ω–∞
    if not context.floor_area:
        estimated_area = 120  # –º¬≤ (—Ç–∏–ø–∏—á–Ω—ã–π –¥–æ–º)

    # –ü—Ä–æ–∏–∑–≤–æ–¥–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
    calculations = {
        "topsoil_removal": estimated_area * 0.25,  # –º¬≥
        "foundation_concrete": estimated_area * 0.3,  # –º¬≥
        "wall_area": estimated_area * 2.5 * 3.0,  # –º¬≤ (–≤—ã—Å–æ—Ç–∞ 3–º)
        "roof_area": estimated_area * 1.3,  # –º¬≤ (+30% –Ω–∞ —Å–∫–∞—Ç—ã)
    }

    return calculations
```

**–¢–∏–ø–æ–≤—ã–µ –Ω–æ—Ä–º–∞—Ç–∏–≤—ã:**
```python
TYPICAL_NORMS = {
    "house_area_per_person": 30,  # –º¬≤/—á–µ–ª–æ–≤–µ–∫
    "ceiling_height": 3.0,  # –º (—Å—Ç–∞–Ω–¥–∞—Ä—Ç)
    "wall_thickness": 0.4,  # –º (Porotherm 40)
    "insulation_thickness": 0.15,  # –º (–º–∏–Ω–≤–∞—Ç–∞)
    "concrete_per_m2_foundation": 0.3,  # –º¬≥/–º¬≤
    "rebar_per_m3_concrete": 80,  # –∫–≥/–º¬≥
}
```

**‚úÖ –ü–†–ò–ú–ï–ù–ò–¢–¨ –≤ Concrete Agent:**
- –°–æ–∑–¥–∞—Ç—å `app/utils/quantity_estimator.py`
- –ë–∞–∑–∞ —Ç–∏–ø–æ–≤—ã—Ö –Ω–æ—Ä–º–∞—Ç–∏–≤–æ–≤ –¥–ª—è Czech/Slovak —Å—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–∞
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ Workflow B –∫–æ–≥–¥–∞ GPT-4 Vision –Ω–µ –º–æ–∂–µ—Ç —Ç–æ—á–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ä–∞–∑–º–µ—Ä—ã
- UI –∏–Ω–¥–∏–∫–∞—Ü–∏—è: "‚ö†Ô∏è –ü–ª–æ—â–∞–¥—å –æ—Ü–µ–Ω–µ–Ω–∞ (120 –º¬≤). –£—Ç–æ—á–Ω–∏—Ç–µ –¥–ª—è —Ç–æ—á–Ω–æ–≥–æ —Ä–∞—Å—á–µ—Ç–∞."

---

## 5. –ò–ù–¢–ï–ì–†–ê–¶–ò–Ø JKSO –≤ Concrete Agent

### 5.1. –ó–∞—á–µ–º –Ω—É–∂–Ω–∞ JKSO?

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
1. **–°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏—è** - –µ–¥–∏–Ω–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –¥–ª—è CZ/SK —Ä—ã–Ω–∫–∞
2. **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å** - –æ–±–º–µ–Ω —Å–º–µ—Ç–∞–º–∏ —Å –¥—Ä—É–≥–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏
3. **Reporting** - —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –æ—Ç—á–µ—Ç—ã –¥–ª—è –≥–æ—Å–∑–∞–∫–∞–∑–æ–≤
4. **Market positioning** - "–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤—Å–µ—Ö —Å—Ç–∞–Ω–¥–∞—Ä—Ç–æ–≤: JKSO, KROS, RTS, OTSKP"

**–ù–∞—à–∞ —Ç–µ–∫—É—â–∞—è —Å–∏—Ç—É–∞—Ü–∏—è:**
```
‚úÖ KROS (Slovakia) - –ø–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞
‚úÖ RTS (Slovakia) - –ø–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞
‚úÖ OTSKP (Czech Republic) - –µ—Å—Ç—å –≤ KB, –Ω–æ –Ω–µ –æ—Å–Ω–æ–≤–Ω–æ–π
‚ùå JKSO (CZ/SK unified) - –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç
```

### 5.2. –ü–ª–∞–Ω –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ JKSO

**–®–∞–≥ 1: –°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö**
- –°–∫—Ä–∞–ø–∏–Ω–≥ https://www.stavebnistandardy.cz/
- –ü–∞—Ä—Å–∏–Ω–≥ JKSO –∏–µ—Ä–∞—Ä—Ö–∏–∏ (M11 ‚Üí M11.01 ‚Üí M11.01.001)
- –°–æ–∑–¥–∞–Ω–∏–µ JSON database: `app/knowledge_base/B1_jkso_codes/`

**–®–∞–≥ 2: Mapping –Ω–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç—ã**
```python
# app/knowledge_base/mappings/jkso_to_kros.json
{
    "M11": {
        "jkso_code": "M11",
        "jkso_name": "P≈ô√≠pravn√© pr√°ce",
        "kros_equivalent": "0",
        "kros_name": "Pr√≠pravn√© pr√°ce"
    },
    "R11.111.01": {
        "jkso_code": "R11.111.01",
        "jkso_name": "Skr√Ωvka ornice",
        "kros_equivalent": "111111101",
        "kros_name": "Skr√Ωvka ornice"
    }
}
```

**–®–∞–≥ 3: Enricher update**
```python
# app/services/enricher.py
def enrich_with_jkso(position):
    """–î–æ–±–∞–≤–ª–µ–Ω–∏–µ JKSO –∫–æ–¥–∞ –∫ –ø–æ–∑–∏—Ü–∏–∏"""
    if position.get('kros_code'):
        jkso_code = kros_to_jkso_mapping.get(position['kros_code'])
        position['jkso_code'] = jkso_code
        position['jkso_name'] = get_jkso_name(jkso_code)
    return position
```

**–®–∞–≥ 4: Export –≤ JKSO —Ñ–æ—Ä–º–∞—Ç–µ**
```python
# app/services/exporters/jkso_exporter.py
def export_to_jkso_excel(project):
    """–≠–∫—Å–ø–æ—Ä—Ç –≤ —Ñ–æ—Ä–º–∞—Ç–µ JKSO –¥–ª—è Czech market"""
    workbook = openpyxl.Workbook()
    sheet = workbook.active

    # Headers –ø–æ JKSO —Å—Ç–∞–Ω–¥–∞—Ä—Ç—É
    sheet['A1'] = 'K√≥d JKSO'
    sheet['B1'] = 'N√°zev polo≈æky'
    sheet['C1'] = 'Mno≈æstv√≠'
    sheet['D1'] = 'MJ'
    sheet['E1'] = 'Cena/MJ'
    sheet['F1'] = 'Celkem'

    # ... –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
```

---

## 6. –ü–†–ò–û–†–ò–¢–ò–ó–ê–¶–ò–Ø: –ß—Ç–æ –≤–Ω–µ–¥—Ä—è—Ç—å –≤ –ø–µ—Ä–≤—É—é –æ—á–µ—Ä–µ–¥—å

### –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (–°–µ–π—á–∞—Å)

**1. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏—Ö –ø–æ–∑–∏—Ü–∏–π** ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê
- **Impact:** –û–ß–ï–ù–¨ –≤—ã—Å–æ–∫–∏–π (killer feature)
- **Effort:** –°—Ä–µ–¥–Ω–∏–π (1-2 –¥–Ω—è)
- **Implementation:**
  - –î–æ–±–∞–≤–∏—Ç—å `detect_missing_positions()` –≤ enricher
  - Claude –ø—Ä–æ–º–ø—Ç —Å —Ç–∏–ø–æ–≤—ã–º–∏ –∑–∞–±—ã—Ç—ã–º–∏ –ø–æ–∑–∏—Ü–∏—è–º–∏
  - UI: "üîç AI –Ω–∞—à–µ–ª 5 –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏–π"

**2. –£–º–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ header row** ‚≠ê‚≠ê‚≠ê‚≠ê
- **Impact:** –í—ã—Å–æ–∫–∏–π (—Ä–æ–±–∞—Å—Ç–Ω–æ—Å—Ç—å –ø–∞—Ä—Å–∏–Ω–≥–∞)
- **Effort:** –ù–∏–∑–∫–∏–π (–Ω–µ—Å–∫–æ–ª—å–∫–æ —á–∞—Å–æ–≤)
- **Implementation:**
  - –î–æ–±–∞–≤–∏—Ç—å `detect_header_row()` –≤ ExcelParser
  - Regex patterns –¥–ª—è Czech/Slovak —Ç–µ—Ä–º–∏–Ω–æ–≤

**3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑—É–º–Ω–æ—Å—Ç–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤** ‚≠ê‚≠ê‚≠ê‚≠ê
- **Impact:** –í—ã—Å–æ–∫–∏–π (quality control)
- **Effort:** –°—Ä–µ–¥–Ω–∏–π (1 –¥–µ–Ω—å)
- **Implementation:**
  - –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö typical ranges
  - Validation –≤ audit pipeline
  - Warnings –≤ UI

### –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (–°–ª–µ–¥—É—é—â–∏–µ 2 –Ω–µ–¥–µ–ª–∏)

**4. Structured output –¥–ª—è –≤—Å–µ—Ö AI –æ–ø–µ—Ä–∞—Ü–∏–π** ‚≠ê‚≠ê‚≠ê
- **Impact:** –°—Ä–µ–¥–Ω–∏–π (–∫–∞—á–µ—Å—Ç–≤–æ, –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å)
- **Effort:** –°—Ä–µ–¥–Ω–∏–π (2-3 –¥–Ω—è)
- **Implementation:**
  - Pydantic schemas –¥–ª—è –≤—Å–µ—Ö AI responses
  - JSON schema validation –≤ Claude API calls

**5. Multi-step clarification –¥–ª—è Workflow B** ‚≠ê‚≠ê‚≠ê
- **Impact:** –°—Ä–µ–¥–Ω–∏–π-–í—ã—Å–æ–∫–∏–π (—É–ª—É—á—à–µ–Ω–∏–µ UX)
- **Effort:** –í—ã—Å–æ–∫–∏–π (3-5 –¥–Ω–µ–π)
- **Implementation:**
  - –î–æ–±–∞–≤–∏—Ç—å clarification step –ø–æ—Å–ª–µ GPT-4 Vision –∞–Ω–∞–ª–∏–∑–∞
  - 2-3 —É—Ç–æ—á–Ω—è—é—â–∏—Ö –≤–æ–ø—Ä–æ—Å–∞ –ø–µ—Ä–µ–¥ –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π –ø–æ–∑–∏—Ü–∏–π
  - UI: –¥–∏–∞–ª–æ–≥–æ–≤—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

### –ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (Backlog)

**6. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è JKSO** ‚≠ê‚≠ê
- **Impact:** –ù–∏–∑–∫–∏–π-–°—Ä–µ–¥–Ω–∏–π (market positioning)
- **Effort:** –í—ã—Å–æ–∫–∏–π (1-2 –Ω–µ–¥–µ–ª–∏)
- **Implementation:**
  - –°–∫—Ä–∞–ø–∏–Ω–≥ JKSO database
  - Mapping –Ω–∞ KROS/RTS/OTSKP
  - Export –≤ JKSO —Ñ–æ—Ä–º–∞—Ç–µ

**7. Quantity estimation engine** ‚≠ê‚≠ê
- **Impact:** –°—Ä–µ–¥–Ω–∏–π (—É–¥–æ–±—Å—Ç–≤–æ –¥–ª—è –Ω–µ–ø–æ–ª–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö)
- **Effort:** –í—ã—Å–æ–∫–∏–π (2 –Ω–µ–¥–µ–ª–∏)
- **Implementation:**
  - –ë–∞–∑–∞ —Ç–∏–ø–æ–≤—ã—Ö –Ω–æ—Ä–º–∞—Ç–∏–≤–æ–≤
  - Calculation engine
  - Integration –≤ Workflow B

---

## 7. –ö–†–ê–¢–ö–ò–ô –ü–õ–ê–ù –î–ï–ô–°–¢–í–ò–ô

### –ù–µ–¥–µ–ª—è 1: Quick Wins

```
‚úÖ –î–µ–Ω—å 1-2: –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏—Ö –ø–æ–∑–∏—Ü–∏–π
  - –§–∞–π–ª: app/services/missing_positions_detector.py
  - –ü—Ä–æ–º–ø—Ç –¥–ª—è Claude
  - UI integration –≤ audit results

‚úÖ –î–µ–Ω—å 3: –£–º–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ header row
  - –§–∞–π–ª: app/parsers/excel_parser.py
  - Regex patterns
  - Unit tests

‚úÖ –î–µ–Ω—å 4-5: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑—É–º–Ω–æ—Å—Ç–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤
  - –§–∞–π–ª: app/validators/quantity_validator.py
  - –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö ranges
  - Warnings –≤ audit
```

### –ù–µ–¥–µ–ª—è 2-3: Advanced Features

```
‚úÖ Structured output schemas
  - –§–∞–π–ª: app/models/ai_schemas.py
  - Integration –≤ claude_client.py
  - Validation tests

‚úÖ Multi-step clarification (Workflow B)
  - –§–∞–π–ª: app/services/workflow_b_clarification.py
  - UI: clarification dialog
  - Context management
```

### Backlog (Phase 5?)

```
‚¨ú JKSO integration
‚¨ú Quantity estimation engine
‚¨ú Advanced hierarchy detection
```

---

## 8. –ö–õ–Æ–ß–ï–í–´–ï –í–´–í–û–î–´

### –ß—Ç–æ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç –¥–µ–ª–∞–µ—Ç –û–¢–õ–ò–ß–ù–û:

1. **–£–º–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥** - —Ä–æ–±–∞—Å—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≥—Ä—è–∑–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
2. **AI-–æ–±–æ–≥–∞—â–µ–Ω–∏–µ** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ —Å–º–µ—Ç
3. **Multi-step UX** - –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –≤—Å–µ –¥–∞–Ω–Ω—ã–µ —Å—Ä–∞–∑—É
4. **Structured output** - –≥–∞—Ä–∞–Ω—Ç–∏—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏
5. **Standards compliance** - –ø–æ–¥–¥–µ—Ä–∂–∫–∞ JKSO

### –ß—Ç–æ –ú–´ –¥–µ–ª–∞–µ–º –õ–£–ß–®–ï:

1. **Multi-Role Audit** - 6 —ç–∫—Å–ø–µ—Ä—Ç–æ–≤ vs –∏—Ö 1 AI
2. **GPT-4 Vision** - –∞–Ω–∞–ª–∏–∑ —á–µ—Ä—Ç–µ–∂–µ–π vs —Ç–æ–ª—å–∫–æ —Ç–µ–∫—Å—Ç
3. **Editable Artifacts** - live recalculation vs static
4. **Deep Standards** - KROS + RTS + OTSKP vs —Ç–æ–ª—å–∫–æ JKSO
5. **Experience Database** - learning from history

### –ß—Ç–æ –ù–ê–î–û –ê–î–ê–ü–¢–ò–†–û–í–ê–¢–¨:

‚úÖ **–°–µ–π—á–∞—Å:**
- –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏—Ö –ø–æ–∑–∏—Ü–∏–π (killer feature!)
- –£–º–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ header row
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑—É–º–Ω–æ—Å—Ç–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤

‚úÖ **–°–∫–æ—Ä–æ:**
- Structured output
- Multi-step clarification

‚¨ú **–ü–æ—Ç–æ–º:**
- JKSO integration
- Quantity estimation

---

**–ò—Ç–æ–≥:** RozpoƒçetPRO - —Å–∏–ª—å–Ω—ã–π –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç –≤ SMB —Å–µ–≥–º–µ–Ω—Ç–µ, –Ω–æ –º—ã –∏–≥—Ä–∞–µ–º –≤ –¥—Ä—É–≥–æ–π –ª–∏–≥–µ (Enterprise). –ò—Ö –º–µ—Ö–∞–Ω–∏–∫–∏ –ø–∞—Ä—Å–∏–Ω–≥–∞ –∏ AI-–æ–±–æ–≥–∞—â–µ–Ω–∏—è –º–æ–∂–Ω–æ –∏ –Ω—É–∂–Ω–æ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–ª—è —É—Å–∏–ª–µ–Ω–∏—è Concrete Agent.
