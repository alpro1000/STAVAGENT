# ğŸ—ï¸ ESTIMATE AUTOMATION PLATFORM - Systems Integration Map

> **Ğ“ĞµĞ½ĞµÑ€Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚ Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ğ¸ Ğ´Ğ²ÑƒÑ… ÑĞ¸ÑÑ‚ĞµĞ¼: Monolit-Planner (Frontend) + Concrete-Agent (CORE Engine)**
>
> **Ğ’ĞµÑ€ÑĞ¸Ñ:** 1.0
> **Ğ”Ğ°Ñ‚Ğ°:** 2025-11-14
> **Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ:** ğŸš€ IN DEVELOPMENT

---

## ğŸ“ Ğ“Ğ´Ğµ Ğ½Ğ°Ñ…Ğ¾Ğ´ÑÑ‚ÑÑ ÑĞ¸ÑÑ‚ĞµĞ¼Ñ‹

### Frontend / Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°Ğ¼Ğ¸
- **Ğ ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ¹:** `/home/user/Monolit-Planner` (Ğ»Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ğ¾)
- **GitHub:** https://github.com/alpro1000/Monolit-Planner
- **Deployment:** https://monolit-planner-frontend.onrender.com (React SPA)
- **Backend:** https://monolit-planner-api.onrender.com (Express 3001)
- **Ğ¡Ñ‚ĞµĞº:** React 18 + TypeScript, Express.js, PostgreSQL/SQLite, Vite

### CORE Engine / AI ĞĞ½Ğ°Ğ»Ğ¸Ğ·
- **Ğ ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ¹:** `git clone https://github.com/alpro1000/concrete-agent.git`
- **Deployment:** https://concrete-agent.onrender.com (FastAPI 8000)
- **Ğ¡Ñ‚ĞµĞº:** Python 3.10+, FastAPI, Knowledge Base (B1-B9), Claude AI
- **ĞÑĞ½Ğ¾Ğ²Ğ½Ğ¾Ğµ:** ĞŸĞ°Ñ€ÑĞ¸Ğ½Ğ³ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ¾Ğ², Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ· Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ¾Ğ², Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ ÑĞ¼ĞµÑ‚

---

## ğŸ”„ ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° ÑĞ¸ÑÑ‚ĞµĞ¼Ñ‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   ESTIMATE AUTOMATION PLATFORM                          â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚           TIER 1: FRONTEND (React + Express)                     â”‚   â”‚
â”‚  â”‚           https://monolit-planner-frontend.onrender.com          â”‚   â”‚
â”‚  â”‚           Backend: https://monolit-planner-api.onrender.com      â”‚   â”‚
â”‚  â”‚                                                                   â”‚   â”‚
â”‚  â”‚  âœ… DONE:                                                        â”‚   â”‚
â”‚  â”‚  â”œâ”€ Auth (email verification, 2FA)                             â”‚   â”‚
â”‚  â”‚  â”œâ”€ Project Management (create, view, edit, delete)            â”‚   â”‚
â”‚  â”‚  â”œâ”€ User Management (profiles, dashboard)                      â”‚   â”‚
â”‚  â”‚  â”œâ”€ Admin Panel (user control, audit logs)                     â”‚   â”‚
â”‚  â”‚  â”œâ”€ OTSKP Code Search (17,904 codes)                          â”‚   â”‚
â”‚  â”‚  â””â”€ Snapshots/Versioning                                       â”‚   â”‚
â”‚  â”‚                                                                   â”‚   â”‚
â”‚  â”‚  ğŸ”² TO DO:                                                      â”‚   â”‚
â”‚  â”‚  â”œâ”€ Document Upload UI                                         â”‚   â”‚
â”‚  â”‚  â”œâ”€ Project Analysis Display                                   â”‚   â”‚
â”‚  â”‚  â”œâ”€ Work List Builder                                          â”‚   â”‚
â”‚  â”‚  â”œâ”€ Calculator Integration (Kioski)                            â”‚   â”‚
â”‚  â”‚  â””â”€ Estimate Preview & Export                                  â”‚   â”‚
â”‚  â”‚                                                                   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                  â†• REST API                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚         TIER 2: BACKEND API (Express 3001)                     â”‚   â”‚
â”‚  â”‚         Already implemented routes:                             â”‚   â”‚
â”‚  â”‚                                                                   â”‚   â”‚
â”‚  â”‚  GET/POST  /api/auth/* .............. Authentication           â”‚   â”‚
â”‚  â”‚  GET/POST  /api/monolith-projects/* . Project management       â”‚   â”‚
â”‚  â”‚  GET/POST  /api/positions/* ......... Positions/works          â”‚   â”‚
â”‚  â”‚  GET       /api/otskp/* ............ OTSKP code search        â”‚   â”‚
â”‚  â”‚  GET/POST  /api/admin/* ............ Admin panel               â”‚   â”‚
â”‚  â”‚                                                                   â”‚   â”‚
â”‚  â”‚  ğŸ”² NEW routes (to implement):                                 â”‚   â”‚
â”‚  â”‚  POST      /api/documents/upload ... Document ingestion        â”‚   â”‚
â”‚  â”‚  GET       /api/core/analyze/:id ... Call CORE Engine          â”‚   â”‚
â”‚  â”‚  GET       /api/estimates/... ...... Estimate management       â”‚   â”‚
â”‚  â”‚  POST      /api/calculators/* ...... Kiosk calculator calls    â”‚   â”‚
â”‚  â”‚                                                                   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                  â†• HTTP                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚      TIER 3: CORE ENGINE (Python FastAPI 8000)                 â”‚   â”‚
â”‚  â”‚      https://concrete-agent.onrender.com                        â”‚   â”‚
â”‚  â”‚                                                                   â”‚   â”‚
â”‚  â”‚  âœ… WORKFLOWS ALREADY IMPLEMENTED:                             â”‚   â”‚
â”‚  â”‚                                                                   â”‚   â”‚
â”‚  â”‚  Workflow A: Import & Audit                                   â”‚   â”‚
â”‚  â”‚  â”œâ”€ POST /workflow-a/start ......... Upload KROS/Excel       â”‚   â”‚
â”‚  â”‚  â”œâ”€ POST /workflow-a/audit ........ Multi-role validation    â”‚   â”‚
â”‚  â”‚  â”œâ”€ POST /workflow-a/enrich ....... AI enrichment            â”‚   â”‚
â”‚  â”‚  â””â”€ GET  /workflow-a/positions .... Get parsed positions     â”‚   â”‚
â”‚  â”‚                                                                   â”‚   â”‚
â”‚  â”‚  Workflow B: Generate from Drawings                           â”‚   â”‚
â”‚  â”‚  â”œâ”€ POST /workflow-b/start ........ Upload PDFs/images       â”‚   â”‚
â”‚  â”‚  â”œâ”€ POST /workflow-b/analyze ...... OCR + AI analysis        â”‚   â”‚
â”‚  â”‚  â””â”€ GET  /workflow-b/results ...... Generated positions      â”‚   â”‚
â”‚  â”‚                                                                   â”‚   â”‚
â”‚  â”‚  Chat/Conversational:                                          â”‚   â”‚
â”‚  â”‚  â”œâ”€ POST /chat/message ............ Chat with system         â”‚   â”‚
â”‚  â”‚  â””â”€ POST /chat/analyze-drawing .... Ask about document       â”‚   â”‚
â”‚  â”‚                                                                   â”‚   â”‚
â”‚  â”‚  Knowledge Base:                                               â”‚   â”‚
â”‚  â”‚  â”œâ”€ GET  /kb/search .............. Search (B1-B9)           â”‚   â”‚
â”‚  â”‚  â””â”€ POST /kb/enrich .............. Live KB enrichment        â”‚   â”‚
â”‚  â”‚                                                                   â”‚   â”‚
â”‚  â”‚  Resource Calculation:                                         â”‚   â”‚
â”‚  â”‚  â”œâ”€ POST /resources/tech-card ...... Technical card gen      â”‚   â”‚
â”‚  â”‚  â”œâ”€ POST /resources/materials ...... Material list gen        â”‚   â”‚
â”‚  â”‚  â””â”€ POST /resources/labor ......... Labor hours calc         â”‚   â”‚
â”‚  â”‚                                                                   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                  â†• HTTP                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚     TIER 4: SPECIALIZED CALCULATORS (Kioski)                  â”‚   â”‚
â”‚  â”‚     Optional microservices (could run on 9001-9006)           â”‚   â”‚
â”‚  â”‚                                                                   â”‚   â”‚
â”‚  â”‚  POST /calculate/bridge ........... Bridge kià¥‹sk (9001)        â”‚   â”‚
â”‚  â”‚  POST /calculate/building ......... Building kiosk (9002)     â”‚   â”‚
â”‚  â”‚  POST /calculate/parking .......... Parking kiosk (9003)      â”‚   â”‚
â”‚  â”‚  POST /calculate/road ............ Road kiosk (9004)          â”‚   â”‚
â”‚  â”‚  POST /calculate/delivery ........ Delivery kiosk (9005)      â”‚   â”‚
â”‚  â”‚  POST /calculate/labor ........... Labor kiosk (9006)         â”‚   â”‚
â”‚  â”‚                                                                   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚         TIER 5: DATA LAYER (PostgreSQL)                        â”‚   â”‚
â”‚  â”‚         Single source of truth                                 â”‚   â”‚
â”‚  â”‚                                                                   â”‚   â”‚
â”‚  â”‚  DB Tables (Monolit-Planner):                                 â”‚   â”‚
â”‚  â”‚  â”œâ”€ users, monolith_projects, positions, parts              â”‚   â”‚
â”‚  â”‚  â”œâ”€ otskp_codes (17,904 codes), snapshots                   â”‚   â”‚
â”‚  â”‚  â”œâ”€ estimates, estimate_lines (NEW)                         â”‚   â”‚
â”‚  â”‚  â”œâ”€ work_catalog, work_templates (NEW)                      â”‚   â”‚
â”‚  â”‚  â””â”€ chat_sessions, chat_messages (NEW)                      â”‚   â”‚
â”‚  â”‚                                                                   â”‚   â”‚
â”‚  â”‚  Knowledge Base (Concrete-Agent):                             â”‚   â”‚
â”‚  â”‚  â”œâ”€ B1_Normy_Standardy (Standards)                          â”‚   â”‚
â”‚  â”‚  â”œâ”€ B2_Tech_Cards (Technical cards)                         â”‚   â”‚
â”‚  â”‚  â”œâ”€ B3_Pricing (Price lists)                                â”‚   â”‚
â”‚  â”‚  â”œâ”€ B4_Historical (Historical projects)                     â”‚   â”‚
â”‚  â”‚  â”œâ”€ B5_URS_KROS4 (Catalog codes)                            â”‚   â”‚
â”‚  â”‚  â”œâ”€ B6_RTS (Regional standards)                             â”‚   â”‚
â”‚  â”‚  â”œâ”€ B7_Company_Rules (Custom rules)                         â”‚   â”‚
â”‚  â”‚  â””â”€ B8_Templates (Work templates)                           â”‚   â”‚
â”‚  â”‚                                                                   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”Œ Integration Points

### 1. Document Upload & Analysis

**Flow:**
```
User uploads PDF/Excel in Monolit-Planner
    â†“
POST /api/documents/upload (Express backend)
    â†“
Express forwards to Concrete-Agent:
POST https://concrete-agent.onrender.com/workflow-a/start
    â†“
CORE Engine parses document (OCR, tables, text extraction)
    â†“
Response: {
  "positions": [...],
  "materials": {...},
  "concrete_volume": 350,
  "analysis": {...}
}
    â†“
Express saves to DB, returns to frontend
    â†“
Frontend displays preview for user confirmation
```

**Endpoints to implement in Express:**
```javascript
// backend/src/routes/documents.js
POST /api/documents/upload
  - Validate file (PDF, Excel, JPG, PNG)
  - Store temporarily
  - Call CORE Engine
  - Save analysis results
  - Return analysis to frontend

GET /api/documents/:id/analysis
  - Get stored analysis results

POST /api/documents/:id/confirm
  - User confirms analysis
  - Save as project positions
```

---

### 2. Project Analysis

**CORE Engine does:**
- ğŸ” Document scanning (OCR for drawings)
- ğŸ—ï¸ Project type detection (bridge/building/parking/road)
- ğŸ“ Dimension extraction (lengths, widths, heights, areas)
- ğŸ”¨ Work list generation (what works needed)
- â™»ï¸ Knowledge Base matching (similar projects)
- ğŸ“Š Resource calculation (materials, labor hours)

**Frontend displays:**
- Project summary (type, size, phases)
- Proposed work list (with AI confidence)
- Material requirements (concrete, rebar, etc.)
- Estimated man-hours

---

### 3. Calculator Integration (Kioski)

**Example: Bridge Calculator**

```
Frontend shows: "Calculate concrete volume for foundation"
    â†“
POST /api/calculators/bridge {
  "volume_type": "foundation",
  "length": 45,
  "width": 12,
  "depth": 2.5,
  "concrete_class": "C30/37"
}
    â†“
Express calls Concrete-Agent (or separate calculator service):
POST https://concrete-agent.onrender.com/calculate/bridge
    â†“
Returns: {
  "volume_m3": 1350,
  "hours_pouring": 136,
  "machine_hours": 68,
  "materials": {
    "cement": 405000,  // kg
    "sand": 810000,    // kg
    "gravel": 1350000  // kg
  }
}
    â†“
Frontend displays results, user confirms
    â†“
Adds position to estimate
```

---

### 4. Catalog Matching (OTSKP + URS codes)

**Current flow:**
```
User has work description: "Ğ£ÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ²Ğ¾ Ñ„ÑƒĞ½Ğ´Ğ°Ğ¼ĞµĞ½Ñ‚Ğ° Ğ¸Ğ· Ğ±ĞµÑ‚Ğ¾Ğ½Ğ° C30/37"
    â†“
Search OTSKP codes in Monolit-Planner DB
    â†“
Returns: [SO0101, SO0102, SO0105, ...]
    â†“
User selects matching codes
```

**Enhanced flow (with CORE):**
```
CORE Engine can also help:
1. Semantic search (find similar works in KB)
2. Suggest alternative codes (URS, KROS)
3. Check if position matches standards
4. Validate materials against standards
```

---

### 5. Estimate Generation

**Flow:**
```
User clicks "Generate Estimate"
    â†“
Express collects all data:
- Project type & dimensions
- Analyzed works (from CORE)
- Calculator results (material volumes, hours)
- Selected OTSKP codes
- Materials list
    â†“
POST /api/estimates/generate
    â†“
Express orchestrates:
1. Validate all data
2. Call CORE for final enrichment
3. Assemble positions
4. Save to DB
5. Generate PDF (blind estimate - Ğ±ĞµĞ· Ñ†ĞµĞ½)
    â†“
Frontend displays preview
User can:
- Edit individual lines
- Add/remove positions
- Export to PDF/Excel
```

---

## ğŸš€ Implementation Roadmap

### Phase 4: Document Upload & Analysis (2-3 Ğ´Ğ½Ñ–)
**Backend (Express):**
```
âœ… DONE: Auth, projects, admin
ğŸ”² TODO: documents.js routes
         â”œâ”€ POST /api/documents/upload
         â”œâ”€ GET /api/documents/:id
         â””â”€ POST /api/documents/:id/analyze (call CORE)

Files to create:
- backend/src/routes/documents.js
- backend/src/services/concreteAgentClient.js (HTTP wrapper)
- backend/src/db/migrations.js (add document/analysis tables)
```

**Frontend (React):**
```
ğŸ”² TODO: Document upload UI
         â”œâ”€ DocumentUpload.tsx (drag-drop, file select)
         â”œâ”€ AnalysisPreview.tsx (show CORE results)
         â””â”€ AnalysisConfirm.tsx (approve before saving)

Files to create:
- frontend/src/pages/DocumentUploadPage.tsx
- frontend/src/components/DocumentUpload.tsx
- frontend/src/components/AnalysisPreview.tsx
```

---

### Phase 5: Work List Generation & Enrichment (2-3 Ğ´Ğ½Ñ–)
**Backend:**
```
ğŸ”² TODO: workList.js routes
         â”œâ”€ POST /api/work-lists/generate
         â”œâ”€ GET /api/work-lists/:id
         â””â”€ PUT /api/work-lists/:id (approve)

Services:
- workListGenerator.js (orchestrate CORE calls)
- workTemplateMatchers.js (match similar projects)
```

**Frontend:**
```
ğŸ”² TODO: Work list UI
         â”œâ”€ WorkListGenerator.tsx
         â”œâ”€ WorkListEditor.tsx
         â””â”€ WorkListPreview.tsx
```

---

### Phase 6: Calculator Integration (3-4 Ğ´Ğ½Ñ–)
**Backend:**
```
ğŸ”² TODO: calculators.js routes
         â”œâ”€ POST /api/calculators/bridge
         â”œâ”€ POST /api/calculators/building
         â”œâ”€ POST /api/calculators/parking
         â”œâ”€ POST /api/calculators/road
         â””â”€ POST /api/calculators/delivery

Integration with CORE:
- Call Concrete-Agent /calculate/* endpoints
- Cache results
- Save to DB
```

**Frontend:**
```
ğŸ”² TODO: Calculator UI
         â”œâ”€ BridgeCalculator.tsx
         â”œâ”€ BuildingCalculator.tsx
         â”œâ”€ ParkingCalculator.tsx
         â”œâ”€ RoadCalculator.tsx
         â””â”€ DeliveryCalculator.tsx
```

---

### Phase 7: Estimate Assembly & Export (2-3 Ğ´Ğ½Ñ–)
**Backend:**
```
ğŸ”² TODO: estimates.js routes (UPDATE existing!)
         â”œâ”€ POST /api/estimates/generate
         â”œâ”€ GET /api/estimates/:id
         â”œâ”€ PUT /api/estimates/:id (edit)
         â”œâ”€ POST /api/estimates/:id/export (PDF)
         â””â”€ POST /api/estimates/:id/finalize

Services:
- estimateGenerator.js (assemble all data)
- estimateExporter.js (PDF generation)
```

**Frontend:**
```
ğŸ”² TODO: Estimate UI
         â”œâ”€ EstimateBuilder.tsx
         â”œâ”€ EstimatePreview.tsx
         â”œâ”€ EstimateExport.tsx
         â””â”€ EstimateHistory.tsx
```

---

## ğŸ”— API Endpoints Reference

### Concrete-Agent (CORE) Endpoints

All endpoints at: `https://concrete-agent.onrender.com`

**Workflow A (Import & Audit):**
```
POST /workflow-a/start
  Input: KROS/Excel file
  Returns: parsed positions

POST /workflow-a/audit
  Input: positions
  Returns: audit results (GREEN/AMBER/RED)

POST /workflow-a/enrich
  Input: positions
  Returns: enriched with materials, labor

POST /workflow-a/tech-card
  Input: position
  Returns: technical card (detailed breakdown)

GET /workflow-a/positions
  Returns: all parsed positions
```

**Workflow B (Generate from Drawings):**
```
POST /workflow-b/start
  Input: PDF/images of drawings
  Returns: analysis

POST /workflow-b/analyze
  Input: project type, drawing
  Returns: extracted dimensions, work list

GET /workflow-b/results
  Returns: generated positions
```

**Chat:**
```
POST /chat/message
  Input: user message, context
  Returns: assistant response

POST /chat/analyze-drawing
  Input: drawing image
  Returns: analysis of what's in drawing
```

**Knowledge Base:**
```
GET /kb/search?query=Ñ„ÑƒĞ½Ğ´Ğ°Ğ¼ĞµĞ½Ñ‚&category=B5_URS_KROS4
  Returns: matching codes from KB

POST /kb/enrich
  Input: position
  Returns: enriched with KB data
```

**Resources:**
```
POST /resources/tech-card
  Input: position
  Returns: technical breakdown

POST /resources/materials
  Input: position
  Returns: materials list

POST /resources/labor
  Input: position, crew size
  Returns: labor hours
```

---

## ğŸ—„ï¸ New Database Tables (PostgreSQL)

```sql
-- Documents uploaded for analysis
CREATE TABLE documents (
  id TEXT PRIMARY KEY,
  project_id TEXT,
  user_id INTEGER,
  file_name TEXT,
  file_type TEXT,  -- 'pdf', 'excel', 'image'
  file_path TEXT,
  analysis_status TEXT,  -- 'pending', 'processing', 'done', 'error'
  analysis_data JSON,
  core_response JSON,
  created_at TIMESTAMP,
  FOREIGN KEY (project_id) REFERENCES monolith_projects(project_id),
  FOREIGN KEY (user_id) REFERENCES users(id)
);

-- Analysis results from CORE Engine
CREATE TABLE document_analyses (
  id TEXT PRIMARY KEY,
  document_id TEXT,
  project_type TEXT,  -- 'bridge', 'building', etc
  dimensions JSON,    -- { length, width, height, area, etc }
  work_list JSON,     -- proposed list of works
  materials JSON,     -- material requirements
  confidence REAL,    -- 0-1
  created_at TIMESTAMP,
  FOREIGN KEY (document_id) REFERENCES documents(id)
);

-- Work lists (generated or manual)
CREATE TABLE work_lists (
  id TEXT PRIMARY KEY,
  project_id TEXT,
  analysis_id TEXT,
  status TEXT,  -- 'draft', 'approved', 'finalized'
  work_items JSON,  -- array of { name, description, volume, unit, hours }
  created_at TIMESTAMP,
  updated_at TIMESTAMP,
  FOREIGN KEY (project_id) REFERENCES monolith_projects(project_id),
  FOREIGN KEY (analysis_id) REFERENCES document_analyses(id)
);

-- Calculator results
CREATE TABLE calculator_results (
  id TEXT PRIMARY KEY,
  estimate_id TEXT,
  calculator_type TEXT,  -- 'bridge', 'building', 'delivery', etc
  input_params JSON,
  results JSON,  -- { volume, hours, materials, costs }
  created_at TIMESTAMP
);

-- Generated estimates (final smetÑ‹)
CREATE TABLE estimates (
  id TEXT PRIMARY KEY,
  project_id TEXT,
  work_list_id TEXT,
  status TEXT,  -- 'draft', 'ready', 'exported'
  estimate_lines JSON,  -- array of estimate lines
  total_volume REAL,
  total_hours REAL,
  materials_summary JSON,
  exported_at TIMESTAMP,
  exported_format TEXT,  -- 'pdf', 'excel'
  created_at TIMESTAMP,
  FOREIGN KEY (project_id) REFERENCES monolith_projects(project_id),
  FOREIGN KEY (work_list_id) REFERENCES work_lists(id)
);
```

---

## ğŸ” Environment Variables

### Monolit-Planner Backend (.env)
```env
# Concrete-Agent integration
CONCRETE_AGENT_URL=https://concrete-agent.onrender.com
CONCRETE_AGENT_TIMEOUT=60000  # ms

# Optional: if running locally
CONCRETE_AGENT_LOCAL=false
CONCRETE_AGENT_LOCAL_PORT=8000
```

### Concrete-Agent (.env) - already configured
```env
ANTHROPIC_API_KEY=sk-ant-...
OPENAI_API_KEY=sk-...  # Optional
PERPLEXITY_API_KEY=pplx-...  # Optional
ENABLE_WORKFLOW_A=true
ENABLE_WORKFLOW_B=true
```

---

## ğŸ“ Testing Integration

### 1. Test CORE Engine directly
```bash
# Check if CORE is running
curl https://concrete-agent.onrender.com/docs

# Test Workflow A
curl -X POST https://concrete-agent.onrender.com/workflow-a/start \
  -F "file=@test.xlsx"

# Test chat
curl -X POST https://concrete-agent.onrender.com/chat/message \
  -H "Content-Type: application/json" \
  -d '{"message": "Help me analyze a bridge project"}'
```

### 2. Test Express integration
```bash
# Upload document to Monolit-Planner
curl -X POST http://localhost:3001/api/documents/upload \
  -F "file=@project.pdf" \
  -H "Authorization: Bearer YOUR_TOKEN"

# Check analysis
curl http://localhost:3001/api/documents/abc123 \
  -H "Authorization: Bearer YOUR_TOKEN"
```

### 3. End-to-end test
```
1. Open Monolit-Planner frontend
2. Create new project
3. Upload PDF document
4. View analysis preview
5. Approve work list
6. Run calculators
7. Generate estimate
8. Export as PDF
```

---

## ğŸ“Š System Flow Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ USER: Ğ¡Ğ¼ĞµÑ‚Ñ‡Ğ¸Ğº Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ¸Ğ» Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ½ÑƒÑ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FRONTEND: Upload PDF/Excel in Monolit-Planner                  â”‚
â”‚ â””â”€ DocumentUploadPage (drag-drop UI)                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ BACKEND Express: POST /api/documents/upload                     â”‚
â”‚ â””â”€ Validate file, save temporarily                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CORE Engine: POST /workflow-a/start                            â”‚
â”‚ â”œâ”€ OCR (ĞµÑĞ»Ğ¸ PDF)                                              â”‚
â”‚ â”œâ”€ Table extraction (ĞµÑĞ»Ğ¸ Excel)                               â”‚
â”‚ â”œâ”€ Text parsing                                                â”‚
â”‚ â””â”€ Return parsed positions                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ BACKEND Express: Save analysis to DB                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FRONTEND: AnalysisPreview                                       â”‚
â”‚ â”œâ”€ Show detected project type                                  â”‚
â”‚ â”œâ”€ Show extracted dimensions                                   â”‚
â”‚ â”œâ”€ Show proposed work list                                     â”‚
â”‚ â”œâ”€ Show material requirements                                  â”‚
â”‚ â””â”€ [Confirm] [Reject] [Edit]                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
                         [User confirms]
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ BACKEND: Create work list, save positions                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FRONTEND: WorkListEditor                                        â”‚
â”‚ â”œâ”€ Display work items                                          â”‚
â”‚ â”œâ”€ [+ Add work]                                               â”‚
â”‚ â”œâ”€ [Edit] [Delete] for each item                              â”‚
â”‚ â”œâ”€ [Calculate volumes]                                        â”‚
â”‚ â””â”€ [Generate estimate]                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
                    [User clicks Calculate]
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FRONTEND: Show calculator UI (e.g., BridgeCalculator)          â”‚
â”‚ â”œâ”€ Input: length=45m, width=12m, depth=2.5m, concrete=C30/37  â”‚
â”‚ â””â”€ [Calculate]                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ BACKEND: POST /api/calculators/bridge                          â”‚
â”‚ â””â”€ Validate inputs, call CORE or local service                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CORE/Calculator: Calculate concrete volume, labor hours, etc    â”‚
â”‚ Return: { volume: 1350 mÂ³, hours: 136 h, materials: {...} }   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FRONTEND: Display results                                       â”‚
â”‚ â”œâ”€ Volume: 1,350 mÂ³                                            â”‚
â”‚ â”œâ”€ Labor: 136 man-hours                                        â”‚
â”‚ â”œâ”€ Materials: cement, sand, gravel, rebar                      â”‚
â”‚ â””â”€ [Add to estimate]                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
                  [Repeat for each work item]
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FRONTEND: [Generate Estimate]                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ BACKEND: POST /api/estimates/generate                           â”‚
â”‚ â”œâ”€ Collect all work items + calculator results                â”‚
â”‚ â”œâ”€ Match OTSKP codes                                           â”‚
â”‚ â”œâ”€ Build estimate lines                                        â”‚
â”‚ â””â”€ Save to DB                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FRONTEND: EstimatePreview                                       â”‚
â”‚ â”œâ”€ Display all lines (code, name, volume, unit, hours)        â”‚
â”‚ â”œâ”€ Show totals (materials, labor)                              â”‚
â”‚ â”œâ”€ NO PRICES (blind estimate / ÑĞ»ĞµĞ¿Ğ°Ñ ÑĞ¼ĞµÑ‚Ğ°)                  â”‚
â”‚ â””â”€ [Export PDF] [Export Excel]                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
                         [User exports]
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ BACKEND: Generate PDF/Excel export                             â”‚
â”‚ â””â”€ Save file, return download link                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
                   ğŸ“„ Ready to send to customer!
```

---

## ğŸ¯ Success Criteria

### Phase 4: Document Upload
- âœ… User can upload PDF/Excel
- âœ… CORE Engine analyzes document
- âœ… Frontend shows analysis preview
- âœ… User can confirm or reject
- âœ… Analysis saved to database

### Phase 5: Work List Generation
- âœ… System proposes work list from analysis
- âœ… User can edit work list
- âœ… System validates against standards
- âœ… Work list saved as draft

### Phase 6: Calculators
- âœ… Each calculator computes volumes/hours correctly
- âœ… Materials breakdown shown
- âœ… Results saved for estimate

### Phase 7: Estimate Generation
- âœ… Estimate assembles all data
- âœ… OTSKP codes matched correctly
- âœ… Export to PDF (blind estimate)
- âœ… Export to Excel

---

## ğŸš¨ Important Notes

1. **CORE Engine is separate** - If Concrete-Agent goes down, basic functionality still works (manual entry)
2. **Graceful degradation** - System can work without CORE for simple projects
3. **Cache results** - Don't call CORE for same document twice
4. **Rate limiting** - CORE has API limits, implement queuing if needed
5. **Error handling** - If CORE fails, show friendly message, suggest manual entry

---

## ğŸ“š Related Documentation

- **Monolit-Planner:** `/home/user/Monolit-Planner/claude.md`
- **Concrete-Agent:** `https://github.com/alpro1000/concrete-agent/ARCHITECTURE.md`
- **User Management:** `/home/user/Monolit-Planner/USER_MANAGEMENT_ARCHITECTURE.md`
- **Monolith Spec:** `/home/user/Monolit-Planner/MONOLITH_SPEC.md`

---

## ğŸ“ Contact & Support

- **Monolit-Planner Frontend:** https://monolit-planner-frontend.onrender.com
- **Monolit-Planner Backend:** https://monolit-planner-api.onrender.com
- **Concrete-Agent:** https://concrete-agent.onrender.com
- **GitHub Monolit:** https://github.com/alpro1000/Monolit-Planner
- **GitHub Concrete-Agent:** https://github.com/alpro1000/concrete-agent

---

**Last Updated:** 2025-11-14
**Status:** ğŸš€ Ready for Phase 4 implementation
